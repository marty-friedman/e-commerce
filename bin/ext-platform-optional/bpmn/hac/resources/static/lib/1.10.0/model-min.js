(function(global){var RUNTIME_RESOURCE_ID="runtimeResourceId",RUNTIME_METADATA_RESOURCE_ID=RUNTIME_RESOURCE_ID+"_metadata";namespace("sap.galilei.model");sap.galilei.model.deferred={};sap.galilei.model.getObject=function(oResource,sIdentity){var oDefinedResource=oResource||sap.galilei.model.getRuntimeResource();return sap.galilei.model.gravity.ClassDefinitionBuilder.getObject(oDefinedResource,sIdentity)};sap.galilei.model.registerPackage=function(oResource,oInitializationProperties){var sPackageName=oInitializationProperties.name,sPackageDisplayName=oInitializationProperties.displayName||sPackageName,sPackageNamespace=oInitializationProperties.namespaceName||sPackageName,oPackageDefinition=sap.galilei.model.getObject(sap.galilei.model.internal.galileiM3Resource,"Package");oInitializationProperties=oInitializationProperties||{};if(oResource==undefined){throw"A resource is mandatory when registering a package"}if(oPackageDefinition!==undefined){return oPackageDefinition.create(oResource,{name:sPackageName,displayName:sPackageDisplayName,namespaceName:sPackageNamespace})}};sap.galilei.model.getPackages=function(){var oPackageDefinition=sap.galilei.model.getObject(sap.galilei.model.internal.galileiM3Resource,"Package");if(oPackageDefinition!==undefined&&oPackageDefinition.runtimeClass!==undefined){return oPackageDefinition.runtimeClass.registeredPackages}};sap.galilei.model.getPackage=function(sPackageNamespaceName){var oPackages=sap.galilei.model.getPackages();return oPackages&&oPackages[sPackageNamespaceName]};sap.galilei.model.getResources=function(){var oResourceDefinition=sap.galilei.model.getObject(sap.galilei.model.internal.galileiM3Resource,"Resource");if(oResourceDefinition!==undefined&&oResourceDefinition.runtimeClass!==undefined){return oResourceDefinition.runtimeClass.registeredResources}};sap.galilei.model.getResource=function(sResourceId){var oResources=sap.galilei.model.getResources();return oResources&&oResources[sResourceId]};sap.galilei.model.splitClassQualifiedName=function(sFullyQualifiedName){var aTokens=sFullyQualifiedName.split("."),sPackageNamespaceName="",sClassName,nTokenArrayLength=aTokens.length,nIndex,max;for(nIndex=0,max=nTokenArrayLength-1;nIndex<max;nIndex++){sPackageNamespaceName+=aTokens[nIndex];if(nIndex!=nTokenArrayLength-2){sPackageNamespaceName+="."}}sClassName=aTokens[nTokenArrayLength-1];return{packageNamespaceName:sPackageNamespaceName,className:sClassName}};sap.galilei.model.splitFeatureQualifiedName=function(sFullyQualifiedName){if(sFullyQualifiedName){var aTokens=sFullyQualifiedName.split("."),sPackageNamespaceName="",sClassName,sFeatureName,nTokenArrayLength=aTokens.length,nIndex,max;for(nIndex=0,max=nTokenArrayLength-2;nIndex<max;nIndex++){sPackageNamespaceName+=aTokens[nIndex];if(nIndex!=nTokenArrayLength-3){sPackageNamespaceName+="."}}sClassName=aTokens[nTokenArrayLength-2];sFeatureName=aTokens[nTokenArrayLength-1];return{packageNamespaceName:sPackageNamespaceName,className:sClassName,featureName:sFeatureName}}return{}};sap.galilei.model.getClass=function(sFullyQualifiedName,oMetadataResource){var oSplittedQualifiedName,sPackageNamespaceName,sClassName,oPackage,oClass;if(sFullyQualifiedName){if(oMetadataResource){oClass=oMetadataResource.getClass(sFullyQualifiedName)}if(oClass===undefined){oSplittedQualifiedName=sap.galilei.model.splitClassQualifiedName(sFullyQualifiedName);sPackageNamespaceName=oSplittedQualifiedName.packageNamespaceName;sClassName=oSplittedQualifiedName.className;oPackage=sap.galilei.model.getPackage(sPackageNamespaceName);if(oPackage!=undefined){oClass=oPackage.getClass(sClassName)}}}return oClass};sap.galilei.model.createNewInstance=function(sFullyQualifiedName,oResource,oParam,sObjectId){var oMetadataResource=(oResource&&oResource.activeReader&&oResource.activeReader.metadataResource)||oResource,oClass=sap.galilei.model.getClass(sFullyQualifiedName,oMetadataResource),oObject;if(oClass&&oResource){oObject=oClass.create(oResource,oParam,sObjectId)}else{if(oClass&&oClass.resource&&oClass.resource.resourceId===RUNTIME_METADATA_RESOURCE_ID){oObject=oClass.create(sap.galilei.model.getRuntimeResource(),oParam,sObjectId)}}return oObject};sap.galilei.model.getProperty=function(sFullyQualifiedName){var oSplittedQualifiedName=sap.galilei.model.splitFeatureQualifiedName(sFullyQualifiedName),sPackageNamespaceName=oSplittedQualifiedName.packageNamespaceName,sClassName=oSplittedQualifiedName.className,sPropertyName=oSplittedQualifiedName.featureName,oPackage,oClass,oProperty;oPackage=sap.galilei.model.getPackage(sPackageNamespaceName);if(oPackage!=undefined){oClass=oPackage.getClass(sClassName);if(oClass!=undefined){oProperty=oClass.getProperty(sPropertyName)}}return oProperty};sap.galilei.model.getReference=function(sFullyQualifiedName){var oSplittedQualifiedName=sap.galilei.model.splitFeatureQualifiedName(sFullyQualifiedName),sPackageNamespaceName=oSplittedQualifiedName.packageNamespaceName,sClassName=oSplittedQualifiedName.className,sReferenceName=oSplittedQualifiedName.featureName,oPackage,oClass,oReference;oPackage=sap.galilei.model.getPackage(sPackageNamespaceName);if(oPackage!=undefined){oClass=oPackage.getClass(sClassName);if(oClass!=undefined){oReference=oClass.getReference(sReferenceName)}}return oReference};sap.galilei.model.getFeature=function(sFullyQualifiedName){var oSplittedQualifiedName=sap.galilei.model.splitFeatureQualifiedName(sFullyQualifiedName),sPackageNamespaceName=oSplittedQualifiedName.packageNamespaceName,sClassName=oSplittedQualifiedName.className,sFeatureName=oSplittedQualifiedName.featureName,oPackage,oClass,oFeature;oPackage=sap.galilei.model.getPackage(sPackageNamespaceName);if(oPackage!=undefined){oClass=oPackage.getClass(sClassName);if(oClass!=undefined){oFeature=oClass.getFeature(sFeatureName)}}return oFeature};sap.galilei.model.defineClass=function(oClassDef){oClassDef=sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.transformClassDef(oClassDef);return sap.galilei.core.internal.defineClass(oClassDef)};sap.galilei.model.defineCollection=function(oCollectionDef,oRuntimeAdapter){oRuntimeAdapter=oRuntimeAdapter||sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER;return sap.galilei.core.defineCollectionClass(oCollectionDef,oRuntimeAdapter)};sap.galilei.model.isInstanceOf=function(oInstance,sQualifiedName){if(oInstance&&oInstance.isInstanceOf&&sQualifiedName){return oInstance.isInstanceOf(sQualifiedName)}return false};sap.galilei.model.isTypeOf=function(sQualifiedName,sParentQualifiedName,oMetadataResource){if(sQualifiedName&&sParentQualifiedName){if(sQualifiedName===sParentQualifiedName){return true}var oClass=sap.galilei.model.getClass(sQualifiedName,oMetadataResource);if(oClass){return oClass.isTypeOf(sParentQualifiedName)}}return false};sap.galilei.model.getInheritanceLevel=function(sQualifiedName,sParentQualifiedName,oMetadataResource){var nInheritanceLevel=-1,bFound=false,oClassDef;if(sQualifiedName!==undefined&&sParentQualifiedName!==undefined){if(sQualifiedName===sParentQualifiedName){nInheritanceLevel=0}else{oClassDef=sap.galilei.model.getClass(sQualifiedName,oMetadataResource);nInheritanceLevel=0;while(oClassDef&&oClassDef.qualifiedName){if(sParentQualifiedName===oClassDef.qualifiedName){bFound=true;break}oClassDef=oClassDef.parent;nInheritanceLevel++}if(bFound===false){nInheritanceLevel=-1}}}return nInheritanceLevel};sap.galilei.model.getInstanceStaticProperty=function(oInstance,sPropertyName){if(oInstance&&oInstance.classDefinition&&sPropertyName){var oClassDef=oInstance.classDefinition;while(oClassDef&&oClassDef.runtimeClass){if(oClassDef.runtimeClass[sPropertyName]){return oClassDef.runtimeClass[sPropertyName]}oClassDef=oClassDef.parent}}return undefined};sap.galilei.model.getClassStaticProperty=function(sQualifiedName,sPropertyName){if(sQualifiedName&&sPropertyName){var oClassDef=sap.galilei.model.getClass(sQualifiedName);while(oClassDef&&oClassDef.runtimeClass){if(oClassDef.runtimeClass[sPropertyName]){return oClassDef.runtimeClass[sPropertyName]}oClassDef=oClassDef.parent}}return undefined};sap.galilei.model.isInUndoRedo=function(){return sap.galilei.model.gravity.ClassDefinitionBuilder.isInUndoRedo};sap.galilei.model.breadthFirstTraverse=function(oObject,vCollection,fnEscape,fnSkip,fnVisit){var aCollection,aObjects,oObj,oSubObj,getCollection,i,length,aResult;if(oObject&&vCollection){getCollection=function(oInstance,vColl){var aColl;if((typeof vColl==="string")||(vColl instanceof String)){aColl=oInstance[vColl]}else{if(typeof vColl==="function"){aColl=vColl.call(oInstance)}}return aColl};aResult=[];aObjects=[oObject];if(!fnEscape||!fnEscape.call(oObject)){if(!fnSkip||!fnSkip.call(oObject)){if(fnVisit){fnVisit.call(oObject)}aResult.push(oObject)}while(aObjects.length>0){oObj=aObjects[0];aObjects.shift();aCollection=getCollection(oObj,vCollection);if(aCollection&&aCollection.length>0){for(i=0,length=aCollection.length;i<length;i++){oSubObj=aCollection.get?aCollection.get(i):aCollection[i];if(fnEscape&&fnEscape.call(oSubObj)){return aResult}if(!fnSkip||!fnSkip.call(oObject)){if(fnVisit){fnVisit.call(oSubObj)}aResult.push(oSubObj)}aObjects.push(oSubObj)}}}}return aResult}};sap.galilei.model.metamodel=function(sMetamodelId,oMetamodelPartialDeclaration){sap.galilei.model.metamodel[sMetamodelId]=sap.galilei.model.metamodel[sMetamodelId]||[];sap.galilei.model.metamodel[sMetamodelId].push(oMetamodelPartialDeclaration)};sap.galilei.model.loadMetamodels=function(){var sMetamodelId,aMetamodelPartialDeclarations,oMetamodelFullDeclaration,oMetamodelResource,oReader=new sap.galilei.model.JSONReader();for(sMetamodelId in sap.galilei.model.metamodel){oMetamodelFullDeclaration={};aMetamodelPartialDeclarations=sap.galilei.model.metamodel[sMetamodelId];jQuery.each(aMetamodelPartialDeclarations,function(nindex,oMetamodelPartialDeclaration){jQuery.extend(true,oMetamodelFullDeclaration,oMetamodelPartialDeclaration)});oMetamodelResource=(sMetamodelId==="Galilei.Core"&&sap.galilei.model.internal.galileiM3Resource)||(sap.galilei.model.getResource(sMetamodelId)||new sap.galilei.model.Resource(sMetamodelId));oReader.load(oMetamodelResource,oMetamodelFullDeclaration);delete sap.galilei.model.metamodel[sMetamodelId]}};sap.galilei.model.metamodelExtension=function(sMetamodelExtensionId,oMetamodelExtension){sap.galilei.model.metamodelExtension[sMetamodelExtensionId]=sap.galilei.model.metamodelExtension[sMetamodelExtensionId]||[];sap.galilei.model.metamodelExtension[sMetamodelExtensionId].push(oMetamodelExtension)};sap.galilei.model.loadMetamodelExtension=function(sMetamodelExtensionId,oMetamodelResource,bBatchMode){var oReader=new sap.galilei.model.JSONReader(),aMetamodelExtensions=sap.galilei.model.metamodelExtension[sMetamodelExtensionId]||[];jQuery.each(aMetamodelExtensions,function(){oReader.load(oMetamodelResource,this,bBatchMode)})};sap.galilei.model._defaultPostApplyAction=undefined;sap.galilei.model.getDefaultPostApplyAction=function(){return sap.galilei.model._defaultPostApplyAction};sap.galilei.model.setDefaultPostApplyAction=function(fnPostApplyAction){var fnOld=sap.galilei.model._defaultPostApplyAction;sap.galilei.model._defaultPostApplyAction=fnPostApplyAction;return fnOld};sap.galilei.model.getRuntimeResource=function(){return sap.galilei.model.getResource(RUNTIME_RESOURCE_ID)||new sap.galilei.model.Resource(RUNTIME_RESOURCE_ID)};sap.galilei.model.applyUndoableAction=function(fnFunction,sDescription,bIsProtectedFromUndo,bBatchMode,fnError,fnPostApplyAction){sap.galilei.model.getRuntimeResource().applyUndoableAction(fnFunction,sDescription,bIsProtectedFromUndo,bBatchMode,fnError,fnPostApplyAction)};sap.galilei.model.getObjectAsync=function(sIdentity,bAsync){return sap.galilei.model.getRuntimeResource().getObjectAsync(sIdentity,bAsync)};sap.galilei.model.getObjectPropertyAsync=function(oInstance,sPropertyName){return sap.galilei.model.getRuntimeResource().getObjectPropertyAsync(oInstance,sPropertyName)};sap.galilei.model.getObjectAtomicReferenceAsync=function(oInstance,sReferenceName,bAsync){return sap.galilei.model.getRuntimeResource().getObjectAtomicReferenceAsync(oInstance,sReferenceName,bAsync)};sap.galilei.model.loadObjectReferenceObjectsAsync=function(oInstance,sReferenceName,bAsync){return sap.galilei.model.getRuntimeResource().loadObjectReferenceObjectsAsync(oInstance,sReferenceName,bAsync)};sap.galilei.model.selectObject=function(oFilters,fnMatchingLogic){return sap.galilei.model.getRuntimeResource().selectObject(oFilters,fnMatchingLogic)};sap.galilei.model.selectAllObjects=function(oFilters,fnMatchingLogic){return sap.galilei.model.getRuntimeResource().selectAllObjects(oFilters,fnMatchingLogic)};sap.galilei.model.load=function(oJSONMetadataDefinition){var oMetaResource=sap.galilei.model.getResource(RUNTIME_METADATA_RESOURCE_ID)||new sap.galilei.model.Resource(RUNTIME_METADATA_RESOURCE_ID),oJSONReader=new sap.galilei.model.JSONReader();oJSONReader.load(oMetaResource,oJSONMetadataDefinition)};var oJQueryDeferredObjectPrototype=Object.getPrototypeOf(jQuery.Deferred());var _resolveFunction=function(oResolvedValue){this._resolvedValue=oResolvedValue};sap.galilei.model.isJQueryDeferredObject=function(oObject){return Object.getPrototypeOf(oObject)===oJQueryDeferredObjectPrototype};sap.galilei.model.getJQueryDeferredObjectResolvedValue=function(oDeferredObject){var oResult;if(sap.galilei.model.isJQueryDeferredObject(oDeferredObject)&&oDeferredObject.state()==="resolved"){jQuery.when(oDeferredObject).done(_resolveFunction);oResult=oDeferredObject.promise()._resolvedValue}return oResult}}(this));
"use strict";sap.galilei.model.BaseCollection=sap.galilei.core.defineClass({fullClassName:"sap.galilei.model.BaseCollection",properties:{isCollection:{get:function(){return true}},length:{get:function(){throw"NotImplementedException"}},resource:undefined},methods:{push:function(oValue){throw"NotImplementedException"},add:function(oValue){this.push(oValue)},insert:function(nIndex,oValue){throw"NotImplementedException"},removeAt:function(nIndex){throw"NotImplementedException"},get:function(nIndex){throw"NotImplementedException"},contains:function(oValue){throw"NotImplementedException"},clear:function(){throw"NotImplementedException"},toArray:function(){throw"NotImplementedException"},indexOf:function(oValue){throw"NotImplementedException"},concat:function(aValue){throw"NotImplementedException"},selectObject:function(oFilters,fnMatchingLogic){var oAllMatchingObjects=this.selectAllObjects(oFilters,fnMatchingLogic,true);return oAllMatchingObjects.length>0?oAllMatchingObjects.get(0):undefined},_checkIndexedProperty:function(sPropertyIndexKey,aPropertyIndexValue,fnMatchingLogic,vFilterValue,oFilters){var aMatchingObjects=[];if(this!=undefined&&fnMatchingLogic&&fnMatchingLogic(undefined,vFilterValue,sPropertyIndexKey,this,oFilters)===true){aMatchingObjects=aPropertyIndexValue}return aMatchingObjects},_checkIndexedFilterValue:function(oSelectedObjectsCollection,sFilterKey,oFilterValue,oAllIndexes,fnMatchingLogic,oFilters,oNonIndexedFilters){var vValue,aPropertyIndexesNames,nPropertyIndexesNamesIndex,nPropertyIndexesNamesCount,aResult,oPropertyIndexes,vFilterValue,bIndexedFilterFound=false,aMatchingObjects;if(oFilterValue!=undefined){vValue=(oFilterValue.toString&&oFilterValue.toString())||oFilterValue}oPropertyIndexes=oAllIndexes[sFilterKey];if(sFilterKey==="objectId"){bIndexedFilterFound=true;if(oSelectedObjectsCollection.internalArray.length===0){oSelectedObjectsCollection.internalArray=this.resource?[this.resource.getObject(vValue)]:[]}else{oSelectedObjectsCollection.internalArray=jQuery(oSelectedObjectsCollection.internalArray).filter(this.resource?[this.resource.getObject(vValue)]:[])}}else{if(oPropertyIndexes!==undefined){bIndexedFilterFound=true;if(fnMatchingLogic!==undefined){aMatchingObjects=[];vFilterValue=vValue;aPropertyIndexesNames=Object.getOwnPropertyNames(oPropertyIndexes);nPropertyIndexesNamesCount=aPropertyIndexesNames?aPropertyIndexesNames.length:0;for(nPropertyIndexesNamesIndex=0;nPropertyIndexesNamesIndex<nPropertyIndexesNamesCount;nPropertyIndexesNamesIndex++){aResult=this._checkIndexedProperty(aPropertyIndexesNames[nPropertyIndexesNamesIndex],oPropertyIndexes[aPropertyIndexesNames[nPropertyIndexesNamesIndex]],fnMatchingLogic,vFilterValue,oFilters);if(aResult){aMatchingObjects=aMatchingObjects.concat(aResult)}}}else{aMatchingObjects=oPropertyIndexes[vValue]||[]}if(aMatchingObjects!==undefined){if(oSelectedObjectsCollection.internalArray.length===0){oSelectedObjectsCollection.internalArray=aMatchingObjects.slice()||[]}else{oSelectedObjectsCollection.internalArray=jQuery(oSelectedObjectsCollection.internalArray).filter(aMatchingObjects.slice())}}}else{oNonIndexedFilters[sFilterKey]=vValue}}return bIndexedFilterFound},_checkNonIndexedFilterValue:function(sFilterKey,oFilterValue,oCurrentInstance,fnMatchingLogic,oFilters){var vValue,bObjectMatch=true,vPropertyValue,aTokens,nTokenLength,nTokenIndex,sToken,oPathInstance=oCurrentInstance;if(oFilterValue!=undefined){vValue=(oFilterValue.toString&&oFilterValue.toString())||oFilterValue}if(fnMatchingLogic!==undefined){if(!(fnMatchingLogic(sFilterKey,vValue,oCurrentInstance[sFilterKey],oCurrentInstance,oFilters))){bObjectMatch=false}}else{if(sFilterKey.indexOf(".")!==-1){aTokens=sFilterKey.split(".");for(nTokenIndex=0,nTokenLength=aTokens.length;nTokenIndex<nTokenLength-1;nTokenIndex++){sToken=aTokens[nTokenIndex];oPathInstance=oPathInstance[sToken];if(oPathInstance===undefined){bObjectMatch=false;break}}vPropertyValue=bObjectMatch?oPathInstance[aTokens[nTokenIndex]]:undefined}else{vPropertyValue=oCurrentInstance[sFilterKey]}if(vPropertyValue!==undefined&&vPropertyValue.toString){vPropertyValue=vPropertyValue.toString()}if(vPropertyValue!=vValue){bObjectMatch=false}}return bObjectMatch},selectAllObjects:function(oFilters,fnMatchingLogic,bBreakOnFirstObjectFound){var oSelectedObjectsCollection=new sap.galilei.model.ArrayCollection({resource:this.resource}),oAllIndexes=(this.resource&&this.resource._oIndexes)||{},bIndexedFilterFound,nObjectsCount,nObjectIndex,oCurrentInstance,bObjectMatch,nNonIndexedFiltersCount,oNonIndexedFilters={},aFilterNames,nFiltersCount,nFilterIndex,aObjects;if(oFilters instanceof Object){aFilterNames=Object.getOwnPropertyNames(oFilters);nFiltersCount=aFilterNames?aFilterNames.length:0;for(nFilterIndex=0;nFilterIndex<nFiltersCount;nFilterIndex++){bIndexedFilterFound=this._checkIndexedFilterValue(oSelectedObjectsCollection,aFilterNames[nFilterIndex],oFilters[aFilterNames[nFilterIndex]],oAllIndexes,fnMatchingLogic,oFilters,oNonIndexedFilters)||bIndexedFilterFound}nNonIndexedFiltersCount=sap.galilei.core.getObjectSize(oNonIndexedFilters);if(nNonIndexedFiltersCount>0){aObjects=bIndexedFilterFound===true?oSelectedObjectsCollection.toArray():this.toArray();nObjectsCount=aObjects.length;for(nObjectIndex=0;nObjectIndex<nObjectsCount;nObjectIndex++){oCurrentInstance=aObjects[nObjectIndex];if(oCurrentInstance===undefined){continue}bObjectMatch=true;for(nFilterIndex=0;nFilterIndex<nFiltersCount;nFilterIndex++){bObjectMatch=bObjectMatch&&this._checkNonIndexedFilterValue(aFilterNames[nFilterIndex],oFilters[aFilterNames[nFilterIndex]],oCurrentInstance,fnMatchingLogic,oFilters)}if(bObjectMatch===true){if(bBreakOnFirstObjectFound){oSelectedObjectsCollection.internalArray=[oCurrentInstance];break}else{if(bIndexedFilterFound!==true){oSelectedObjectsCollection.internalArray.push(oCurrentInstance)}}}else{if(bIndexedFilterFound===true&&oSelectedObjectsCollection.internalArray.indexOf(oCurrentInstance)>-1){oSelectedObjectsCollection.internalArray.splice(oSelectedObjectsCollection.internalArray.indexOf(oCurrentInstance),1)}}}}}else{console.log("Warning: The selectObject filter is not an object.")}return oSelectedObjectsCollection},forEach:function(callback,thisArg){var nCurrentObject,nIndex,max;if(typeof callback!=="function"){throw new TypeError()}for(nIndex=0,max=this.length;nIndex<max;nIndex++){nCurrentObject=this.get(nIndex);callback.call(thisArg,nCurrentObject)}return this},complement:function(oInCollection,fnContains){var oResult=new sap.galilei.model.ArrayCollection({resource:this.resource}),nInCollectionIndex,nInCollectionCount=(oInCollection&&oInCollection.length)||0,oCurrentObject,fnContainsLogic=fnContains?function(oCollection,oObject){return fnContains(oCollection,oObject)}:function(oCollection,oObject){return oCollection.indexOf(oObject)!==-1};for(nInCollectionIndex=0;nInCollectionIndex<nInCollectionCount;nInCollectionIndex++){oCurrentObject=oInCollection.get(nInCollectionIndex);if(oCurrentObject&&fnContainsLogic(this,oCurrentObject)===false){oResult.push(oCurrentObject)}}return oResult},filter:function(callback,thisArg){var nCurrentObject,nIndex,max,aArray=[];if(typeof callback!=="function"){throw new TypeError()}for(nIndex=0,max=this.length;nIndex<max;nIndex++){nCurrentObject=this.get(nIndex);if(callback.call(thisArg,nCurrentObject)){aArray.push(nCurrentObject)}}return aArray},updateContent:function(oNewCol,bDeleteObjects,fnGetId){var nNewColIndex=0,oMapOldPos={},oMapMovedObjects={},sId,oNewColObject,oOldColObject,nOldPos,nIndex,nNewInserted=0,aOldPosPropertyNames,sId2,nIndex2,nOldPos2,nOldLength;for(nIndex=0;nIndex<this.length;nIndex++){oOldColObject=this.get(nIndex);sId=fnGetId?fnGetId(oOldColObject):oOldColObject.objectId;oMapOldPos[sId]=nIndex}aOldPosPropertyNames=Object.getOwnPropertyNames(oMapOldPos);for(nIndex=0;nIndex<oNewCol.length;nIndex++){oNewColObject=oNewCol.get(nIndex);sId=fnGetId?fnGetId(oNewColObject):oNewColObject.objectId;nOldPos=oMapOldPos[sId];if(nOldPos!==undefined){oMapOldPos[sId]=undefined;if(nOldPos+nNewInserted===nIndex){continue}else{oOldColObject=this.get(nOldPos+nNewInserted);this.removeAt(nOldPos+nNewInserted);this.insert(nIndex,oOldColObject);for(nIndex2=0;nIndex2<aOldPosPropertyNames.length;nIndex2++){sId2=aOldPosPropertyNames[nIndex2];nOldPos2=oMapOldPos[sId2];if((nOldPos2!==undefined)&&nOldPos2<nOldPos){oMapOldPos[sId2]=nOldPos2+1}}}}else{this.insert(nIndex,oNewColObject);nNewInserted=nNewInserted+1}}oOldColObject=undefined;nOldLength=this.length;while(this.length>nIndex){oOldColObject=this.get(nIndex);if(bDeleteObjects&&oOldColObject){oOldColObject.deleteObject()}else{this.removeAt(nIndex)}if(this.length>=nOldLength){nIndex=nIndex+1}nOldLength=this.length}},map:function(callback,thisArg){return this.toArray().map(callback,thisArg)}}});
"use strict";sap.galilei.model.ChildrenCollection=sap.galilei.core.defineClass({fullClassName:"sap.galilei.model.ChildrenCollection",parent:sap.galilei.model.BaseCollection,properties:{container:undefined,length:{get:function(){var oClassDefinition=this.container.classDefinition,oReferences=oClassDefinition.references,oCurrentReferenceValue,oCurrentReference,nReferenceIndex,nResult=0;if(oClassDefinition===undefined){throw"Instance must have an associated class definition"}for(nReferenceIndex=oReferences.length-1;nReferenceIndex>=0;nReferenceIndex--){oCurrentReference=oReferences.get(nReferenceIndex);if(oCurrentReference.isContainment){oCurrentReferenceValue=this.container[oCurrentReference.name];if(oCurrentReferenceValue){nResult+=oCurrentReferenceValue.length}}}return nResult}}},methods:{push:function(oValue){throw"Children reference is read only"},removeAt:function(nIndex){throw"Children reference is read only"},get:function(nIndex){var oClassDefinition=this.container.classDefinition,oReferences=oClassDefinition.references,oCurrentReferenceValue,nReferenceIndex,oCurrentReference;if(oClassDefinition===undefined){throw"Instance must have an associated class definition"}for(nReferenceIndex=oReferences.length-1;nReferenceIndex>=0;nReferenceIndex--){oCurrentReference=oReferences.get(nReferenceIndex);if(oCurrentReference.isContainment){oCurrentReferenceValue=this.container[oCurrentReference.name];if(nIndex<oCurrentReferenceValue.length){return oCurrentReferenceValue.get(nIndex)}nIndex-=oCurrentReferenceValue.length}}return undefined},contains:function(oValue){var oClassDefinition=this.container.classDefinition,oReferences=oClassDefinition.references,oCurrentReferenceValue,oCurrentReference,bResult=false,nReferenceIndex;if(oClassDefinition===undefined){throw"Instance must have an associated class definition"}for(nReferenceIndex=oReferences.length-1;nReferenceIndex>=0;nReferenceIndex--){oCurrentReference=oReferences.get(nReferenceIndex);if(oCurrentReference.isContainment){oCurrentReferenceValue=this.container[oCurrentReference.name];if(oCurrentReferenceValue.contains(oValue)!==-1){bResult=true;break}}}return bResult},clear:function(){throw"Children reference is read only"},toArray:function(){throw"NotImplementedException"},indexOf:function(oValue){throw"NotImplementedException"},deleteAll:function(){var oClassDefinition=this.container.classDefinition,oReferences=oClassDefinition.references,oCurrentReferenceValue,oCurrentReference,nReferenceIndex;if(oClassDefinition===undefined){throw"Instance must have an associated class definition"}for(nReferenceIndex=oReferences.length-1;nReferenceIndex>=0;nReferenceIndex--){oCurrentReference=oReferences.get(nReferenceIndex);if(oCurrentReference.isContainment){oCurrentReferenceValue=this.container[oCurrentReference.name];if(oCurrentReferenceValue){oCurrentReferenceValue.deleteAll()}}}}}});
"use strict";namespace("sap.galilei.model.constraint",function(nsLocal){nsLocal.ListEditor=sap.galilei.core.defineClass({methods:{canAddItem:function(oInstance,oItem,nIndex){return this.isReadonly?!this.isReadonly(oInstance):true},canCreateItem:function(oInstance,oItem,nIndex){return this.isReadonly?!this.isReadonly(oInstance):true},canMoveItem:function(oInstance,nOldIndex,nNewIndex){return this.isReadonly?!this.isReadonly(oInstance):true},canRemoveItem:function(oInstance,nIndex){return this.isReadonly?!this.isReadonly(oInstance):true},canReplaceItem:function(oInstance,oNewItem,nIndex){return this.isReadonly?!this.isReadonly(oInstance):true},getItemDescription:function(oInstance,oItem){return undefined},getItemDisplayImage:function(oInstance,oItem){return undefined},getItemLabel:function(oInstance,oItem){return undefined},isReadonly:function(oInstance){return false}}})});
namespace("sap.galilei.model.constraint",function(nsLocal){nsLocal.ValueEditor=sap.galilei.core.defineClass({methods:{allowedValues:function(oInstance){return undefined},coerceValue:function(oInstance,vValue){return vValue},defaultValue:function(oInstance){return undefined},formatValue:function(oInstance,vValue,sTargetType){var oResult=vValue;if(!sTargetType||sTargetType==="String"){if(oResult!=null){oResult=oResult.toString()}else{oResult=""}}return oResult},getValueDescription:function(oInstance,vValue){return undefined},getValueDisplayImage:function(oInstance,vValue){return undefined},isReadonly:function(oInstance){return false},suggestedValues:function(oInstance,vValue,fnCallback){return undefined},validateValue:function(oInstance,vValue){var result=true,values=this.allowedValues;if(values instanceof Function){values=values(oInstance)}if(values){if(values instanceof Array){result=values.indexOf(vValue)!==-1}else{if(values.min&&values.max){result=(vValue>=values.min)&&(vValue<=values.max)}}}return result}}})});
"use strict";(function(){namespace("sap.galilei.model.gravity");sap.galilei.gravity.setLogLevel({toUpperCase:function(){return"ERROR"}});(function(){var oSubscriptionLogger=sap.galilei.gravity.getLogger("SubscriptionHandler"),fnParentFunction=oSubscriptionLogger.error;oSubscriptionLogger.error=function(msg){fnParentFunction.call(oSubscriptionLogger,msg);throw msg}}());(function(){var originalCreateTransformer=sap.galilei.gravity.createTransformer;sap.galilei.gravity.createTransformer=function(configuration){var result=originalCreateTransformer(configuration);result.calculateTransformation=function(complex,history){return complex};return result}}());(function(){sap.galilei.gravity.createBuggyBufferedModelListener=sap.galilei.gravity.createBufferedModelListener=function(){var events=[],listeners=sap.galilei.gravity.createSubscriptionHandler(),rememberEvent=function(event,params){events.push({event:event,params:params})};return{attributeSet:function(node,name,new_value,old_value){rememberEvent("attributeSet",[node,name,new_value,old_value])},atomicReferenceSet:function(node,name,new_target,old_target){rememberEvent("atomicReferenceSet",[node,name,new_target,old_target])},orderedReferenceAdded:function(node,name,index,target){rememberEvent("orderedReferenceAdded",[node,name,index,target])},orderedReferenceRemoved:function(node,name,index,target){rememberEvent("orderedReferenceRemoved",[node,name,index,target])},nodeAdded:function(node,initial_attribute_values){rememberEvent("nodeAdded",[node,initial_attribute_values])},nodeRemoved:function(node,attribute_values){rememberEvent("nodeRemoved",[node,attribute_values])},stringInserted:function(node,attribute,string,position){rememberEvent("stringInserted",[node,attribute,string,position])},stringRemoved:function(node,attribute,string,position){rememberEvent("stringRemoved",[node,attribute,string,position])},addModelListener:function(listener){listeners.register(listener)},removeModelListener:function(listener){listeners.unregister(listener)},notifyListeners:function(){var eventsCopy=events.slice(0),nIndex,nMax=eventsCopy.length,event;events=[];for(nIndex=0;nIndex<nMax;nIndex++){event=eventsCopy[nIndex];listeners.notify([event.event],event.params)}}}}}());(function(){sap.galilei.gravity.canIgnoreRemoveNodeListOrderedReferences=function(oNode,oListOrderedReferences){var index,max,sAttribute,oGalileiObject,oSubNodes,oSubNode,bIgnore=false;if(oNode!==undefined&&oListOrderedReferences!==undefined&&oListOrderedReferences.length===1){sAttribute=oListOrderedReferences[0];if(sAttribute==="symbols"){oSubNodes=oNode.getOrderedReference(sAttribute);if(oSubNodes!==undefined&&oSubNodes.length>0){for(index=0,max=oSubNodes.length;index<max;index++){oSubNode=oSubNodes[index];oGalileiObject=oSubNode&&oSubNode.getAttribute("_galileiObject");if(oGalileiObject!==undefined){if(oGalileiObject.isInternal){bIgnore=true}else{bIgnore=false;break}}}}}}return bIgnore};sap.galilei.gravity.canIgnoreRemoveNodeListReverseAtomicReferences=function(oNode,oListReverseAtomicReferences){var index,max,sAttribute,oGalileiObject,oReverseNode,bIgnore=false;if(oNode!==undefined&&oListReverseAtomicReferences!==undefined&&oListReverseAtomicReferences.length===1){sAttribute=oListReverseAtomicReferences[0];if(sAttribute==="object"){oReverseNode=oNode.getReverseAtomicReferences(sAttribute);oGalileiObject=oReverseNode&&(oReverseNode.length>0)&&oReverseNode[0].getAttribute("_galileiObject");if(oGalileiObject!==undefined){if(oGalileiObject.isInternal){bIgnore=true}}}}return bIgnore};sap.galilei.gravity.canIgnoreRemoveNodeListReverseOrderedReferences=function(oNode,oListReverseOrderedReferences){var index,max,sAttribute,oGalileiObject,oReverseNode,bIgnore=false;if(oNode!==undefined&&oListReverseOrderedReferences!==undefined&&oListReverseOrderedReferences.length===1){sAttribute=oListReverseOrderedReferences[0];if(sAttribute==="objects"){oReverseNode=oNode.getReverseOrderedReferences(sAttribute);oGalileiObject=oReverseNode&&(oReverseNode.length>0)&&oReverseNode[0].getAttribute("_galileiObject");if(oGalileiObject!==undefined&&(oGalileiObject.classDefinition&&oGalileiObject.classDefinition.qualifiedName)==="sap.galilei.model.Resource"){bIgnore=true}}}return bIgnore};sap.galilei.gravity.canIgnoreOrderedReferences=function(oNode,sReferenceName){var oGalileiObject,bIgnore=false;if(oNode!==undefined&&oNode.getAttribute&&sReferenceName==="objects"){oGalileiObject=oNode.getAttribute("_galileiObject");if(oGalileiObject!==undefined&&(oGalileiObject.classDefinition&&oGalileiObject.classDefinition.qualifiedName)==="sap.galilei.model.Resource"){bIgnore=true}}return bIgnore}}());var getComputedGetter=function(fnGetter,oFeature,sPropName,sEventType,bIsCached){var sBackingFieldName="__"+sPropName,oGalileiMemberMonitor=sap.galilei.model.GalileiMemberMonitor,fnNotify=function(oInstance){var oEventArgs={eventType:sEventType,instance:oInstance};if(oInstance){if(sEventType==="propertyChange"){oEventArgs.propertyName=sPropName;oInstance.firePropertyChanged(oEventArgs,"update")}else{if(sEventType==="referenceChange"){oEventArgs.referenceName=sPropName;oInstance.fireReferenceChanged(oEventArgs,"update")}}if(oFeature.onChange){oFeature.onChange(oEventArgs)}}},fnClear=function(oInstance,bRemoveFromList,bFireChanged){var oBackingField,aMonitors,index;if(oInstance){bRemoveFromList=(bRemoveFromList===undefined)?false:bRemoveFromList;bFireChanged=(bFireChanged===undefined)?true:bFireChanged;oBackingField=oInstance[sBackingFieldName];if(oBackingField){delete oInstance[sBackingFieldName]}if(bRemoveFromList&&oInstance._aMonitors){aMonitors=oInstance._aMonitors;index=aMonitors.indexOf(this);if(index!==-1){aMonitors.splice(index,1)}}if(bFireChanged&&oInstance.fireMemberChanged){oInstance.fireMemberChanged(sPropName,"clear")}}};return function(){var oBackingField,outerMonitor,sResourceId,oMonitor;if(this.isAlive&&!this.isDeleting){if(oGalileiMemberMonitor.active&&oGalileiMemberMonitor.active._resourceId===this.resource._nodeIdentity){oGalileiMemberMonitor.active.onMemberRead(this,sPropName)}oBackingField=this[sBackingFieldName];if(oBackingField===undefined||bIsCached===false){if(oBackingField){oBackingField.value=fnGetter.call(this,sPropName)}else{outerMonitor=oGalileiMemberMonitor.active;sResourceId=this.resource?this.resource._nodeIdentity:undefined;oMonitor=this.findMonitor(sResourceId,this,sPropName);if(oMonitor){oGalileiMemberMonitor.active=oMonitor}else{oGalileiMemberMonitor.active=new oGalileiMemberMonitor();oGalileiMemberMonitor.active._observedMember=sPropName;oGalileiMemberMonitor.active._resourceId=sResourceId}this[sBackingFieldName]={};oBackingField=this[sBackingFieldName];oBackingField.value=fnGetter.call(this,sPropName);oBackingField.monitor=oGalileiMemberMonitor.active;oBackingField.monitor.attachHandler(fnNotify,fnClear,this);if(outerMonitor){oGalileiMemberMonitor.active=outerMonitor}else{delete oGalileiMemberMonitor.active}}}return oBackingField&&oBackingField.value}return fnGetter.call(this,sPropName)}};var registerNode=function(oNode,oInstance){oNode.setAttribute("_galileiObject",oInstance)};var unregisterNode=function(oNode){oNode.clear("_galileiObject")};sap.galilei.model.gravity.getGalileiObject=function(oNode){return oNode&&oNode.getAttribute("_galileiObject")};var identifyGalileiObject=function(oInstance,oNode,oModelHandler){if(oInstance!==undefined&&oNode!==undefined){oInstance._gravityModelHandler=oModelHandler;oInstance._nodeIdentity=oNode.getIdentity();oInstance._node=oNode}};sap.galilei.model.gravity.getGravityNode=function(oInstance){var oModelHandler;if(oInstance!==undefined){oModelHandler=oInstance._gravityModelHandler;if(oInstance._node===undefined&&oModelHandler!==undefined){oInstance._node=oModelHandler.getModel().getNode(oInstance._nodeIdentity)}return oInstance._node}return undefined};var clearGalileiObject=function(oInstance){if(oInstance!==undefined){delete oInstance._gravityModelHandler;delete oInstance._nodeIdentity;delete oInstance._node}};sap.galilei.model.EXCLUDE_RESOLVE_PROXY_ATTRIBUTES=["proxiedObjectId","proxiedObjectResourceId","proxiedObject","isProxy","isProxyAutoResolve","objectId","_galileiObject"];sap.galilei.model.isAutoResolveProxyProperty=function(sPropertyName){return sPropertyName?(sap.galilei.model.EXCLUDE_RESOLVE_PROXY_ATTRIBUTES.indexOf(sPropertyName)===-1):false};sap.galilei.model.excludeAutoResolveProxyProperties=function(aPropertyNames){var index,max,sPropertyName;if(aPropertyNames){for(index=0,max=aPropertyNames.length;index<max;index++){sPropertyName=aPropertyNames[index];if(sap.galilei.model.EXCLUDE_RESOLVE_PROXY_ATTRIBUTES.indexOf(sPropertyName)===-1){sap.galilei.model.EXCLUDE_RESOLVE_PROXY_ATTRIBUTES.push(sPropertyName)}}}};sap.galilei.model.gravity.ClassDefinitionBuilder={isInUndoRedo:false,deletedObjects:{},_transactionOpened:undefined,loadingAction:"loadingAction",transformClassDef:sap.galilei.core.ClassDefinitionBuilder.transformClassDef,transformProperties:sap.galilei.core.ClassDefinitionBuilder.transformProperties,transformFunctionProperties:sap.galilei.core.ClassDefinitionBuilder.transformFunctionProperties,transformFieldProperties:sap.galilei.core.ClassDefinitionBuilder.transformFieldProperties,transformEnumProperties:sap.galilei.core.ClassDefinitionBuilder.transformEnumProperties,transformCollectionDef:sap.galilei.core.ClassDefinitionBuilder.transformCollectionDef,transformCollectionProperties:function(oExtension,oCollProps){oExtension=oExtension||{};if(oCollProps){var sProperty,vProperty,sPropName,oCollection,oProp;for(sProperty in oCollProps){vProperty=oCollProps[sProperty];if(vProperty){sPropName=sProperty;var isMany=vProperty.isMany;var reference=vProperty.reference;var reverseReference=vProperty.reverseReference;oProp={};if(vProperty.get!==undefined||vProperty.set!==undefined){oProp.get=getComputedGetter(vProperty.get,vProperty.reference,sPropName,"referenceChange",vProperty.isCached);oProp.set=vProperty.set}else{if(isMany){var sBackingField="__"+sProperty+"Collection";var oGalileiMemberMonitor=sap.galilei.model.GalileiMemberMonitor;reverseReference=reverseReference||reference.reverseReference;oProp.get=function(){var backingField=this[sBackingField];if(oGalileiMemberMonitor.active&&oGalileiMemberMonitor.active._resourceId===this.resource._nodeIdentity){oGalileiMemberMonitor.active.onMemberRead(this,sPropName)}if(backingField===undefined){var oNode=sap.galilei.model.gravity.getGravityNode(this);if(oNode==undefined){return}if(reverseReference){sPropName=reverseReference.name}var oResource=this.resource;var oModelHandler=oResource&&oResource.modelHandler;this[sBackingField]=backingField=new sap.galilei.model.GravityCollection();backingField.resource=oResource;backingField.modelHandler=oModelHandler;backingField.referenceName=sPropName;backingField.reference=reference;backingField.reverseReference=reverseReference;backingField.gravityNodeCollectionOwner=oNode}return backingField}}else{oProp.get=function(){var self=this,oResource=this.resource,oActiveReader=oResource&&oResource.activeReader,oProxiedObject,oReferenceLoaded,atomicReference,oNode;if(sap.galilei.model.GalileiMemberMonitor.active&&sap.galilei.model.GalileiMemberMonitor.active._resourceId===this.resource._nodeIdentity){sap.galilei.model.GalileiMemberMonitor.active.onMemberRead(this,sPropName)}if(sap.galilei.model.isAutoResolveProxyProperty(sPropName)){if(!this.isDeleting&&this.isProxy&&this.isProxyAutoResolve){oProxiedObject=this.proxiedObject;if(oProxiedObject){return oProxiedObject[sPropName]}}}oNode=sap.galilei.model.gravity.getGravityNode(this);if(reverseReference){sPropName=reverseReference.name}if(oNode==undefined){return}if(oResource&&reference&&reference.isAsync===true&&oActiveReader&&oActiveReader.isPartialLoadReader&&!reverseReference){oActiveReader.getObjectAtomicReferenceAsync(this,sPropName,false)}atomicReference=reverseReference==null?oNode.getAtomicReference(sPropName):reverseReference.isMany?oNode.getReverseOrderedReferences(sPropName)[0]:oNode.getReverseAtomicReferences(sPropName)[0];if(atomicReference===undefined&&sPropName!=="baseFeature"&&this.baseFeature!==undefined&&(sap.galilei.core.isInstanceOf(this,"Property")||sap.galilei.core.isInstanceOf(this,"Reference"))){return this.baseFeature[sPropName]}return atomicReference!=undefined?sap.galilei.model.gravity.getGalileiObject(atomicReference):undefined};oProp.set=function(oValue){var self=this,oNode,oResource=this.resource,bIsCascadeAllowed=(oResource===undefined)||(oResource.isCascadeAllowed===true),oModelHandler=oResource&&oResource.modelHandler,fnCoerceValue,nIndex,oOldObj;if(oResource&&!oResource.isLoading){fnCoerceValue=reference&&reference.constraint&&reference.constraint.coerceValue;if(fnCoerceValue){oValue=fnCoerceValue.call(reference.constraint,self,oValue)}}oNode=sap.galilei.model.gravity.getGravityNode(this);if(oNode==undefined){return}if(reverseReference){sPropName=reverseReference.name;var oReverseNode=sap.galilei.model.gravity.getGravityNode(oValue);if(oReverseNode){if(reverseReference.isMany){if(sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.isTransactionOpened(oResource)){nIndex=oNode.getOrderedReference(sPropName).length;oReverseNode.addOrderedReference(sPropName,nIndex,oNode);sap.galilei.model.gravity.ClassDefinitionBuilder.notifyReferenceChanged(oValue,bIsCascadeAllowed,reverseReference,self)}else{sap.galilei.model.gravity.ClassDefinitionBuilder.applyUndoableAction(oResource,function(model){nIndex=oNode.getOrderedReference(sPropName).length;oReverseNode.addOrderedReference(sPropName,nIndex,oNode);sap.galilei.model.gravity.ClassDefinitionBuilder.notifyReferenceChanged(oValue,bIsCascadeAllowed,reverseReference,self)},"Add ordered reference : "+sPropName)}}else{if(sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.isTransactionOpened(oResource)){oReverseNode.setAtomicReference(sPropName,oNode);sap.galilei.model.gravity.ClassDefinitionBuilder.notifyReferenceChanged(oValue,bIsCascadeAllowed,reverseReference,self)}else{sap.galilei.model.gravity.ClassDefinitionBuilder.applyUndoableAction(oResource,function(model){oReverseNode.setAtomicReference(sPropName,oNode);sap.galilei.model.gravity.ClassDefinitionBuilder.notifyReferenceChanged(oValue,bIsCascadeAllowed,reverseReference,self)})}}}}else{if(self&&reference){oOldObj=self[reference.name]}if(sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.isTransactionOpened(oResource)){oNode.setAtomicReference(sPropName,oValue!=undefined?sap.galilei.model.gravity.getGravityNode(oValue):oValue);sap.galilei.model.gravity.ClassDefinitionBuilder.notifyReferenceChanged(self,bIsCascadeAllowed,reference,oValue,oOldObj)}else{sap.galilei.model.gravity.ClassDefinitionBuilder.applyUndoableAction(oResource,function(model){oNode.setAtomicReference(sPropName,oValue!=undefined?sap.galilei.model.gravity.getGravityNode(oValue):oValue);sap.galilei.model.gravity.ClassDefinitionBuilder.notifyReferenceChanged(self,bIsCascadeAllowed,reference,oValue,oOldObj)},"set atomic reference '"+sPropName+"'")}}}}}oProp.configurable=true;oExtension[sPropName]=oProp}}}return oExtension},transformValueProperties:function transformValueProperties(oExtension,oProps){oExtension=oExtension||{};if(oProps){var sProperty,vProperty,sPropName,oProp,fnInternalPropertyGetter,fnInternalPropertySetter,oInternalProps={};for(sProperty in oProps){vProperty=oProps[sProperty];if(vProperty){var property=vProperty.property;if(vProperty.isInternal){sPropName=sProperty;oInternalProps[sProperty]={type:sap.galilei.core.EnumPropertyType.property,value:vProperty.value};if(vProperty.isIndex===true){fnInternalPropertyGetter=vProperty.get||function(){return this["__"+sPropName]};fnInternalPropertySetter=vProperty.set?function(vValue){var vCurrentValue=fnInternalPropertyGetter.call(this);vProperty.set.call(this,vValue);this.indexObject(property,vCurrentValue,vValue)}:function(vValue){var vCurrentValue=fnInternalPropertyGetter.call(this);this["__"+sPropName]=vValue;this.indexObject(property,vCurrentValue,vValue)};oInternalProps[sProperty].get=fnInternalPropertyGetter;oInternalProps[sProperty].set=fnInternalPropertySetter}else{if(vProperty.get!==undefined){oInternalProps[sProperty].get=vProperty.get;if(vProperty.set!==undefined){oInternalProps[sProperty].set=vProperty.set}}}}else{sPropName=sProperty;oProp={};var fnGetter=vProperty.get;if(fnGetter!==undefined){fnGetter=getComputedGetter(vProperty.get,property,sPropName,"propertyChange",vProperty.isCached)}oProp.get=fnGetter||function(){var oNode=sap.galilei.model.gravity.getGravityNode(this),oProxiedObject,vNewValue,vNodeAttributeValue,self=this,bIsCascadeAllowed=(self.resource===undefined)||(self.resource.isCascadeAllowed===true);if(oNode){if(sap.galilei.model.GalileiMemberMonitor.active&&sap.galilei.model.GalileiMemberMonitor.active._resourceId===this.resource._nodeIdentity){sap.galilei.model.GalileiMemberMonitor.active.onMemberRead(this,sPropName)}vNodeAttributeValue=oNode.getAttribute(sPropName);if(sap.galilei.model.isAutoResolveProxyProperty(sPropName)&&oNode.getAttribute("proxiedObjectId")!==undefined){if(!this.isDeleting&&this.isProxy&&this.isProxyAutoResolve){oProxiedObject=this.proxiedObject;if(oProxiedObject!==undefined){vNewValue=oProxiedObject[sPropName];if(vNodeAttributeValue!==vNewValue){if(sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.isTransactionOpened(this.resource)){oNode.setAttribute(sPropName,vNewValue,oNode.listener!==undefined);sap.galilei.model.gravity.ClassDefinitionBuilder.notifyPropertyChanged(self,bIsCascadeAllowed,property,vNewValue,undefined)}else{this.resource.applyUndoableAction(function(){oNode.setAttribute(sPropName,vNewValue,oNode.listener!==undefined);sap.galilei.model.gravity.ClassDefinitionBuilder.notifyPropertyChanged(self,bIsCascadeAllowed,property,vNewValue,undefined)},"Set proxied object value as cache",true)}vNodeAttributeValue=vNewValue}}}}if(vNodeAttributeValue===undefined&&sPropName!=="baseFeature"&&this.baseFeature!==undefined&&(sap.galilei.core.isInstanceOf(this,"Property")||sap.galilei.core.isInstanceOf(this,"Reference"))){vNodeAttributeValue=this.baseFeature[sPropName]}return vNodeAttributeValue===undefined?(typeof vProperty.value)==="function"?vProperty.value(this):vProperty.value:vNodeAttributeValue}};oProp.set=vProperty.set||function(vValue){var self=this,oNode,vOldvalue,oTargetInstance,oProxifiedObjectResource,oResource=this.resource,bIsCascadeAllowed=(oResource===null)||(oResource.isCascadeAllowed===true);oNode=sap.galilei.model.gravity.getGravityNode(this);if(oNode){if(!oResource.isLoading){vOldvalue=oNode.getAttribute(sPropName)}if(vValue!==this[sPropName]){if(sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.isTransactionOpened(oResource)){oNode.setAttribute(sPropName,vValue,true);sap.galilei.model.gravity.ClassDefinitionBuilder.notifyPropertyChanged(self,bIsCascadeAllowed,property,vValue,vOldvalue)}else{sap.galilei.model.gravity.ClassDefinitionBuilder.applyUndoableAction(oResource,function(model){oNode.setAttribute(sPropName,vValue,true);sap.galilei.model.gravity.ClassDefinitionBuilder.notifyPropertyChanged(self,bIsCascadeAllowed,property,vValue,vOldvalue)},"Set attribute : '"+sPropName+"'")}if(!this.isDeleting&&this.isProxy&&sap.galilei.model.isAutoResolveProxyProperty(sPropName)){oProxifiedObjectResource=sap.galilei.model.getResource(this.proxiedObjectResourceId);if(oProxifiedObjectResource!==undefined){if(oProxifiedObjectResource.activeReader!==undefined&&oProxifiedObjectResource.activeReader.isPartialLoadReader){jQuery.when(oProxifiedObjectResource.getObjectAsync(self.proxiedObjectId)).done(function(oInstance){if(sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.isTransactionOpened(oProxifiedObjectResource)){sap.galilei.model.gravity.getGravityNode(oInstance).setAttribute(sPropName,vValue,true);sap.galilei.model.gravity.ClassDefinitionBuilder.notifyPropertyChanged(self,bIsCascadeAllowed,property,vValue,vOldvalue)}else{oProxifiedObjectResource.applyUndoableAction(function(){sap.galilei.model.gravity.getGravityNode(oInstance).setAttribute(sPropName,vValue,true);sap.galilei.model.gravity.ClassDefinitionBuilder.notifyPropertyChanged(self,bIsCascadeAllowed,property,vValue,vOldvalue)},"Set property on proxified object",true)}})}else{oTargetInstance=sap.galilei.model.getObject(oProxifiedObjectResource,self.proxiedObjectId);if(oTargetInstance!==undefined){if(sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.isTransactionOpened(oProxifiedObjectResource)){sap.galilei.model.gravity.getGravityNode(oTargetInstance).setAttribute(sPropName,vValue,true);sap.galilei.model.gravity.ClassDefinitionBuilder.notifyPropertyChanged(self,bIsCascadeAllowed,property,vValue,vOldvalue)}else{oProxifiedObjectResource.applyUndoableAction(function(){sap.galilei.model.gravity.getGravityNode(oTargetInstance).setAttribute(sPropName,vValue,true);sap.galilei.model.gravity.ClassDefinitionBuilder.notifyPropertyChanged(self,bIsCascadeAllowed,property,vValue,vOldvalue)},"Set property on proxified object",true)}}}}}}}};oProp.configurable=true;oExtension[sPropName]=oProp}sap.galilei.core.ClassDefinitionBuilder.transformValueProperties(oExtension,oInternalProps)}}}return oExtension},isTransactionOpened:function(oResource){return(oResource&&oResource._transactionId)!==undefined},isMainTransactionProtectedFromUndo:function(oResource){return(oResource&&oResource._openedTransactionProtectedFromUndo)===true},registerTransaction:function(oResource,bIsProtectedFromUndo){if(!sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.isTransactionOpened(oResource)){oResource._transactionId=uuid.v4();oResource._openedTransactionProtectedFromUndo=bIsProtectedFromUndo}},unregisterTransaction:function(oResource){if(sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.isTransactionOpened(oResource)){delete oResource._transactionId;delete oResource._openedTransactionProtectedFromUndo}},getLastComplexOperation:function(oResource){var aComplexOperations,oLastComplexOperation;if(oResource){aComplexOperations=oResource.modelHandler.getOperationsQueue().getOperations();if(aComplexOperations.length>0){oLastComplexOperation=aComplexOperations[aComplexOperations.length-1]}}return oLastComplexOperation},canUndo:function(oResource){return oResource.modelHandler.canUndoChange()},canRedo:function(oResource){return oResource.modelHandler.canRedoChange()},undo:function(oResource){var oLastComplexOperation,aResult=[],bSuccess;if(oResource){oLastComplexOperation=this.getLastComplexOperation(oResource);sap.galilei.model.gravity.ClassDefinitionBuilder.isInUndoRedo=true;bSuccess=oResource.modelHandler.undoChange();sap.galilei.model.gravity.ClassDefinitionBuilder.isInUndoRedo=false;if(bSuccess){if(oLastComplexOperation&&oLastComplexOperation.description===sap.galilei.model.gravity.ClassDefinitionBuilder.loadingAction&&this.canUndo(oResource)){return this.undo(oResource)}else{oLastComplexOperation=this.getLastComplexOperation(oResource);if(oLastComplexOperation){aResult=this.getListOfActions(oResource,false,oLastComplexOperation.sequence)}}}else{console.log("Undo failed.")}}return aResult},redo:function(oResource){var aComplexOperations,oLastComplexOperation,aResult=[],bSuccess;if(oResource){sap.galilei.model.gravity.ClassDefinitionBuilder.isInUndoRedo=true;bSuccess=oResource.modelHandler.redoChange();sap.galilei.model.gravity.ClassDefinitionBuilder.isInUndoRedo=false;if(bSuccess){oLastComplexOperation=this.getLastComplexOperation(oResource);if(oLastComplexOperation){aResult=this.getListOfActions(oResource,false,oLastComplexOperation.sequence)}else{console.log("Redo failed.")}}}return aResult},applyUndoableAction:function(oResource,fnFunction,sDescription,bIsProtectedFromUndo,bBatchMode,fnPostApplyAction){var self=this,aComplexOperations,oLastComplexOperation,aResult;bIsProtectedFromUndo=(bIsProtectedFromUndo===undefined)?false:bIsProtectedFromUndo;bBatchMode=(bBatchMode===undefined)?false:bBatchMode;fnPostApplyAction=fnPostApplyAction||sap.galilei.model.getDefaultPostApplyAction();if(oResource!==undefined&&fnFunction!==undefined){if(oResource.isInUndoRedo){oResource.modelHandler.changeModel(function(model){fnFunction.call(oResource,model)},"Undo/Redo",true);return}if(!this.isTransactionOpened(oResource)){try{sap.galilei.core.http.forceSynchronous=true;if(bBatchMode===true){oResource.isBatchModeEnabled=true;oResource._modifiedObjects=[];oResource._propertyChangedEventArgs=[];oResource._referenceChangedEventArgs=[]}this.registerTransaction(oResource,bIsProtectedFromUndo);oResource.modelHandler.changeModel(function(model){fnFunction.call(oResource,model);if((bBatchMode===true)&&(oResource.skipNotifications!==true)){self.batchChangeNotifications(oResource)}},sDescription,bIsProtectedFromUndo,false)}finally{delete sap.galilei.core.http.forceSynchronous;if(bBatchMode===true){delete oResource._skipObjectNotification;delete oResource._modifiedObjects;delete oResource._propertyChangedEventArgs;delete oResource._referenceChangedEventArgs}this.unregisterTransaction(oResource)}}else{if(bIsProtectedFromUndo){oResource.modelHandler.changeModel(function(model){fnFunction.call(oResource,model)},sDescription,bIsProtectedFromUndo,true)}else{fnFunction.call(oResource,oResource.modelHandler.getModel())}}if(fnPostApplyAction!==undefined&&bBatchMode!==true&&bIsProtectedFromUndo!==true&&!this.isTransactionOpened(oResource)){aComplexOperations=oResource.modelHandler.getOperationsQueue().getOperations();if(aComplexOperations!==undefined&&aComplexOperations.length>0){oLastComplexOperation=aComplexOperations[aComplexOperations.length-1];aResult=oLastComplexOperation&&this.getListOfActions(oResource,false,oLastComplexOperation.sequence);if(aResult!==undefined&&aResult.length>0){fnPostApplyAction(aResult,oResource,sDescription)}}}}return aResult},batchChangeNotifications:function(oResource){var nModifiedObjectsIndex,nModifiedObjectsCount,oCurrentModifiedObject,nPropertyEventArgsIndex,nPropertyEventArgsCount,oCurrentPropertyEventArgs,nReferenceEventArgsIndex,nReferenceEventArgsCount,oCurrentReferenceEventArgs;for(nModifiedObjectsIndex=0,nModifiedObjectsCount=oResource._modifiedObjects.length;nModifiedObjectsIndex<nModifiedObjectsCount;nModifiedObjectsIndex++){oCurrentModifiedObject=oResource._modifiedObjects[nModifiedObjectsIndex];oCurrentModifiedObject.fireObjectChanged({object:oCurrentModifiedObject,batchMode:true})}oResource.isBatchModeEnabled=false;oResource._skipObjectNotification=true;for(nPropertyEventArgsIndex=0,nPropertyEventArgsCount=oResource._propertyChangedEventArgs.length;nPropertyEventArgsIndex<nPropertyEventArgsCount;nPropertyEventArgsIndex++){oCurrentPropertyEventArgs=oResource._propertyChangedEventArgs[nPropertyEventArgsIndex];oCurrentPropertyEventArgs.instance.firePropertyChanged(oCurrentPropertyEventArgs.eventArgs,oCurrentPropertyEventArgs.pass,oCurrentPropertyEventArgs.isCascadeAllowed,true)}for(nReferenceEventArgsIndex=0,nReferenceEventArgsCount=oResource._referenceChangedEventArgs.length;nReferenceEventArgsIndex<nReferenceEventArgsCount;nReferenceEventArgsIndex++){oCurrentReferenceEventArgs=oResource._referenceChangedEventArgs[nReferenceEventArgsIndex];oCurrentReferenceEventArgs.instance.fireReferenceChanged(oCurrentReferenceEventArgs.eventArgs,oCurrentReferenceEventArgs.pass,true)}},getGravityActionList:function(oResource,bOptimize){var aComplexOperations=oResource.modelHandler.getOperationsQueue().getOperations(),aSequenceItems,oPreviousComplexOperation,oComplexOperation,oPrimitiveOperation,nOperationIndex,nInnerIndex,oOperationToTransformAgainst,oTransformedOperation,nSequenceItemIndex,nOperationCount,nSequenceItemsCount,aPrimitiveOperations=[],aResult=[],oMapTransfo,oMapDeleted,aObjectIndexes,nObjectSubIndex,sObjectId,sResourceId=oResource.resourceId;if(bOptimize){for(nOperationIndex=1;nOperationIndex<aComplexOperations.length;nOperationIndex++){oComplexOperation=aComplexOperations[nOperationIndex];oPreviousComplexOperation=aComplexOperations[nOperationIndex-1];if(oComplexOperation.description===sap.galilei.model.gravity.ClassDefinitionBuilder.loadingAction){continue}if(oPreviousComplexOperation.isPartOfUndo===true&&oComplexOperation.isPartOfUndo===true&&oComplexOperation.revertedOperation!==undefined&&oComplexOperation.revertedOperation===oPreviousComplexOperation){aComplexOperations.splice(nOperationIndex-1,2);nOperationIndex-=1}}}for(nOperationIndex=0,nOperationCount=aComplexOperations.length;nOperationIndex<nOperationCount;nOperationIndex++){oComplexOperation=aComplexOperations[nOperationIndex];if(oComplexOperation.description===sap.galilei.model.gravity.ClassDefinitionBuilder.loadingAction){continue}aSequenceItems=oComplexOperation.sequence;for(nSequenceItemIndex=0,nSequenceItemsCount=aSequenceItems.length;nSequenceItemIndex<nSequenceItemsCount;nSequenceItemIndex++){if(aSequenceItems[nSequenceItemIndex].nestedTransactionDescription!==sap.galilei.model.gravity.ClassDefinitionBuilder.loadingAction){aPrimitiveOperations.push(aSequenceItems[nSequenceItemIndex])}}}if(bOptimize){oMapDeleted={};for(nOperationIndex=0,nOperationCount=aPrimitiveOperations.length;nOperationIndex<nOperationCount;nOperationIndex++){oPrimitiveOperation=aPrimitiveOperations[nOperationIndex];if(oPrimitiveOperation&&oPrimitiveOperation.getFlavor()==="deleteObject"){sObjectId=oPrimitiveOperation.getObjectId();oMapDeleted[sObjectId]=oPrimitiveOperation}}oMapTransfo={};for(nOperationIndex=0,nOperationCount=aPrimitiveOperations.length;nOperationIndex<nOperationCount;nOperationIndex++){oPrimitiveOperation=aPrimitiveOperations[nOperationIndex];if(oPrimitiveOperation){sObjectId=oPrimitiveOperation.getObjectId();if(!oMapTransfo[sObjectId]){oMapTransfo[sObjectId]=[]}if(sObjectId===sResourceId){continue}aObjectIndexes=oMapTransfo[sObjectId];aObjectIndexes.push(nOperationIndex);if(oPrimitiveOperation.getTargetId){sObjectId=oPrimitiveOperation.getTargetId();if(sObjectId&&oMapDeleted[sObjectId]){if(!oMapTransfo[sObjectId]){oMapTransfo[sObjectId]=[]}aObjectIndexes.push(nOperationIndex)}}}}for(nOperationIndex=0,nOperationCount=aPrimitiveOperations.length;nOperationIndex<nOperationCount;nOperationIndex++){oPrimitiveOperation=aPrimitiveOperations[nOperationIndex];if(oPrimitiveOperation){sObjectId=oPrimitiveOperation.getObjectId();aObjectIndexes=oMapTransfo[sObjectId];if(aObjectIndexes._last===undefined){aObjectIndexes._last=0}for(nObjectSubIndex=aObjectIndexes._last;nObjectSubIndex<aObjectIndexes.length;nObjectSubIndex++){nInnerIndex=aObjectIndexes[nObjectSubIndex];if(nInnerIndex<=nOperationIndex){aObjectIndexes._last=nObjectSubIndex+1;continue}oOperationToTransformAgainst=aPrimitiveOperations[nInnerIndex];if(oOperationToTransformAgainst){if(oPrimitiveOperation.requiresTransform(oOperationToTransformAgainst)){oTransformedOperation=oPrimitiveOperation.transform(oOperationToTransformAgainst);if(oTransformedOperation===undefined){if((oPrimitiveOperation.old_value!==undefined||oPrimitiveOperation.new_value!==undefined)&&(oOperationToTransformAgainst.old_value!==undefined||oOperationToTransformAgainst.new_value!==undefined)&&oPrimitiveOperation.object_id==oOperationToTransformAgainst.object_id){if(oPrimitiveOperation.old_value==oOperationToTransformAgainst.new_value){aPrimitiveOperations[nInnerIndex]=undefined}else{oOperationToTransformAgainst.old_value=oPrimitiveOperation.old_value}}else{if((oPrimitiveOperation.old_target_id!==undefined||oPrimitiveOperation.new_target_id!==undefined)&&(oOperationToTransformAgainst.old_target_id!==undefined||oOperationToTransformAgainst.new_target_id!==undefined)&&oPrimitiveOperation.object_id==oOperationToTransformAgainst.object_id){if(oPrimitiveOperation.old_target_id==oOperationToTransformAgainst.new_target_id){aPrimitiveOperations[nInnerIndex]=undefined}else{oOperationToTransformAgainst.old_target_id=oPrimitiveOperation.old_target_id}}else{if(oPrimitiveOperation.constructor&&oPrimitiveOperation.constructor.prototype&&oPrimitiveOperation.target_id!==undefined&&oOperationToTransformAgainst.constructor&&oOperationToTransformAgainst.constructor.prototype&&((oPrimitiveOperation.constructor.prototype.flavor=="removeReference"&&oOperationToTransformAgainst.constructor.prototype.flavor=="addReference")||(oPrimitiveOperation.constructor.prototype.flavor=="addReference"&&oOperationToTransformAgainst.constructor.prototype.flavor=="removeReference"))&&oOperationToTransformAgainst.target_id!==undefined&&oPrimitiveOperation.target_id==oOperationToTransformAgainst.target_id&&oPrimitiveOperation.reference_name==oOperationToTransformAgainst.reference_name){if(oPrimitiveOperation.index===oOperationToTransformAgainst.index){aPrimitiveOperations[nInnerIndex]=undefined}else{aResult.push(oPrimitiveOperation)}}}}oPrimitiveOperation=undefined;break}else{oPrimitiveOperation=oTransformedOperation}}}}if(oPrimitiveOperation){aResult.push(oPrimitiveOperation)}}}}else{aResult=aPrimitiveOperations}return aResult},getListOfActions:function(oResource,bOptimize,aListOfGravityActions,bStopOnFirst){var aPrimitiveOperations=aListOfGravityActions||this.getGravityActionList(oResource,bOptimize),oCurrentOperation,nOperationIndex,nOperationCount,oCurrentProperty,oCurrentReference,oCurrentObject,oDeleteAction,aResult=[],oMapDeleted={};for(nOperationIndex=0,nOperationCount=aPrimitiveOperations.length;nOperationIndex<nOperationCount;nOperationIndex++){oCurrentOperation=aPrimitiveOperations[nOperationIndex];if(oCurrentOperation&&oCurrentOperation.getFlavor()==="deleteObject"){oMapDeleted[oCurrentOperation.getObjectId()]=oCurrentOperation}}for(nOperationIndex=0,nOperationCount=aPrimitiveOperations.length;nOperationIndex<nOperationCount;nOperationIndex++){oCurrentOperation=aPrimitiveOperations[nOperationIndex].toJSON();oCurrentObject=sap.galilei.model.getObject(oResource,oCurrentOperation.objectId);if(oCurrentOperation.operation==="addObject"){if(oCurrentObject&&oCurrentObject.classDefinition&&!oCurrentObject.classDefinition.isVolatile){aResult.push(new sap.galilei.model.CreateObjectAction({objectId:oCurrentOperation.objectId,classQualifiedName:oCurrentObject.classDefinition.qualifiedName,featureValues:oCurrentObject.initial_attribute_values}));if(bStopOnFirst){break}}}else{if(oCurrentOperation.operation==="deleteObject"){oCurrentObject=oCurrentOperation.to_be_deleted_attribute_values._galileiObject;if(oCurrentObject&&oCurrentObject.classDefinition&&!oCurrentObject.classDefinition.isVolatile){aResult.push(new sap.galilei.model.DeleteObjectAction({objectId:oCurrentOperation.objectId,deletedObject:oCurrentObject}));if(bStopOnFirst){break}}}else{if(oCurrentOperation.operation==="updateAttribute"){oCurrentProperty=oCurrentObject&&oCurrentObject.classDefinition&&oCurrentObject.classDefinition.allProperties[oCurrentOperation.name];if(oCurrentObject&&oCurrentObject.classDefinition&&!oCurrentObject.classDefinition.isVolatile&&oCurrentProperty&&!oCurrentProperty.isVolatile){aResult.push(new sap.galilei.model.SetAttributeAction({objectId:oCurrentOperation.objectId,attributeName:oCurrentOperation.name,oldValue:oCurrentOperation.oldValue,newValue:oCurrentOperation.newValue}));if(bStopOnFirst){break}}}else{if(oCurrentOperation.operation==="addReference"){oCurrentReference=oCurrentObject&&oCurrentObject.classDefinition&&oCurrentObject.classDefinition.allReferences[oCurrentOperation.name];if(oCurrentObject&&oCurrentObject.classDefinition&&!oCurrentObject.classDefinition.isVolatile&&oCurrentReference&&!oCurrentReference.isVolatile){aResult.push(new sap.galilei.model.AddReferenceObjectAction({objectId:oCurrentOperation.objectId,referenceName:oCurrentOperation.name,newObjectId:oCurrentOperation.targetId,index:oCurrentOperation.index}));if(bStopOnFirst){break}}}else{if(oCurrentOperation.operation==="removeReference"){if(oCurrentObject===undefined){oDeleteAction=oMapDeleted[oCurrentOperation.objectId];if(oDeleteAction){oCurrentObject=oDeleteAction.to_be_deleted_attribute_values._galileiObject}}oCurrentReference=oCurrentObject&&oCurrentObject.classDefinition&&oCurrentObject.classDefinition.allReferences[oCurrentOperation.name];if(oCurrentObject&&!oCurrentObject.isVolatile&&oCurrentObject.classDefinition&&!oCurrentObject.classDefinition.isVolatile&&oCurrentReference&&!oCurrentReference.isVolatile){aResult.push(new sap.galilei.model.RemoveReferenceObjectAction({objectId:oCurrentOperation.objectId,referenceName:oCurrentOperation.name,oldObjectId:oCurrentOperation.targetId,index:oCurrentOperation.index}));if(bStopOnFirst){break}}}else{if(oCurrentOperation.operation==="setReference"){oCurrentReference=oCurrentObject&&oCurrentObject.classDefinition&&oCurrentObject.classDefinition.allReferences[oCurrentOperation.name];if(oCurrentObject&&oCurrentObject.classDefinition&&!oCurrentObject.classDefinition.isVolatile&&oCurrentReference&&!oCurrentReference.isVolatile){aResult.push(new sap.galilei.model.SetReferenceObjectAction({objectId:oCurrentOperation.objectId,referenceName:oCurrentOperation.name,oldObjectId:oCurrentOperation.oldTargetId,newObjectId:oCurrentOperation.newTargetId}));if(bStopOnFirst){break}}}}}}}}}return aResult},findDeleteAction:function(aListOfActions,deletedObjectId){var oCurrentOperation,nOperationIndex,nOperationCount,oResult;for(nOperationIndex=0,nOperationCount=aListOfActions.length;nOperationIndex<nOperationCount;nOperationIndex++){oCurrentOperation=aListOfActions[nOperationIndex].toJSON();if(oCurrentOperation.operation==="deleteObject"&&oCurrentOperation.objectId===deletedObjectId){oResult=oCurrentOperation;break}}return oResult},clearListOfActions:function(oResource){if(oResource===undefined){throw"NullArgumentException"}var oOperationQueue=oResource.modelHandler.getOperationsQueue();oOperationQueue.acknowledgeOperation(oOperationQueue.getTimestamp())},getObject:function getObject(oResource,sIdentity){var oModelHandler=oResource.modelHandler,oNode=oModelHandler&&oModelHandler.getModel().getNode(sIdentity);return oNode&&sap.galilei.model.gravity.getGalileiObject(oNode)},notifyPropertyChanged:function(oInstance,bIsCascadeAllowed,oProperty,vNewValue,vOldValue){var oClassDefinition=oInstance&&oInstance.classDefinition,oResource=oInstance&&oInstance.resource,bSkipNotifications=(oResource!=null)&&(oResource.skipNotifications===true),oEventArgs;if(oProperty==="_galileiObject"&&vNewValue===undefined&&vOldValue!==undefined){vOldValue._node=undefined}else{if(bSkipNotifications!==true){if(oClassDefinition!=undefined&&oProperty!==undefined){if(oProperty.isIndex===true){oInstance.indexObject(oProperty,vOldValue,vNewValue)}oEventArgs={eventType:"propertyChange",instance:oInstance,propertyName:oProperty.name,newValue:vNewValue,oldValue:vOldValue};if(bIsCascadeAllowed&&oProperty.onCascadeChange){oProperty.onCascadeChange(oEventArgs)}if(oProperty.onChange){oProperty.onChange(oEventArgs)}if(oInstance.firePropertyChanged){oInstance.firePropertyChanged(oEventArgs,"all",bIsCascadeAllowed)}}}}},notifyReferenceChanged:function(oInstance,bIsCascadeAllowed,oReference,oNewObject,oOldObject,nIndex){var oClassDefinition=oInstance&&oInstance.classDefinition,oReverseObjectClassDefinition=(oNewObject&&oNewObject.classDefinition)||(oOldObject&&oOldObject.classDefinition),oChildrenReference,reverseReferences,nReverseReferenceIndex,nReverseReferenceCount,oExplicitReverseReferences,oEventArgs={},oResource=oInstance&&oInstance.resource,bSkipNotifications=(oResource!==undefined&&oResource.skipNotifications===true)||(oReference!==undefined&&oReference.skipNotifications===true),bMaxOne=false;if(!bSkipNotifications&&(oClassDefinition!==undefined)){if(oReference!==undefined){if(oInstance.resource.clearingReference==oReference.name){if(nIndex==0){delete oInstance.resource.clearingReference;oEventArgs={eventType:"referenceClear",instance:oInstance,referenceName:oReference.name}}}else{if(oReference.isMany){oEventArgs={eventType:oNewObject?"referenceAdd":"referenceRemove",instance:oInstance,referenceName:oReference.name,newObject:oNewObject,oldObject:oOldObject,index:nIndex};if(oReference.isContainment){oChildrenReference=sap.galilei.model.getReference("sap.galilei.model.Object.children");if(oChildrenReference){oChildrenReference.onChange({eventType:oNewObject?"referenceAdd":"referenceRemove",instance:oInstance,referenceName:"children",newObject:oNewObject,oldObject:oOldObject})}}}else{oEventArgs={eventType:"atomicReferenceChange",instance:oInstance,referenceName:oReference.name,newObject:oNewObject,oldObject:oOldObject};bMaxOne=true}}if(bIsCascadeAllowed&&oReference.onCascadeChange&&(!bMaxOne||oNewObject!==oOldObject)){oReference.onCascadeChange(oEventArgs)}if(oReference.onChange){oReference.onChange(oEventArgs)}if(oInstance.fireReferenceChanged){oInstance.fireReferenceChanged(oEventArgs)}if(oReverseObjectClassDefinition!==undefined){reverseReferences=sap.galilei.model.gravity.ClassDefinitionBuilder.getReverseReference(oNewObject||oOldObject,oReference);if(reverseReferences!==undefined){for(nReverseReferenceIndex=0,nReverseReferenceCount=reverseReferences.explicitReverseReferences.length;nReverseReferenceIndex<nReverseReferenceCount;nReverseReferenceIndex++){oExplicitReverseReferences=reverseReferences.explicitReverseReferences[nReverseReferenceIndex];if(oExplicitReverseReferences!==undefined){if(oExplicitReverseReferences.isMany){oEventArgs={eventType:oNewObject?"referenceAdd":"referenceRemove",instance:oNewObject||oOldObject,referenceName:oExplicitReverseReferences.name,newObject:oNewObject?oInstance:undefined,oldObject:oOldObject?oInstance:undefined}}else{oEventArgs={eventType:oNewObject?"atomicReferenceChange":"atomicReferenceClear",instance:oNewObject||oOldObject,referenceName:oExplicitReverseReferences.name,newObject:oNewObject?oInstance:undefined,oldObject:oOldObject?oInstance:undefined}}if(bIsCascadeAllowed&&oExplicitReverseReferences.onCascadeChange){oExplicitReverseReferences.onCascadeChange(oEventArgs)}if(oExplicitReverseReferences.onChange){oExplicitReverseReferences.onChange(oEventArgs)}if(oNewObject&&oNewObject.fireReferenceChanged){oNewObject.fireReferenceChanged(oEventArgs)}if(oOldObject&&oOldObject.fireReferenceChanged){oOldObject.fireReferenceChanged(oEventArgs)}}}}}}}},notifyObjectDeleted:function(sIdentity,oInstance){var oClassDefinition,oAllReferencesCollection,sReferenceName,sBackingFieldName,oReference;if(oInstance){oClassDefinition=oInstance.classDefinition;oAllReferencesCollection=oClassDefinition&&oClassDefinition.allReferences;while(oClassDefinition){if(oClassDefinition.onDelete){oClassDefinition.onDelete.call(oInstance,{eventType:sap.galilei.model.ActionTypes.deleteObject,instance:oInstance})}oClassDefinition=oClassDefinition.parent}for(sReferenceName in oAllReferencesCollection){oReference=oAllReferencesCollection[sReferenceName];if(oReference&&oReference.isMany){sBackingFieldName="__"+sReferenceName+"Collection";delete oInstance[sBackingFieldName]}}}},onInitializeResource:function onInitializeResource(oResource,sObjectId){var oModelHandler=sap.galilei.gravity.createModelHandler(),oDeferredNode;oModelHandler.initialize(0,[],[]);oResource.modelHandler=oModelHandler;oResource.modelHandler.addModelListener({attributeSet:function(node,name,new_value,old_value){var oInstance=sap.galilei.model.gravity.getGalileiObject(node),oProxifiedObjectResource,oProxifiedOject;if(oInstance&&sap.galilei.model.gravity.ClassDefinitionBuilder.isInUndoRedo){sap.galilei.model.gravity.ClassDefinitionBuilder.notifyPropertyChanged(oInstance,false,(name==="_galileiObject"?name:oInstance.classDefinition.getFeature(name)),new_value,old_value);if(oInstance.isProxy&&sap.galilei.model.isAutoResolveProxyProperty(name)){oProxifiedObjectResource=sap.galilei.model.getResource(oInstance.proxiedObjectResourceId);if(oProxifiedObjectResource!==undefined){oProxifiedOject=sap.galilei.model.getObject(oProxifiedObjectResource,oInstance.proxiedObjectId);if(oProxifiedOject!==undefined){if(sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.isTransactionOpened(oProxifiedObjectResource)){sap.galilei.model.gravity.getGravityNode(oProxifiedOject).setAttribute(name,new_value,true)}else{oProxifiedObjectResource.applyUndoableAction(function(){sap.galilei.model.gravity.getGravityNode(oProxifiedOject).setAttribute(name,new_value,true)},"Propagate change to proxied object",true)}}}}}else{if(oInstance===undefined&&name==="_galileiObject"&&new_value===undefined){sap.galilei.model.gravity.ClassDefinitionBuilder.deletedObjects[node.identity]=old_value}}},atomicReferenceSet:function(node,name,new_target,old_target){var oInstance=sap.galilei.model.gravity.getGalileiObject(node),oNewObject=(new_target!=undefined?sap.galilei.model.gravity.getGalileiObject(new_target):undefined),oOldObject=(old_target!=undefined?sap.galilei.model.gravity.getGalileiObject(old_target):undefined);if(oInstance&&sap.galilei.model.gravity.ClassDefinitionBuilder.isInUndoRedo){sap.galilei.model.gravity.ClassDefinitionBuilder.notifyReferenceChanged(oInstance,false,oInstance.classDefinition.getFeature(name),oNewObject,oOldObject)}},orderedReferenceAdded:function(node,name,index,target){var oInstance=sap.galilei.model.gravity.getGalileiObject(node),oObject=(target!=undefined?sap.galilei.model.gravity.getGalileiObject(target):undefined);if(oInstance&&sap.galilei.model.gravity.ClassDefinitionBuilder.isInUndoRedo){sap.galilei.model.gravity.ClassDefinitionBuilder.notifyReferenceChanged(oInstance,false,oInstance.classDefinition.getFeature(name),oObject,undefined,index)}},orderedReferenceRemoved:function(that,name,indexOrObject,target){var oInstance=sap.galilei.model.gravity.getGalileiObject(that),oObject=(target!=undefined?sap.galilei.model.gravity.getGalileiObject(target):undefined);if(oInstance&&sap.galilei.model.gravity.ClassDefinitionBuilder.isInUndoRedo){sap.galilei.model.gravity.ClassDefinitionBuilder.notifyReferenceChanged(oInstance,false,oInstance.classDefinition.getFeature(name),undefined,oObject,indexOrObject)}},nodeAdded:function(node,initial_attribute_values){var oInstance=sap.galilei.model.gravity.getGalileiObject(node);if(oInstance&&sap.galilei.model.gravity.getGravityNode(oInstance)===undefined){identifyGalileiObject(oInstance,node,oModelHandler)}if(oInstance&&!oInstance.isAlive){oInstance.isAlive=true;if(sap.galilei.model.gravity.ClassDefinitionBuilder.isInUndoRedo){oInstance.indexObjectProperties()}}},nodeRemoved:function(node,attribute_values){var sIdentity=node.identity,oInstance=sap.galilei.model.gravity.ClassDefinitionBuilder.deletedObjects[sIdentity]||attribute_values._galileiObject;sap.galilei.model.gravity.ClassDefinitionBuilder.notifyObjectDeleted(sIdentity,oInstance);delete sap.galilei.model.gravity.ClassDefinitionBuilder.deletedObjects[sIdentity];clearGalileiObject(oInstance);if(oInstance&&oInstance.isAlive){oInstance.isAlive=false;if(sap.galilei.model.gravity.ClassDefinitionBuilder.isInUndoRedo){oInstance.unindexObject()}}}});if(sap.galilei.model.gravity.getGravityNode(oResource)==undefined){if(sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.isTransactionOpened(oResource)){identifyGalileiObject(oResource,model.addNode(sObjectId||uuid.v4()),oModelHandler);sap.galilei.model.gravity.getGravityNode(oResource).setAttribute("resourceId",sObjectId,true);sap.galilei.core.extend(oResource,{resource:oResource},true);registerNode(sap.galilei.model.gravity.getGravityNode(oResource),oResource)}else{sap.galilei.model.gravity.ClassDefinitionBuilder.applyUndoableAction(oResource,function(model){identifyGalileiObject(oResource,model.addNode(sObjectId||uuid.v4()),oModelHandler);sap.galilei.model.gravity.getGravityNode(oResource).setAttribute("resourceId",sObjectId,true);sap.galilei.core.extend(oResource,{resource:oResource},true);registerNode(sap.galilei.model.gravity.getGravityNode(oResource),oResource)},"Add new node to model",true)}}this.clearUndoStack(oResource);this.clearRedoStack(oResource);this.clearListOfActions(oResource);return oResource},clearUndoStack:function(oResource){if(oResource===undefined){throw"ArgumentNullException"}oResource.modelHandler.protectAgainstUndo()},clearRedoStack:function(oResource){if(oResource===undefined){throw"ArgumentNullException"}oResource.modelHandler.protectAgainstUndo()},onInitializeObject:function onInitializeObject(oClass,oResource,sObjectId){var oModelHandler,oNewNode;if(sap.galilei.model.gravity.getGravityNode(oClass)==undefined&&oResource!=undefined&&oResource.modelHandler!=undefined){sObjectId=sObjectId||uuid.v4();oModelHandler=oResource.modelHandler;sap.galilei.core.extend(oClass,{resource:oResource},true);if(sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.isTransactionOpened(oResource)){oNewNode=oModelHandler.getModel().addNode(sObjectId);registerNode(oNewNode,oClass)}else{sap.galilei.model.gravity.ClassDefinitionBuilder.applyUndoableAction(oResource,function(model){oNewNode=model.addNode(sObjectId);registerNode(oNewNode,oClass)},"Add new node to model")}if(oNewNode){identifyGalileiObject(oClass,oNewNode,oModelHandler)}}},onInitializeReference:function onInitializeReference(oRuntimeClass,sContentType,sName){var ReferenceCollection=sap.galilei.model.defineCollection({objectClass:sContentType});var oReferenceToAdd={};oReferenceToAdd[sName]=new ReferenceCollection();sap.galilei.core.extend(oRuntimeClass,oReferenceToAdd,true)},getReverseReference:function getReverseReference(oInstance,vDirectReferenceQualifiedNameOrInstance,bStrict){var oNode=sap.galilei.model.gravity.getGravityNode(oInstance),reverseReferences,oReferenceNode,aReverseReferencesNodes=[],oCurrentReverseReferenceNode,oCurrentReverseReference,aExplicitReverseReferences=[],aValues=[],aCurrentReverseReferenceNodes,sReferenceName,nIndex,max,nNodeIndex,nodeMax;if(bStrict==undefined){bStrict=true}if(oNode==undefined){return}var oReference=typeof(vDirectReferenceQualifiedNameOrInstance)=="string"?sap.galilei.model.getReference(vDirectReferenceQualifiedNameOrInstance):vDirectReferenceQualifiedNameOrInstance;if(oReference===undefined){if(bStrict===true){throw"Reference not found"}else{sReferenceName=vDirectReferenceQualifiedNameOrInstance}}else{sReferenceName=oReference.name}oReferenceNode=oReference&&sap.galilei.model.gravity.getGravityNode(oReference);if(oReferenceNode!==undefined){aReverseReferencesNodes=oReferenceNode.getReverseAtomicReferences("reverseReference");for(nIndex=0,max=aReverseReferencesNodes.length;nIndex<max;nIndex++){oCurrentReverseReferenceNode=aReverseReferencesNodes[nIndex];oCurrentReverseReference=oCurrentReverseReferenceNode&&sap.galilei.model.gravity.getGalileiObject(oCurrentReverseReferenceNode);if(oCurrentReverseReference!==undefined){aExplicitReverseReferences.push(oCurrentReverseReference)}}}aCurrentReverseReferenceNodes=oNode.getReverseOrderedReferences(sReferenceName);for(nNodeIndex=0,nodeMax=aCurrentReverseReferenceNodes.length;nNodeIndex<nodeMax;nNodeIndex++){aValues.push(sap.galilei.model.gravity.getGalileiObject(aCurrentReverseReferenceNodes[nNodeIndex]))}aCurrentReverseReferenceNodes=oNode.getReverseAtomicReferences(sReferenceName);for(nNodeIndex=0,nodeMax=aCurrentReverseReferenceNodes.length;nNodeIndex<nodeMax;nNodeIndex++){aValues.push(sap.galilei.model.gravity.getGalileiObject(aCurrentReverseReferenceNodes[nNodeIndex]))}reverseReferences={explicitReverseReferences:aExplicitReverseReferences,values:aValues};return reverseReferences},getObjectId:function getObjectId(oInstance){if(sap.galilei.model.gravity.getGravityNode(oInstance)===undefined){return}return sap.galilei.model.gravity.getGravityNode(oInstance).getIdentity()},getChildren:function getChildren(oInstance){return new sap.galilei.model.ChildrenCollection({container:oInstance})},deleteObject:function(oInstance){var oNode=sap.galilei.model.gravity.getGravityNode(oInstance),oResource=oInstance.resource;if(oNode===undefined){return}sap.galilei.model.gravity.ClassDefinitionBuilder.deletedObjects[oNode.identity]=oInstance;if(oResource!=undefined&&oResource.modelHandler!=undefined){oInstance.isAlive=false;oInstance.unindexObject();if(sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.isTransactionOpened(oResource)){oResource.modelHandler.getModel().deleteNode(oNode.getIdentity())}else{sap.galilei.model.gravity.ClassDefinitionBuilder.applyUndoableAction(oResource,function(model){model.deleteNode(oNode.getIdentity())},"Deleting node")}}delete oInstance._node},clearMonitors:function(oInstance){var aMonitors=oInstance&&oInstance._aMonitors&&oInstance._aMonitors.slice(0),nMonitorsCount=aMonitors?aMonitors.length||0:0,index;if(oInstance){for(index=0;index<nMonitorsCount;index++){aMonitors[index].detachHandler()}delete oInstance._aMonitors}},findMonitor:function(oInstance,sResourceid,oTargetInstance,sPropertyName){var aMonitors=oInstance&&oInstance._aMonitors&&oInstance._aMonitors.slice(0),nMonitorsCount=aMonitors?aMonitors.length||0:0,index,oMonitor;if(oInstance&&sResourceid&&oTargetInstance&&sPropertyName){for(index=0;index<nMonitorsCount;index++){oMonitor=aMonitors[index];if(oMonitor._resourceId===sResourceid&&oMonitor.target===oTargetInstance&&oMonitor._observedMember===sPropertyName){return oMonitor}}}return undefined},getContainer:function getContainer(oInstance){var oNode=sap.galilei.model.gravity.getGravityNode(oInstance),aReverseAtomicReferencesNames,aReverseOrderedReferencesNames,oContainer,oContainerCandidate,aInverseOrderedReferences,aInverseAtomicReferences,sCurrentReferenceName,oCurrentReference,nReverseAtomicReferencesNameIndex,nReverseOrderedReferencesNameIndex,nReversAtomicReferencesIndex,nReversOrderedReferencesIndex,max,max2;if(oNode===undefined){return}aReverseAtomicReferencesNames=oNode.listReverseAtomicReferences();aReverseOrderedReferencesNames=oNode.listReverseOrderedReferences();for(nReverseAtomicReferencesNameIndex=0,max=aReverseAtomicReferencesNames.length;nReverseAtomicReferencesNameIndex<max;nReverseAtomicReferencesNameIndex++){sCurrentReferenceName=aReverseAtomicReferencesNames[nReverseAtomicReferencesNameIndex];aInverseAtomicReferences=oNode.getReverseAtomicReferences(sCurrentReferenceName);for(nReversAtomicReferencesIndex=0,max2=aInverseAtomicReferences.length;nReversAtomicReferencesIndex<max2;nReversAtomicReferencesIndex++){var oReverseAtomicReference=aInverseAtomicReferences[nReversAtomicReferencesIndex];oContainerCandidate=sap.galilei.model.gravity.getGalileiObject(oReverseAtomicReference);if(oContainerCandidate===undefined){throw"Gravity node is in an incorrect state"}if(oContainerCandidate===oContainer){continue}oCurrentReference=oContainerCandidate.classDefinition.getReference(sCurrentReferenceName);if(oCurrentReference===undefined){throw"Reference should exist"}if(oCurrentReference.isContainment){if(oContainer!==undefined){}oContainer=oContainerCandidate}}}for(nReverseOrderedReferencesNameIndex=0,max=aReverseOrderedReferencesNames.length;nReverseOrderedReferencesNameIndex<max;nReverseOrderedReferencesNameIndex++){sCurrentReferenceName=aReverseOrderedReferencesNames[nReverseOrderedReferencesNameIndex];aInverseOrderedReferences=oNode.getReverseOrderedReferences(sCurrentReferenceName);for(nReversOrderedReferencesIndex=0,max2=aInverseOrderedReferences.length;nReversOrderedReferencesIndex<max2;nReversOrderedReferencesIndex++){var oReverseOrderedReference=aInverseOrderedReferences[nReversOrderedReferencesIndex];oContainerCandidate=sap.galilei.model.gravity.getGalileiObject(oReverseOrderedReference);if(oContainerCandidate===undefined){throw"Gravity node is in an incorrect state"}if(oContainerCandidate===oContainer){continue}oCurrentReference=oContainerCandidate.classDefinition.getReference(sCurrentReferenceName);if(oCurrentReference===undefined){throw"Reference should exist"}if(oCurrentReference.isContainment){if(oContainer!==undefined){}oContainer=oContainerCandidate}}}return oContainer}};sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER=sap.galilei.model.gravity.ClassDefinitionBuilder})();
(function(){sap.galilei.model.GravityCollection=sap.galilei.core.defineClass({fullClassName:"sap.galilei.model.GravityCollection",parent:sap.galilei.model.BaseCollection,properties:{resource:undefined,modelHandler:undefined,referenceName:undefined,reference:undefined,reverseReference:undefined,gravityNodeCollectionOwner:undefined,length:{get:function(){this.initialize();var orderedReference=this.reverseReference==null?this.gravityNodeCollectionOwner.getOrderedReference(this.referenceName):this.reverseReference.isMany?this.gravityNodeCollectionOwner.getReverseOrderedReferences(this.referenceName):this.gravityNodeCollectionOwner.getReverseAtomicReferences(this.referenceName);return orderedReference.length}},lengthAsync:{get:function(){var oResult=jQuery.Deferred();var oInitializedCollection=this.initializeAsync(true);this._oResult=oResult;this._oCollection=this;var _resolveLengthFunction=function(oInitializedCollection){if(this._oResult){this._oResult.resolve(oInitializedCollection?oInitializedCollection.length:(this._oCollection?this._oCollection.length:0))}delete this._oResult;delete this._oCollection};oInitializedCollection.done(jQuery.proxy(_resolveLengthFunction,this));return oResult}},galileiObjectCollectionOwner:{get:function(){return sap.galilei.model.gravity.getGalileiObject(this.gravityNodeCollectionOwner)}}},methods:{push:function(oValue){var self=this,bIsCascadeAllowed=(self.resource===undefined)||(self.resource.isCascadeAllowed===true),nIndex=-1;this.initialize();if(this.reverseReference){if(this.reverseReference.isMany){if(sap.galilei.model.gravity.ClassDefinitionBuilder.isTransactionOpened(this.resource)){sap.galilei.model.gravity.getGravityNode(oValue).addOrderedReference(self.referenceName,nIndex,self.gravityNodeCollectionOwner);sap.galilei.model.gravity.ClassDefinitionBuilder.notifyReferenceChanged(oValue,bIsCascadeAllowed,self.reverseReference,self.galileiObjectCollectionOwner)}else{sap.galilei.model.gravity.ClassDefinitionBuilder.applyUndoableAction(this.resource,function(model){sap.galilei.model.gravity.getGravityNode(oValue).addOrderedReference(self.referenceName,nIndex,self.gravityNodeCollectionOwner);sap.galilei.model.gravity.ClassDefinitionBuilder.notifyReferenceChanged(oValue,bIsCascadeAllowed,self.reverseReference,self.galileiObjectCollectionOwner)},"Add ordered reference : "+this.referenceName)}}else{if(sap.galilei.model.gravity.ClassDefinitionBuilder.isTransactionOpened(this.resource)){sap.galilei.model.gravity.getGravityNode(oValue).setAtomicReference(self.referenceName,self.gravityNodeCollectionOwner);sap.galilei.model.gravity.ClassDefinitionBuilder.notifyReferenceChanged(oValue,bIsCascadeAllowed,self.reverseReference,self.galileiObjectCollectionOwner)}else{sap.galilei.model.gravity.ClassDefinitionBuilder.applyUndoableAction(this.resource,function(model){sap.galilei.model.gravity.getGravityNode(oValue).setAtomicReference(self.referenceName,self.gravityNodeCollectionOwner);sap.galilei.model.gravity.ClassDefinitionBuilder.notifyReferenceChanged(oValue,bIsCascadeAllowed,self.reverseReference,self.galileiObjectCollectionOwner)},"Set atomic reference : "+this.referenceName)}}}else{if(sap.galilei.model.gravity.ClassDefinitionBuilder.isTransactionOpened(this.resource)){self.gravityNodeCollectionOwner.addOrderedReference(self.referenceName,nIndex,sap.galilei.model.gravity.getGravityNode(oValue));sap.galilei.model.gravity.ClassDefinitionBuilder.notifyReferenceChanged(self.galileiObjectCollectionOwner,bIsCascadeAllowed,self.reference,oValue,undefined,nIndex)}else{sap.galilei.model.gravity.ClassDefinitionBuilder.applyUndoableAction(this.resource,function(model){self.gravityNodeCollectionOwner.addOrderedReference(self.referenceName,nIndex,sap.galilei.model.gravity.getGravityNode(oValue));sap.galilei.model.gravity.ClassDefinitionBuilder.notifyReferenceChanged(self.galileiObjectCollectionOwner,bIsCascadeAllowed,self.reference,oValue,undefined,nIndex)},"Add object to collection '"+this.referenceName+"' at index : "+nIndex)}}},insert:function(nIndex,oValue){var self=this,bIsCascadeAllowed=(self.resource===undefined)||(self.resource.isCascadeAllowed===true);this.initialize();if(this.reverseReference){throw"NotSupportedException"}else{if(nIndex<0||nIndex>this.length){nIndex=this.length}if(sap.galilei.model.gravity.ClassDefinitionBuilder.isTransactionOpened(this.resource)){self.gravityNodeCollectionOwner.addOrderedReference(self.referenceName,nIndex,sap.galilei.model.gravity.getGravityNode(oValue));sap.galilei.model.gravity.ClassDefinitionBuilder.notifyReferenceChanged(self.galileiObjectCollectionOwner,bIsCascadeAllowed,self.reference,oValue,undefined,nIndex)}else{sap.galilei.model.gravity.ClassDefinitionBuilder.applyUndoableAction(this.resource,function(model){self.gravityNodeCollectionOwner.addOrderedReference(self.referenceName,nIndex,sap.galilei.model.gravity.getGravityNode(oValue));sap.galilei.model.gravity.ClassDefinitionBuilder.notifyReferenceChanged(self.galileiObjectCollectionOwner,bIsCascadeAllowed,self.reference,oValue,undefined,nIndex)},"Insert object in collection '"+this.referenceName+"' at index : "+nIndex)}}},removeAt:function(nIndex){var self=this,oOldObject,oOldObjectNode,aReverseValues,nRemovalIndex,bIsCascadeAllowed=(self.resource===undefined)||(self.resource.isCascadeAllowed===true);this.initialize();oOldObject=self.get(nIndex);if(sap.galilei.model.gravity.ClassDefinitionBuilder.isTransactionOpened(this.resource)){if(this.reverseReference==undefined){self.gravityNodeCollectionOwner.removeOrderedReference(self.reference&&self.reference.name,nIndex)}else{oOldObjectNode=sap.galilei.model.gravity.getGravityNode(oOldObject);aReverseValues=oOldObjectNode&&oOldObjectNode.getOrderedReference(self.reverseReference.name);nRemovalIndex=aReverseValues&&aReverseValues.indexOf(self.gravityNodeCollectionOwner);if(nRemovalIndex!==-1){oOldObjectNode.removeOrderedReference(self.reverseReference.name,nRemovalIndex)}}sap.galilei.model.gravity.ClassDefinitionBuilder.notifyReferenceChanged(self.galileiObjectCollectionOwner,bIsCascadeAllowed,self.reference,undefined,oOldObject,nIndex)}else{sap.galilei.model.gravity.ClassDefinitionBuilder.applyUndoableAction(this.resource,function(model){if(self.reverseReference==undefined){self.gravityNodeCollectionOwner.removeOrderedReference(self.reference&&self.reference.name,nIndex)}else{oOldObjectNode=sap.galilei.model.gravity.getGravityNode(oOldObject);aReverseValues=oOldObjectNode&&oOldObjectNode.getOrderedReference(self.reverseReference.name);nRemovalIndex=aReverseValues&&aReverseValues.indexOf(self.gravityNodeCollectionOwner);if(nRemovalIndex!==-1){oOldObjectNode.removeOrderedReference(self.reverseReference.name,nRemovalIndex)}}sap.galilei.model.gravity.ClassDefinitionBuilder.notifyReferenceChanged(self.galileiObjectCollectionOwner,bIsCascadeAllowed,self.reference,undefined,oOldObject,nIndex)},"Remove object from collection '"+this.referenceName+"'")}},initialize:function(){var oResource=this.resource;if(!this._isInitializing){if(oResource.loadObjectReferenceObjectsAsync&&this.galileiObjectCollectionOwner&&this.referenceName&&this.reference&&this.reference.isAsync===true){this._isInitializing=true;oResource.loadObjectReferenceObjectsAsync(this.galileiObjectCollectionOwner,this.referenceName,false);delete this._isInitializing}}},initializeAsync:function(bAsync){var oResource=this.resource,self=this,oResult;if(bAsync===undefined){bAsync=true}if(oResource.loadObjectReferenceObjectsAsync&&this.galileiObjectCollectionOwner&&this.referenceName&&this.reference&&this.reference.isAsync===true){oResult=oResource.loadObjectReferenceObjectsAsync(this.galileiObjectCollectionOwner,this.referenceName,bAsync)}else{oResult=jQuery.Deferred();oResult.resolve(self)}return oResult},get:function(nIndex){var oNode,oResource=this.resource;this.initialize();if(nIndex>this.length-1){return undefined}oNode=this.reverseReference==null?this.gravityNodeCollectionOwner.getOrderedReference(this.referenceName,nIndex):this.reverseReference.isMany?this.gravityNodeCollectionOwner.getReverseOrderedReferences(this.referenceName,nIndex):this.gravityNodeCollectionOwner.getReverseAtomicReferences(this.referenceName)[nIndex];return sap.galilei.model.gravity.getGalileiObject(oNode)},contains:function(oValue){this.initialize();return jQuery.inArray(sap.galilei.model.gravity.getGravityNode(oValue),this.gravityNodeCollectionOwner.getOrderedReference(this.referenceName))},clear:function(){var self=this,nIndex;this.initialize();try{this.resource.clearingReference=this.referenceName;if(sap.galilei.model.gravity.ClassDefinitionBuilder.isTransactionOpened(this.resource)){for(nIndex=self.length-1;nIndex>=0;nIndex--){self.removeAt(nIndex)}}else{sap.galilei.model.gravity.ClassDefinitionBuilder.applyUndoableAction(this.resource,function(model){for(nIndex=self.length-1;nIndex>=0;nIndex--){self.removeAt(nIndex)}},"Clear collection '"+this.referenceName+"'")}}finally{delete this.resource.clearingReference}},toArray:function(){var aNodeArray,resultArray=[],nIndex,max;this.initialize();aNodeArray=this.reverseReference==null?this.gravityNodeCollectionOwner.getOrderedReference(this.referenceName):this.reverseReference.isMany?this.gravityNodeCollectionOwner.getReverseOrderedReferences(this.referenceName):this.gravityNodeCollectionOwner.getReverseAtomicReferences(this.referenceName);for(nIndex=0,max=aNodeArray.length;nIndex<max;nIndex++){resultArray.push(sap.galilei.model.gravity.getGalileiObject(aNodeArray[nIndex]))}return resultArray},indexOf:function(oValue){this.initialize();var oNode=oValue&&sap.galilei.model.gravity.getGravityNode(oValue),aValues=this.reverseReference==null?this.gravityNodeCollectionOwner.getOrderedReference(this.referenceName):this.reverseReference.isMany?this.gravityNodeCollectionOwner.getReverseOrderedReferences(this.referenceName):this.gravityNodeCollectionOwner.getReverseAtomicReferences(this.referenceName);return oNode===undefined||aValues===undefined||aValues.length<1?-1:aValues.indexOf(oNode)},deleteAll:function(){var self=this,oResource=this.resource,nIndex,oObject;if(oResource){sap.galilei.model.gravity.ClassDefinitionBuilder.applyUndoableAction(oResource,function(){for(nIndex=self.length-1;nIndex>=0;nIndex--){oObject=self.get(nIndex);if(oObject){self.removeAt(nIndex);if(oObject.deleteObject&&oObject.isAlive){oObject.deleteObject()}}}},"Delete objects in '"+this.referenceName+"'")}}}})}());
"use strict";namespace("sap.galilei.model.internal");sap.galilei.model.internal.bootstrappingFlag={};sap.galilei.model.internal.classDefinition=undefined;sap.galilei.model.internal.galileiM3Resource={objects:[]};sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.onInitializeResource(sap.galilei.model.internal.galileiM3Resource,"galileiM3Resource");sap.galilei.model.internal.resolve=function(vValue,oResource,oContext,bCreate){var oResolvedInstance;if(typeof(vValue)==="string"){if(oResource!==undefined){oResolvedInstance=sap.galilei.model.getObject(oResource,vValue)}}if(oResolvedInstance===undefined){oResolvedInstance=sap.galilei.model.internal.resolveType(vValue,oContext,bCreate)}return oResolvedInstance};sap.galilei.model.internal.resolveType=function(vType,oContext,bCreate){var oType=vType;if(typeof(vType)==="string"){oType=sap.galilei.model.getClass(vType)||sap.galilei.model.getFeature(vType);if(oType===undefined){oType=oContext.resolve(vType,bCreate);if(oType===undefined){if(vType==="sap.galilei.model.Object"){oType=oContext.identifierToInitializationData.Object.objectDeclaration}else{if(vType==="sap.galilei.model.Class"){oType=oContext.identifierToInitializationData.Class.objectDeclaration}}}}}return oType};sap.galilei.model.internal.galileiClassInitializer=function(oResource,oClassDeclaration,sIdentifier,oContext){var oCurrentProperty,oPropertyClassDefinition,oPropertyRuntimeClass,oCurrentPropertyDeclaration,oReferenceClassDefinition,oReferenceRuntimmeClass,oCurrentReference,oCurrentReferenceDeclaration,oExtension,sCurrentMethodName,fnCurrentMethod,sCurrentStaticName,vCurrentStatic,bUseFeatureId=false,bInitializionFailed=false,sPropertyId,sReferenceId;if(this.runtimeClass===undefined&&oClassDeclaration.isAbstract!==true){if(oClassDeclaration.name!==undefined){this.runtimeClass=sap.galilei.model.internal.getOrCreateRuntimeClass.call(this,oClassDeclaration,oContext)}bInitializionFailed=(this.runtimeClass===undefined)}if(this.runtimeClass!==undefined){this.runtimeClass.classDefinition=this;if(oClassDeclaration.methods!=undefined){for(sCurrentMethodName in oClassDeclaration.methods){fnCurrentMethod=oClassDeclaration.methods[sCurrentMethodName];oExtension={};oExtension[sCurrentMethodName]=fnCurrentMethod;sap.galilei.core.extend(this.runtimeClass,oExtension)}}if(oClassDeclaration.statics!=undefined){for(sCurrentStaticName in oClassDeclaration.statics){vCurrentStatic=oClassDeclaration.statics[sCurrentStaticName];oExtension={};if(vCurrentStatic.hasOwnProperty("value")){oExtension[sCurrentStaticName]=vCurrentStatic.value}else{oExtension[sCurrentStaticName]=vCurrentStatic}sap.galilei.core.extendStatic(this.runtimeClass,oExtension)}}}if(oClassDeclaration.properties!=undefined){oPropertyClassDefinition=sap.galilei.model.getClass("sap.galilei.model.Property");oPropertyRuntimeClass=oPropertyClassDefinition&&oPropertyClassDefinition.runtimeClass;if(oPropertyRuntimeClass===undefined){bInitializionFailed=true}else{if(oPropertyClassDefinition&&oPropertyClassDefinition.isInitialized){if(typeof(oClassDeclaration.properties)!=="Array"){bUseFeatureId=true}for(sPropertyId in oClassDeclaration.properties){oCurrentPropertyDeclaration=oClassDeclaration.properties[sPropertyId];if(oCurrentPropertyDeclaration.name===undefined){oCurrentPropertyDeclaration.name=sPropertyId}if(this.getProperty(oCurrentPropertyDeclaration.name)!==undefined||sap.galilei.model.getObject(oResource,sPropertyId)!==undefined){continue}oCurrentPropertyDeclaration.owningClassDefinition=this;oCurrentProperty=new oPropertyRuntimeClass(oResource,oCurrentPropertyDeclaration,bUseFeatureId?sPropertyId:undefined);if(!oCurrentProperty.isInitialized){bInitializionFailed=true}}}}}if(oClassDeclaration.references!=undefined){oReferenceClassDefinition=sap.galilei.model.getClass("sap.galilei.model.Reference");oReferenceRuntimmeClass=oReferenceClassDefinition&&oReferenceClassDefinition.runtimeClass;if(oReferenceRuntimmeClass===undefined){bInitializionFailed=true}else{if(oReferenceClassDefinition&&oReferenceClassDefinition.isInitialized){if(typeof(oClassDeclaration.references)!=="Array"){bUseFeatureId=true}for(sReferenceId in oClassDeclaration.references){oCurrentReferenceDeclaration=oClassDeclaration.references[sReferenceId];if(oCurrentReferenceDeclaration.name===undefined){oCurrentReferenceDeclaration.name=sReferenceId}if(this.getReference(oCurrentReferenceDeclaration.name)!==undefined){continue}oCurrentReferenceDeclaration.owningClassDefinition=this;oCurrentReference=new oReferenceRuntimmeClass(oResource,oCurrentReferenceDeclaration,bUseFeatureId?sReferenceId:undefined);if(!oCurrentReference.isInitialized){bInitializionFailed=true}}}}}if(oClassDeclaration===undefined||oClassDeclaration.parent===undefined){this.parent=sap.galilei.model.internal.resolveType("sap.galilei.model.Object")}this.isInitialized=this.isInitialized&&!bInitializionFailed};sap.galilei.model.internal.galileiReferenceInitializer=function(oResource,oReferenceDefinition,sIdentifier,oContext,bCreate){var oObjectClass,oReverseReference,bIsFailedInitialize,oOwningClassDefinition=this.owningClassDefinition||sap.galilei.model.internal.resolve(oReferenceDefinition.owningClassDefinition,oResource,oContext);if(oReferenceDefinition.get!==undefined||oReferenceDefinition.set!==undefined){this.isVolatile=true;this.isComputed=true}if(oOwningClassDefinition===undefined){bIsFailedInitialize=true}else{oOwningClassDefinition=sap.galilei.model.internal.resolve(oOwningClassDefinition,oResource,oContext)}if(oReferenceDefinition.contentType!==undefined){oObjectClass=sap.galilei.model.internal.resolve(oReferenceDefinition.contentType,oResource,oContext,bCreate);if(oObjectClass===undefined){bIsFailedInitialize=true}}if(oReferenceDefinition.reverseReference!==undefined){oReverseReference=sap.galilei.model.internal.resolve(oReferenceDefinition.reverseReference,oResource,oContext,true)||sap.galilei.model.getReference(oReferenceDefinition.reverseReference);if(oReverseReference===undefined){bIsFailedInitialize=true}}if(!bIsFailedInitialize){var oExtension={};oExtension[oReferenceDefinition.name]={type:sap.galilei.core.EnumPropertyType.collection,objectClass:oObjectClass,isMany:oReferenceDefinition.isMany,reference:this,reverseReference:oReverseReference,isCached:oReferenceDefinition.isCached,get:oReferenceDefinition.get,set:oReferenceDefinition.set};var runtimeReference=sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.transformProperties({},oExtension);sap.galilei.core.extend(oOwningClassDefinition.runtimeClass,runtimeReference,true)}this.isInitialized=!bIsFailedInitialize};sap.galilei.model.internal.galileiPropertyInitializer=function(oResource,oPropertyDefinition,sIdentifier,oContext){var oOwningClassDefinition=this.owningClassDefinition||sap.galilei.model.internal.resolve(oPropertyDefinition.owningClassDefinition,oResource,oContext),oExtension={},vValue;if(oPropertyDefinition.get!==undefined||oPropertyDefinition.set!==undefined){this.isVolatile=true;this.isComputed=true}if(oOwningClassDefinition){if(oPropertyDefinition.constraint&&oPropertyDefinition.constraint.defaultValue!=undefined){if((typeof oPropertyDefinition.constraint.defaultValue)==="function"&&oPropertyDefinition.defaultValue!=undefined){vValue=function(oInstance){var vDefault=oPropertyDefinition.constraint.defaultValue(oInstance);if(vDefault==undefined){vDefault=oPropertyDefinition.constraint.defaultValue}return vDefault}}else{vValue=oPropertyDefinition.constraint.defaultValue}}else{if(oPropertyDefinition.defaultValue!=undefined){vValue=oPropertyDefinition.defaultValue}else{if(oPropertyDefinition.dataType&&oPropertyDefinition.dataType.defaultValue!=undefined){vValue=oPropertyDefinition.dataType.defaultValue}}}oExtension[oPropertyDefinition.name]={type:sap.galilei.core.EnumPropertyType.property,value:vValue,property:this,get:oPropertyDefinition.get,set:oPropertyDefinition.set,isCached:oPropertyDefinition.isCached,isInternal:oPropertyDefinition.isInternal,isIndex:oPropertyDefinition.isIndex,isVolatile:oPropertyDefinition.isVolatile};var runtimeProperty=sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.transformValueProperties({},oExtension);sap.galilei.core.extend(oOwningClassDefinition.runtimeClass,runtimeProperty,true);this.isInitialized=true}else{this.isInitialized=false}};sap.galilei.model.internal.getOrCreateRuntimeClass=function(oClassDeclaration){var oRuntimeClass=oClassDeclaration.runtimeClass,oClassDefinition=this,fnConstructor,fnOninitialize,fnOnCascadeInitialize,oCurrentParentClassDefinition,oParentClassDefinition,oParentRuntimeClass,oContext=(arguments.length>1)?arguments[1]:undefined,index,max;if(oRuntimeClass===undefined){fnConstructor=function(){var oResource=arguments[0],oInstance=this,oCurrentParentInitializationData,oInstanceDeclaration=arguments[1],oContext=(arguments.length>3)?arguments[3]:undefined,aArguments=arguments,fnConstructorLogic,aParentClasses=[];fnConstructorLogic=function(){oInstance[sap.galilei.core.internal.PROPERTY_FULL_CLASSNAME]=oClassDeclaration.name;if(oClassDefinition===sap.galilei.model.internal.bootstrappingFlag&&sap.galilei.model.internal.classDefinition===undefined){sap.galilei.model.internal.classDefinition=oInstance}oCurrentParentClassDefinition=oClassDefinition.parent||sap.galilei.model.internal.resolve(oClassDeclaration.parent===undefined?"sap.galilei.model.Object":oClassDeclaration.parent,oResource,oContext);while(oCurrentParentClassDefinition){aParentClasses.push(oCurrentParentClassDefinition);oCurrentParentClassDefinition=sap.galilei.model.internal.resolve(oCurrentParentClassDefinition.parent,oResource,oContext)}for(index=0,max=aParentClasses.length;index<max;index++){oCurrentParentClassDefinition=aParentClasses[index];fnOninitialize=oCurrentParentClassDefinition.onInitialize;if(fnOninitialize===undefined){oCurrentParentInitializationData=oContext&&oContext.identifierToInitializationData[sap.galilei.model.gravity.ClassDefinitionBuilder.getObjectId(oCurrentParentClassDefinition)];fnOninitialize=oCurrentParentInitializationData&&oCurrentParentInitializationData.objectDeclaration.onInitialize}if(fnOninitialize instanceof Function){fnOninitialize.apply(oInstance,aArguments)}}if(oInstance.classDefinition===undefined){oInstance.classDefinition=(oClassDefinition===sap.galilei.model.internal.bootstrappingFlag)?sap.galilei.model.internal.classDefinition:oClassDefinition}if(oClassDeclaration.onInitialize instanceof Function){oClassDeclaration.onInitialize.apply(oInstance,aArguments)}if(oResource&&oResource.isCascadeAllowed){for(index=0,max=aParentClasses.length;index<max;index++){oCurrentParentClassDefinition=aParentClasses[index];fnOnCascadeInitialize=oCurrentParentClassDefinition.onCascadeInitialize;if(fnOnCascadeInitialize===undefined){oCurrentParentInitializationData=oContext&&oContext.identifierToInitializationData[sap.galilei.model.gravity.ClassDefinitionBuilder.getObjectId(oCurrentParentClassDefinition)];fnOnCascadeInitialize=oCurrentParentInitializationData&&oCurrentParentInitializationData.objectDeclaration.onCascadeInitialize}if(fnOnCascadeInitialize instanceof Function){fnOnCascadeInitialize.apply(oInstance,aArguments)}}if(oInstance.classDefinition===undefined){oInstance.classDefinition=(oClassDefinition===sap.galilei.model.internal.bootstrappingFlag)?sap.galilei.model.internal.classDefinition:oClassDefinition}if(oClassDeclaration.onCascadeInitialize instanceof Function){oClassDeclaration.onCascadeInitialize.apply(oInstance,aArguments)}else{if(oInstance.classDefinition&&oInstance.classDefinition.onCascadeInitialize instanceof Function){oInstance.classDefinition.onCascadeInitialize.apply(oInstance,aArguments)}}}if(!oContext){sap.galilei.model.internal.initializeFeatures(oInstance,oInstanceDeclaration,oContext)}};if(oResource===undefined||oResource.modelHandler===undefined||oResource.isLoading){fnConstructorLogic()}else{if(sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.isTransactionOpened(oResource)){fnConstructorLogic.call(oResource)}else{sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.applyUndoableAction(oResource,fnConstructorLogic,"create object instance")}}};oParentClassDefinition=sap.galilei.model.internal.resolve(oClassDeclaration.parent===undefined?"sap.galilei.model.Object":oClassDeclaration.parent,this.resource,oContext);if(oParentClassDefinition===undefined&&oClassDeclaration.parent!==undefined){this.isInitialized=false}else{oParentRuntimeClass=oParentClassDefinition==null?undefined:sap.galilei.model.internal.getOrCreateRuntimeClass.call(this,oParentClassDefinition);oRuntimeClass=sap.galilei.model.defineClass({parent:oParentRuntimeClass,initialize:fnConstructor})}if(this===sap.galilei.model.internal.bootstrappingFlag){oClassDeclaration.runtimeClass=oRuntimeClass}}return oRuntimeClass};sap.galilei.model.internal.initializeFeatures=function(oInstance,oDeclaration,oContext){var sFeatureName,oIsManyFeatureDeclaration=oContext&&oContext.identifierToInitializationData.isMany,oCurrentFeatureInitializationData,oCurrentFeatureDeclaration,oConverter,oCurrentFeature,bIsCurrentFeatureMany,oCurrentFeatureValue,oCurrentFeatureValueResolved,oInstanceProperties,oInstanceReferences,bInitializationFailed=false;if(oInstance.classDefinition.getFeature){oInstanceProperties=oInstance.classDefinition.allProperties||{};oInstanceReferences=oInstance.classDefinition.allReferences||{};for(sFeatureName in oDeclaration){oCurrentFeatureValue=oDeclaration[sFeatureName];if(sFeatureName==="runtimeClass"||sFeatureName==="methods"||sFeatureName==="statics"){continue}oCurrentFeature=oInstanceProperties[sFeatureName];if(sFeatureName==="name"&&oDeclaration.name==="name"&&oDeclaration.owningClassDefinition==sap.galilei.model.internal.resolveType("sap.galilei.model.Object",oContext)){oCurrentFeature=oInstance}if(oCurrentFeature!==undefined){oConverter=oCurrentFeature.converter;if(oConverter!==undefined&&oConverter.convertFrom!==undefined){oCurrentFeatureValue=oConverter.convertFrom(oCurrentFeatureValue)}if(oInstance[sFeatureName]!==oCurrentFeatureValue){oInstance[sFeatureName]=oCurrentFeatureValue}}else{if(oInstance[sFeatureName]!==undefined){continue}oCurrentFeature=oInstanceReferences[sFeatureName];if(oCurrentFeature!==undefined){bIsCurrentFeatureMany=oCurrentFeature.isMany;if(bIsCurrentFeatureMany===undefined){oCurrentFeatureInitializationData=oContext&&oContext.identifierToInitializationData[sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.getObjectId(oCurrentFeature)];oCurrentFeatureDeclaration=oCurrentFeatureInitializationData&&oCurrentFeatureInitializationData.objectDeclaration;bIsCurrentFeatureMany=oCurrentFeatureDeclaration&&oCurrentFeatureDeclaration.isMany;if(bIsCurrentFeatureMany===undefined){bIsCurrentFeatureMany=oIsManyFeatureDeclaration&&oIsManyFeatureDeclaration.objectDeclaration.defaultValue}}if(bIsCurrentFeatureMany!==undefined){if(bIsCurrentFeatureMany===false&&oCurrentFeatureValue!=undefined){if(typeof(oCurrentFeatureValue)==="string"){oCurrentFeatureValueResolved=sap.galilei.model.internal.resolve(oCurrentFeatureValue,oInstance.resource,oContext)}else{oCurrentFeatureValueResolved=oCurrentFeatureValue}if(oCurrentFeatureValueResolved){oInstance[sFeatureName]=oCurrentFeatureValueResolved}}}else{bInitializationFailed=true}}}}}else{bInitializationFailed=true}oInstance.isInitialized=oInstance.isInitialized&&!bInitializationFailed};
"use strict";sap.galilei.model.GalileiMemberMonitor=sap.galilei.core.defineClass({fullClassName:"sap.galilei.model.GalileiMemberMonitor",properties:{insideMemberRead:false,members:undefined,notify:undefined,clear:undefined,target:undefined},methods:{attachHandler:function(notify,clear,target){var instance;this.insideMemberRead=true;if(this.members){var self=this,oGalileiObject=sap.galilei.model.Object!==undefined?sap.galilei.model.Object.classDefinition:sap.galilei.model.getClass("sap.galilei.model.Object");this.notify=notify;this.clear=clear;this.target=target;if(oGalileiObject!==undefined&&oGalileiObject.firing){if(!oGalileiObject.firing._firingCompletedCallbacks){oGalileiObject.firing._firingCompletedCallbacks=[]}oGalileiObject.firing._firingCompletedCallbacks.push(function(){var instance;for(instance in self.members){self.members[instance]._.addMonitor(self)}})}else{for(instance in this.members){self.members[instance]._.addMonitor(self)}}}this.insideMemberRead=false},detachHandler:function(){var instance;if(this.members){for(instance in this.members){this.members[instance]._.removeMonitor(this)}this.members=undefined;this.notify=undefined;this.clear=undefined;this.target=undefined}},onMemberRead:function(oInstance,sMemberName){var oResource=oInstance&&oInstance.resource,bSkipNotifications=(oResource!=null)&&(oResource.skipNotifications===true);if(!bSkipNotifications&&!this.insideMemberRead){this.insideMemberRead=true;var sObjectId=sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.getObjectId(oInstance);var oMembers=this.members||(this.members={});var oInstanceMembers=oMembers[sObjectId]||{};oInstanceMembers._=oInstance;oInstanceMembers[sMemberName]=true;oMembers[sObjectId]=oInstanceMembers;this.insideMemberRead=false}},onMemberChanged_clear:function(oInstance,sMemberName){if(this.clear){if(this.members){var sObjectId=sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.getObjectId(oInstance);if(this.members[sObjectId]&&this.members[sObjectId][sMemberName]){this.clear(this.target)}}}},onMemberChanged:function(oInstance,sMemberName){var sObjectId,notify,target;if(this.notify){if(this.members){sObjectId=sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.getObjectId(oInstance);if(this.members[sObjectId]&&this.members[sObjectId][sMemberName]){notify=this.notify;target=this.target;this.detachHandler();notify(target)}}}},isEmpty:function(){return !this.members||Object.keys(this.members).length===0}},statics:{active:undefined}});
(function(){sap.galilei.model.ResourceReader=sap.galilei.core.defineClass({fullClassName:"sap.galilei.model.ResourceReader",properties:{isPartialLoadReader:{get:function(){return false}}},methods:{convertDataTypeFrom:function(oSourceDataType){},convertDataTypeTo:function(oGalileiDataType){},loadAsync:function(oParam){}}})}());
(function(){sap.galilei.model.JSONReader=sap.galilei.core.defineClass({fullClassName:"sap.galilei.model.JSONReader",parent:sap.galilei.model.ResourceReader,properties:{resource:undefined,qualifiedNameToIdentifier:undefined,identifierToInitializationData:undefined},methods:{getQualifiedName:function(oObjectDeclaration,sName,sContainerId,oModelDeclarationContents){var sResult=oObjectDeclaration.namespaceName||sName,oContainerInitializationData,oPackageDeclaration,sContainerInitializationDataContainerId,sNamespaceName;if(oObjectDeclaration.packageDefinition){sNamespaceName=oObjectDeclaration.packageDefinition.namespaceName;if(sNamespaceName===undefined){oPackageDeclaration=oModelDeclarationContents&&oModelDeclarationContents[oObjectDeclaration.packageDefinition];sNamespaceName=oPackageDeclaration&&oPackageDeclaration.namespaceName}sResult=sNamespaceName+"."+sResult}else{if(sContainerId){oContainerInitializationData=this.identifierToInitializationData[sContainerId];if(oContainerInitializationData){sContainerInitializationDataContainerId=oContainerInitializationData.containersData&&oContainerInitializationData.containersData.length>0&&oContainerInitializationData.containersData[0].containerId;sResult=this.getQualifiedName(oContainerInitializationData.objectDeclaration,oContainerInitializationData.name,sContainerInitializationDataContainerId,oModelDeclarationContents)+"."+sResult}}}return sResult},buildInitializationData:function(oModelDeclarationContents,containerId,containingReferenceId){var sObjectDeclarationId,sObjectFeatureId,sObjectId,sName,oObjectDeclaration,vObjectFeatureValue,oInitializationData,oClassDefinition,nArrayIndex,nArrayCount,bIsProperty,sInnerDeclarationKey=uuid.v4(),oInnerDeclaration={},bIsDeclarationArray=oModelDeclarationContents instanceof Array;for(sObjectDeclarationId in oModelDeclarationContents){oObjectDeclaration=oModelDeclarationContents[sObjectDeclarationId];if(bIsDeclarationArray===true){sObjectDeclarationId=uuid.v4()}sName=oObjectDeclaration.name||sObjectDeclarationId;if(this.identifierToInitializationData[sObjectDeclarationId]===undefined){oInitializationData={name:sName,objectDeclaration:{name:sName},objectInstance:sap.galilei.model.internal.resolve(sObjectDeclarationId,this.resource,this),containersData:[]};this.identifierToInitializationData[sObjectDeclarationId]=oInitializationData}else{oInitializationData=this.identifierToInitializationData[sObjectDeclarationId];if(oInitializationData.name===undefined&&sName!==undefined){oInitializationData.name=sName}if(oInitializationData.objectDeclaration===undefined&&sName!==undefined){oInitializationData.objectDeclaration={name:sName}}if(oInitializationData.objectInstance===undefined){oInitializationData.objectInstance=sap.galilei.model.internal.resolve(sObjectDeclarationId,this.resource,this)}}if(containerId!==undefined){this.identifierToInitializationData[sObjectDeclarationId].containersData.push({containerId:containerId,containingReferenceId:containingReferenceId})}if(containingReferenceId==="references"||containingReferenceId==="properties"){this.identifierToInitializationData[sObjectDeclarationId].objectDeclaration.owningClassDefinition=containerId}this.qualifiedNameToIdentifier[this.getQualifiedName(oObjectDeclaration,sName,containerId,oModelDeclarationContents)]=sObjectDeclarationId;for(sObjectFeatureId in oObjectDeclaration){vObjectFeatureValue=oObjectDeclaration[sObjectFeatureId];bIsProperty=(containingReferenceId==="properties");if(!bIsProperty){oClassDefinition=this.resolve(oObjectDeclaration.classDefinition);if(oClassDefinition===undefined){bIsProperty=false}else{bIsProperty=(oClassDefinition.allProperties[sObjectFeatureId]!==undefined)}}if(vObjectFeatureValue instanceof Array){for(nArrayIndex=0,nArrayCount=vObjectFeatureValue.length;nArrayIndex<nArrayCount;nArrayIndex++){sObjectId=vObjectFeatureValue[nArrayIndex];if(typeof(sObjectId)==="string"){if(this.identifierToInitializationData[sObjectId]!==undefined){this.identifierToInitializationData[sObjectId].containersData.push({containerId:sObjectDeclarationId,containingReferenceId:sObjectFeatureId})}else{this.identifierToInitializationData[sObjectId]={containersData:[{containerId:sObjectDeclarationId,containingReferenceId:sObjectFeatureId}]}}}else{sInnerDeclarationKey=uuid.v4();oInnerDeclaration={};oInnerDeclaration[sInnerDeclarationKey]=sObjectId;this.buildInitializationData(oInnerDeclaration,sObjectDeclarationId,sObjectFeatureId)}}}else{if(vObjectFeatureValue!=null&&typeof(vObjectFeatureValue)==="object"&&vObjectFeatureValue._node===undefined&&vObjectFeatureValue.constructor.prototype===Object.prototype&&sObjectFeatureId!=="methods"&&sObjectFeatureId!=="statics"&&!bIsProperty){this.buildInitializationData(vObjectFeatureValue,sObjectDeclarationId,sObjectFeatureId)}else{this.identifierToInitializationData[sObjectDeclarationId].objectDeclaration[sObjectFeatureId]=vObjectFeatureValue}}}}},resolve:function(vObjectdIdOrClassQualifiedName,bCreate){var oResult=vObjectdIdOrClassQualifiedName,oInitializationData,sObjectId,oResource;if(typeof(vObjectdIdOrClassQualifiedName)==="string"){sObjectId=this.qualifiedNameToIdentifier[vObjectdIdOrClassQualifiedName]||vObjectdIdOrClassQualifiedName;oInitializationData=this.identifierToInitializationData[sObjectId];oResult=oInitializationData&&oInitializationData.objectInstance;if(oResult===undefined&&oInitializationData&&bCreate){this.createObject(sObjectId,oInitializationData);oResult=oInitializationData.objectInstance}if(oResult===undefined){oResource=this.resource;oResult=oResource&&sap.galilei.model.getObject(oResource,sObjectId)}if(oResult===undefined){oResult=sap.galilei.model.getClass(vObjectdIdOrClassQualifiedName)}}return oResult},initializeConstructors:function(){var sInitializationDataId,oInitializationData;for(sInitializationDataId in this.identifierToInitializationData){oInitializationData=this.identifierToInitializationData[sInitializationDataId];this.setObjectConstructor(oInitializationData)}},createObjects:function(){var sInitializationDataId,oInitializationData;for(sInitializationDataId in this.identifierToInitializationData){oInitializationData=this.identifierToInitializationData[sInitializationDataId];this.createObject(sInitializationDataId,oInitializationData)}},createObject:function(sInitializationDataId,oInitializationData){var sParentId=oInitializationData.objectDeclaration.parent,oParentInitializationData,sMethodName,oExtension;if(sParentId){sParentId=this.qualifiedNameToIdentifier[sParentId]||sParentId;oParentInitializationData=this.identifierToInitializationData[sParentId]}if(oInitializationData.objectInstance===undefined){if(oParentInitializationData&&!oParentInitializationData.objectInstance){this.createObject(sParentId,oParentInitializationData)}if(oInitializationData.objectConstructor){oInitializationData.objectInstance=new oInitializationData.objectConstructor(this.resource,oInitializationData.objectDeclaration,sInitializationDataId,this,true)}else{console.log("Warning: '"+sInitializationDataId+"' has no constructor.");return}}else{if(oInitializationData.objectDeclaration&&oInitializationData.objectDeclaration.methods!==undefined&&oInitializationData.objectInstance.runtimeClass!==undefined){for(sMethodName in oInitializationData.objectDeclaration.methods){oExtension={};oExtension[sMethodName]=oInitializationData.objectDeclaration.methods[sMethodName];sap.galilei.core.extend(oInitializationData.objectInstance.runtimeClass,oExtension)}}}if(oInitializationData.objectDeclaration.isMany!==undefined){oInitializationData.objectInstance.isMany=oInitializationData.objectDeclaration.isMany}if(oInitializationData.objectDeclaration.onChange!==undefined){oInitializationData.objectInstance.onChange=oInitializationData.objectDeclaration.onChange}if(oInitializationData.objectInstance.name===undefined){oInitializationData.objectInstance.name=oInitializationData.objectDeclaration.name}if(oParentInitializationData){oInitializationData.objectInstance.parent=oParentInitializationData.objectInstance}oInitializationData.objectInstance.isKey=oInitializationData.objectDeclaration.isKey},attachObjectToContainers:function(){var sInitializationDataId,oInitializationData,oContainer,nContainersDataIndex,nContainersDataCount,oCurrentContainerData;for(sInitializationDataId in this.identifierToInitializationData){oInitializationData=this.identifierToInitializationData[sInitializationDataId];if(oInitializationData.objectDeclaration.reverseReference){oInitializationData.objectInstance.reverseReference=this.resolve(oInitializationData.objectDeclaration.reverseReference,true)}if(oInitializationData.containersData===undefined||oInitializationData.containersData.length===0){continue}for(nContainersDataIndex=0,nContainersDataCount=oInitializationData.containersData.length;nContainersDataIndex<nContainersDataCount;nContainersDataIndex++){oCurrentContainerData=oInitializationData.containersData[nContainersDataIndex];oContainer=this.resolve(oCurrentContainerData.containerId);if(oContainer===undefined){throw"InvalidOperationException"}if(oContainer[oCurrentContainerData.containingReferenceId]){oContainer[oCurrentContainerData.containingReferenceId].push(oInitializationData.objectInstance)}else{console.log("The container does not support the reference "+oCurrentContainerData.containingReferenceId)}}}},inferBaseFeature:function(oInstance){var oResult,oOwningClassDefinition,oOwningClassDefinitionParent,bIsProperty,bIsReference;bIsProperty=sap.galilei.core.isInstanceOf(oInstance,"Property");if(!bIsProperty){bIsReference=sap.galilei.core.isInstanceOf(oInstance,"Reference")}if(bIsProperty||bIsReference){oOwningClassDefinition=oInstance.owningClassDefinition;if(oOwningClassDefinition){oOwningClassDefinitionParent=oOwningClassDefinition.parent;if(bIsProperty&&oOwningClassDefinitionParent&&oOwningClassDefinitionParent.allProperties[oInstance.name]){oResult=oOwningClassDefinitionParent.allProperties[oInstance.name]}else{if(bIsReference&&oOwningClassDefinitionParent&&oOwningClassDefinitionParent.allReferences[oInstance.name]){oResult=oOwningClassDefinitionParent.allReferences[oInstance.name]}}}}return oResult},initializeFeatures:function(){var sInitializationDataId,oInitializationData,oInstance,oInferedBaseFeature;for(sInitializationDataId in this.identifierToInitializationData){oInitializationData=this.identifierToInitializationData[sInitializationDataId];oInstance=oInitializationData.objectInstance;if(oInstance&&oInitializationData.objectDeclaration){if(oInitializationData.objectDeclaration.parent===undefined){oInferedBaseFeature=this.inferBaseFeature(oInstance);if(oInferedBaseFeature){oInstance.baseFeature=oInferedBaseFeature}}sap.galilei.model.internal.initializeFeatures(oInstance,oInitializationData.objectDeclaration,this)}}},checkInitializations:function(){var sInitializationDataId,oInitializationData;for(sInitializationDataId in this.identifierToInitializationData){oInitializationData=this.identifierToInitializationData[sInitializationDataId];if(oInitializationData.objectInstance===undefined||!oInitializationData.objectInstance.isInitialized){throw"Failed initialization for : "+oInitializationData.name}}},inferClassDefinition:function(oInitializationData){var aContainersData=oInitializationData.containersData,oContainerInitializationData=aContainersData&&aContainersData.length>0&&this.identifierToInitializationData[aContainersData[0].containerId],oContainerClassDefinition=(oContainerInitializationData&&sap.galilei.model.internal.resolve(oContainerInitializationData.objectDeclaration.classDefinition,this.resource,this))||this.inferClassDefinition(oContainerInitializationData),oContainingReference=oContainerClassDefinition&&oContainerClassDefinition.getReference(aContainersData[0].containingReferenceId);return oContainingReference&&oContainingReference.contentType},setObjectConstructor:function(oInitializationData){var oObjectDeclaration=oInitializationData.objectDeclaration,vObjectClassDefinition=oObjectDeclaration.classDefinition,oOuterReference,oClassDefinition,fnObjectConstructor,sConstructorId,sConstructorParentId,oConstructorInitializationData,oConstructorParentInitializationData,oConstructorClassDeclaration;if(vObjectClassDefinition===undefined&&oInitializationData.objectInstance){oObjectDeclaration.classDefinition=oInitializationData.objectInstance.classDefinition;vObjectClassDefinition=oObjectDeclaration.classDefinition}if(vObjectClassDefinition===undefined&&oInitializationData.containersData&&oInitializationData.containersData.length>0){vObjectClassDefinition=this.inferClassDefinition(oInitializationData)}fnObjectConstructor=vObjectClassDefinition&&vObjectClassDefinition.runtimeClass;if(fnObjectConstructor===undefined&&typeof(vObjectClassDefinition)==="string"){oClassDefinition=this.resolve(vObjectClassDefinition);fnObjectConstructor=oClassDefinition&&oClassDefinition.runtimeClass;if(fnObjectConstructor===undefined){sConstructorId=this.qualifiedNameToIdentifier[vObjectClassDefinition]||vObjectClassDefinition;oConstructorInitializationData=this.identifierToInitializationData[sConstructorId];fnObjectConstructor=oConstructorInitializationData&&oConstructorInitializationData.objectInstance&&oConstructorInitializationData.objectInstance.runtimeClass;if(fnObjectConstructor===undefined){if(oConstructorInitializationData===oInitializationData){oConstructorClassDeclaration=oConstructorInitializationData&&oConstructorInitializationData.objectDeclaration;if(oConstructorClassDeclaration===undefined){throw"InvalidOperationException"}fnObjectConstructor=sap.galilei.model.internal.getOrCreateRuntimeClass.call(sap.galilei.model.internal.bootstrappingFlag,oConstructorClassDeclaration,this);oConstructorInitializationData.objectInstance=new fnObjectConstructor(this.resource,oConstructorClassDeclaration,sConstructorId,this)}else{if(oConstructorInitializationData!==undefined){if(oConstructorInitializationData.objectConstructor===undefined){this.setObjectConstructor(oConstructorInitializationData)}if(oConstructorInitializationData.objectDeclaration.parent){sConstructorParentId=this.qualifiedNameToIdentifier[oConstructorInitializationData.objectDeclaration.parent]||oConstructorInitializationData.objectDeclaration.parent;oConstructorParentInitializationData=this.identifierToInitializationData[sConstructorParentId];if(oConstructorParentInitializationData.objectConstructor===undefined){this.setObjectConstructor(oConstructorParentInitializationData);oConstructorParentInitializationData.objectInstance=new oConstructorParentInitializationData.objectConstructor(this.resource,oConstructorParentInitializationData.objectDeclaration,sConstructorParentId,this)}}oConstructorInitializationData.objectInstance=new oConstructorInitializationData.objectConstructor(this.resource,oConstructorInitializationData.objectDeclaration,sConstructorId,this);fnObjectConstructor=oConstructorInitializationData.objectInstance.runtimeClass}}}}}oInitializationData.objectConstructor=fnObjectConstructor},initialize:function(){this.resource.isLoading=true;this.qualifiedNameToIdentifier={};this.identifierToInitializationData={}},cleanup:function(){this.resource.isLoading=false;delete this.resource;delete this.qualifiedNameToIdentifier;delete this.identifierToInitializationData},load:function(oResource,oModelDeclaration,bBatchMode){var self=this;if(oResource===undefined){throw"NullArgumentException"}sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.applyUndoableAction(oResource,function(){self.resource=oResource;self.initialize();self.buildInitializationData(oModelDeclaration.contents);self.initializeConstructors();self.createObjects();self.attachObjectToContainers();self.initializeFeatures()},"Loading model...",true,bBatchMode);self.cleanup()}}})}());
"use strict";sap.galilei.model.metamodel("Galilei.Core",{contents:{Class:{classDefinition:"sap.galilei.model.Class",packageDefinition:"Galilei.Core",name:"Class",displayName:"Class",parent:"sap.galilei.model.Object",onInitialize:function(oResource,oClassDefinition){sap.galilei.model.internal.galileiClassInitializer.apply(this,arguments)},properties:{isAbstract:{name:"isAbstract",classDefinition:"sap.galilei.model.Property",defaultValue:false},onInitialize:{name:"onInitialize",classDefinition:"sap.galilei.model.Property"},onClassCascadeInitialize:{name:"onCascadeInitialize",displayName:"On Cascade Initialize",classDefinition:"sap.galilei.model.Property",isVolatile:true,isInternal:true},statics:{name:"statics",classDefinition:"sap.galilei.model.Property"},methods:{name:"methods",classDefinition:"sap.galilei.model.Property"},classQualifiedName:{name:"qualifiedName",displayName:"Qualified Name",classDefinition:"sap.galilei.model.Property",get:function(){if(this.packageDefinition!==undefined&&this.packageDefinition.namespaceName!==undefined){return this.packageDefinition.namespaceName+"."+this.name}return this.name}},className:{name:"name",displayName:"Name",classDefinition:"sap.galilei.model.Property",onChange:function(oEventArgs){var oInstance=oEventArgs.instance,vNewValue=oEventArgs.newValue,vOldValue=oEventArgs.oldValue,sType=oEventArgs.eventType;if(vOldValue!==undefined){throw {type:"InvalidOperationException",message:"Property 'name' can only be set once"}}var oPackageDefinition=oInstance.packageDefinition,oNamespace=oPackageDefinition&&oPackageDefinition.getNamespace();if(oNamespace!==undefined&&oInstance.runtimeClass!==undefined){oNamespace[vNewValue]=oInstance.runtimeClass}}},isClassUIVisible:{name:"isUIVisible",dataType:"gBool",classDefinition:"sap.galilei.model.Property"},isClassUIEditable:{name:"isUIEditable",dataType:"gBool",classDefinition:"sap.galilei.model.Property"}},references:{properties:{name:"properties",displayName:"Properties",classDefinition:"sap.galilei.model.Reference",contentType:"Property",isMany:true},references:{name:"references",displayName:"References",classDefinition:"sap.galilei.model.Reference",contentType:"Reference",isMany:true},parent:{name:"parent",displayName:"Parent",classDefinition:"sap.galilei.model.Reference",contentType:"Class",isMany:false},packageDefinition:{name:"packageDefinition",contentType:"Package",classDefinition:"sap.galilei.model.Reference",isMany:false,reverseReference:"classifiers",onChange:function(oEventArgs){var namespace=oEventArgs.newObject.getNamespace();if(oEventArgs.instance.name!==undefined){namespace[oEventArgs.instance.name]=oEventArgs.instance.runtimeClass}}},classAllClassifiers:{name:"allClassifiers",contentType:"Class",classDefinition:"sap.galilei.model.Reference",isMany:true,get:function(){var result={},oClassDefinition=this,oPackageDefinition,nClassifierIndex,max,oCurrentClassifier,oClassifiersCollection,aPackages=[];while(oClassDefinition){oPackageDefinition=oClassDefinition.packageDefinition;if(aPackages.indexOf(oPackageDefinition)===-1){aPackages.push(oPackageDefinition);oClassifiersCollection=oPackageDefinition.classifiers;if(oClassifiersCollection){for(nClassifierIndex=0,max=oClassifiersCollection.length;nClassifierIndex<max;nClassifierIndex++){oCurrentClassifier=oClassifiersCollection.get(nClassifierIndex);if(result[oCurrentClassifier.qualifiedName]===undefined){result[oCurrentClassifier.qualifiedName]=oCurrentClassifier}}}}if(oClassDefinition.parent&&oClassDefinition.parent.qualifiedName!=="sap.galilei.model.Object"){oClassDefinition=oClassDefinition.parent}else{oClassDefinition=undefined}}return result}},allProperties:{name:"allProperties",contentType:"Property",classDefinition:"sap.galilei.model.Reference",isMany:true,get:function(){var result={},oInstance=this,nPropertyIndex,max,oCurrentFeature,oPropertiesCollection;while(oInstance){oPropertiesCollection=oInstance.properties;if(oPropertiesCollection){for(nPropertyIndex=0,max=oPropertiesCollection.length;nPropertyIndex<max;nPropertyIndex++){oCurrentFeature=oPropertiesCollection.get(nPropertyIndex);if(result[oCurrentFeature.name]===undefined){result[oCurrentFeature.name]=oCurrentFeature}}}oInstance=oInstance.parent}return result}},allReferences:{name:"allReferences",contentType:"Reference",classDefinition:"sap.galilei.model.Reference",isMany:true,get:function(){var result={},oInstance=this,nReferenceIndex,max,oCurrentFeature,oReferencesCollection;while(oInstance){oReferencesCollection=oInstance.references;if(oReferencesCollection){for(nReferenceIndex=0,max=oReferencesCollection.length;nReferenceIndex<max;nReferenceIndex++){oCurrentFeature=oReferencesCollection.get(nReferenceIndex);if(result[oCurrentFeature.name]===undefined){result[oCurrentFeature.name]=oCurrentFeature}}}oInstance=oInstance.parent}return result}},subClasses:{name:"subClasses",contentType:"Class",classDefinition:"sap.galilei.model.Reference",isMany:true,reverseReference:"parent"},descendants:{name:"descendants",contentType:"Class",classDefinition:"sap.galilei.model.Reference",isMany:true,get:function(){var oResult=new sap.galilei.model.ArrayCollection(),oSubClasses=this.subClasses,nChildrenCount=oSubClasses.length,nChildrenIndex,oCurrentChild,oCurrentChildInstantiableChildren,oCurrentChildInstantiableChildrenCount,oCurrentChildInstantiableChildrenIndex,oCurrentChildInstantiableChildrenCurrentChild;for(nChildrenIndex=0;nChildrenIndex<nChildrenCount;nChildrenIndex++){oCurrentChild=oSubClasses.get(nChildrenIndex);oResult.push(oCurrentChild);oCurrentChildInstantiableChildren=oCurrentChild.descendants;oCurrentChildInstantiableChildrenCount=oCurrentChildInstantiableChildren.length;for(oCurrentChildInstantiableChildrenIndex=0;oCurrentChildInstantiableChildrenIndex<oCurrentChildInstantiableChildrenCount;oCurrentChildInstantiableChildrenIndex++){oCurrentChildInstantiableChildrenCurrentChild=oCurrentChildInstantiableChildren.get(oCurrentChildInstantiableChildrenIndex);oResult.push(oCurrentChildInstantiableChildrenCurrentChild)}}return oResult}}},methods:{isTypeOf:function(sParentQualifiedName){var bResult=false,oClass=this;while(oClass){if(oClass.qualifiedName===sParentQualifiedName){bResult=true;break}oClass=oClass.parent}return bResult},getProperty:function(sPropertyName){if(sPropertyName){var oProperties=this.allProperties;return oProperties&&oProperties[sPropertyName]}return undefined},getReference:function(sReference){if(sReference){var oReferences=this.allReferences;return oReferences&&oReferences[sReference]}return undefined},getFeature:function(sFeatureName){var oProperty=this.getProperty(sFeatureName);return oProperty!==undefined?oProperty:this.getReference(sFeatureName)},getReverseReference:function(oInstance,vDirectReferenceQualifiedNameOrInstance,bStrict){return sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.getReverseReference(oInstance,vDirectReferenceQualifiedNameOrInstance,bStrict)},create:function(oResource,oParam,sObjectId){if(oResource){oParam=oParam||{};return new this.runtimeClass(oResource,oParam,sObjectId)}throw"Cannot create an object without a resource."}}},Package:{classDefinition:"sap.galilei.model.Class",packageDefinition:"Galilei.Core",name:"Package",displayName:"Package",parent:"sap.galilei.model.Object",onInitialize:function(oResource,oPackageDefinition){var oPackageClassDefinition=this.classDefinition,oPackageRuntimeClass=oPackageClassDefinition&&oPackageClassDefinition.runtimeClass;this.__namespace=namespace(oPackageDefinition.namespaceName);if(oPackageRuntimeClass!==undefined&&oPackageRuntimeClass.registeredPackages!==undefined){oPackageRuntimeClass.registeredPackages[oPackageDefinition.namespaceName]=this;this.isInitialized=true}else{this.isInitialized=false}},properties:{namespaceName:{name:"namespaceName",displayName:"namespaceName",classDefinition:"sap.galilei.model.Property"},nameToClass:{name:"nameToClass",classDefinition:"sap.galilei.model.Property",isVolatile:true,get:function(){var result={},oClassifiersCollection=this.classifiers,oCurrentClass,nClassIndex,max;if(oClassifiersCollection){for(nClassIndex=0,max=oClassifiersCollection.length;nClassIndex<max;nClassIndex++){oCurrentClass=oClassifiersCollection.get(nClassIndex);if(oCurrentClass.name){result[oCurrentClass.name]=oCurrentClass}}}return result}},isPackageUIVisible:{name:"isUIVisible",dataType:"gBool",classDefinition:"sap.galilei.model.Property"},isPackageUIEditable:{name:"isUIEditable",dataType:"gBool",classDefinition:"sap.galilei.model.Property"}},references:{classifiers:{name:"classifiers",classDefinition:"sap.galilei.model.Reference",displayName:"Classifiers",contentType:"Class",isMany:true},allClassifiers:{name:"allClassifiers",contentType:"Class",classDefinition:"sap.galilei.model.Reference",isMany:true,get:function(){var result={},oPackageDefinition=this,nClassifierIndex,max,oCurrentClassifier,oClassifiersCollection;while(oPackageDefinition){oClassifiersCollection=oPackageDefinition.classifiers;if(oClassifiersCollection){for(nClassifierIndex=0,max=oClassifiersCollection.length;nClassifierIndex<max;nClassifierIndex++){oCurrentClassifier=oClassifiersCollection.get(nClassifierIndex);if(result[oCurrentClassifier.qualifiedName]===undefined){result[oCurrentClassifier.qualifiedName]=oCurrentClassifier}}}oPackageDefinition=oPackageDefinition.parent}return result}},enums:{name:"enums",classDefinition:"sap.galilei.model.Reference",displayName:"Enums",contentType:"sap.galilei.model.Enum",isMany:true}},methods:{getNamespace:function(){return this.__namespace},getClass:function(sClassifiedName){if(sClassifiedName){if(sClassifiedName.indexOf(".")!==-1){return this.allClassifiers[sClassifiedName]}return this.nameToClass&&this.nameToClass[sClassifiedName]}return undefined}},statics:{registeredPackages:{value:{}}}},"Galilei.Core":{classDefinition:"Package",name:"Galilei.Core",displayName:"Galilei Core Package",namespaceName:"sap.galilei.model"},Resource:{classDefinition:"sap.galilei.model.Class",packageDefinition:"Galilei.Core",name:"Resource",displayName:"Resource",parent:null,onInitialize:function(sObjectId){sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.onInitializeResource(this,sObjectId);var oResourceClassDefinition=sap.galilei.model.getClass("sap.galilei.model.Resource")||this.classDefinition,oResourceRuntimeClass=oResourceClassDefinition&&oResourceClassDefinition.runtimeClass;if(oResourceRuntimeClass!==undefined&&oResourceRuntimeClass.registeredResources!==undefined&&this.resourceId!==undefined){oResourceRuntimeClass.registeredResources[this.resourceId]=this}},properties:{isLoading:{name:"isLoading",displayName:"Is Loading",classDefinition:"sap.galilei.model.Property",isInternal:true},isInUndoRedo:{name:"isInUndoRedo",displayName:"Is in undo/redo",classDefinition:"sap.galilei.model.Property",isInternal:true,get:function(){return sap.galilei.model.gravity.ClassDefinitionBuilder.isInUndoRedo}},isCascadeAllowed:{name:"isCascadeAllowed",displayName:"Is cascade allowed",classDefinition:"sap.galilei.model.Property",isInternal:true,get:function(){return !this.isLoading&&!this.isInUndoRedo}},skipNotifications:{name:"skipNotifications",displayName:"Skip notifications",classDefinition:"sap.galilei.model.Property",defaultValue:false,isInternal:true},activeReader:{name:"activeReader",displayName:"Active Resource Reader",classDefinition:"sap.galilei.model.Property",isInternal:true},activeWriter:{name:"activeWriter",displayName:"Active Resource Writer",classDefinition:"sap.galilei.model.Property",isInternal:true},metadataResource:{name:"metadataResource",displayName:"Metadata Resource",classDefinition:"sap.galilei.model.Property",isInternal:true},isModified:{name:"isModified",displayName:"Is Modified",classDefinition:"sap.galilei.model.Property",isInternal:true,get:function(){var aActions=sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.getListOfActions(this,false,undefined,true);return(aActions!=null)&&(aActions.length>0)}},isTransactionOpened:{name:"isTransactionOpened",displayName:"Is transaction opened",classDefinition:"sap.galilei.model.Property",isInternal:true,get:function(){return sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.isTransactionOpened(this)}},isMainTransactionProtectedFromUndo:{name:"isMainTransactionProtectedFromUndo",displayName:"Is main transaction cannot be undone",classDefinition:"sap.galilei.model.Property",isInternal:true,get:function(){return sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.isMainTransactionProtectedFromUndo(this)}},listOfActions:{name:"listOfActions",displayName:"List of actions",classDefinition:"sap.galilei.model.Property",isInternal:true,get:function(){return sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.getListOfActions(this,true)}},fullListOfActions:{name:"fullListOfActions",displayName:"Full List of actions",classDefinition:"sap.galilei.model.Property",isInternal:true,get:function(){return sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.getListOfActions(this,false)}},isBatchModeEnabled:{name:"isBatchModeEnabled",displayName:"Is Batch Mode Enabled",classDefinition:"sap.galilei.model.Property",isInternal:true},resourceId:{name:"resourceId",displayName:"Resource Identifier",classDefinition:"sap.galilei.model.Property",isVolatile:true,onChange:function(oEventArgs){var oResources=sap.galilei.model.getResources(),sOldId=oEventArgs.oldValue,sNewId=oEventArgs.newValue,oResource=oEventArgs.instance;if(sOldId&&oResource&&oResources){delete oResources[sOldId];oResources[sNewId]=oResource}}}},references:{objects:{name:"objects",displayName:"Objects",classDefinition:"sap.galilei.model.Reference",contentType:"Object",isMany:true,isVolatile:true}},methods:{canUndo:function(){return sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.canUndo(this)},canRedo:function(){return sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.canRedo(this)},undo:function(){return sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.undo(this)},undoAll:function(){var bResult=false;while(this.canUndo()){this.undo();bResult=true}this.clearUndoStack();this.clearRedoStack();this.clearListOfActions();return bResult},redo:function(){return sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.redo(this)},applyUndoableAction:function(fnFunction,sDescription,bIsProtectedFromUndo,bBatchMode,fnError,fnPostApplyAction){try{sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.applyUndoableAction(this,fnFunction,sDescription,bIsProtectedFromUndo,bBatchMode,fnPostApplyAction)}catch(e){if(fnError){fnError(e)}else{throw e}}},getClass:function(sFullyQualifiedName){var oSplittedQualifiedName,sPackageNamespaceName,sClassName,oMetadataResource=this,oClass,oResolvedClasses,sM3ClassQualifiedName;if(sFullyQualifiedName){oSplittedQualifiedName=sap.galilei.model.splitClassQualifiedName(sFullyQualifiedName);sPackageNamespaceName=oSplittedQualifiedName&&oSplittedQualifiedName.packageNamespaceName;sClassName=oSplittedQualifiedName&&oSplittedQualifiedName.className;sM3ClassQualifiedName=(oMetadataResource&&oMetadataResource.classQualifiedName)||"sap.galilei.model.Class";oMetadataResource=oMetadataResource.metadataResource||(oMetadataResource.activeReader&&oMetadataResource.activeReader.metadataResource)||oMetadataResource;oResolvedClasses=oMetadataResource._resolvedClasses;if(!oResolvedClasses){oResolvedClasses={}}oClass=oResolvedClasses[sFullyQualifiedName];if(oClass===undefined){oClass=oMetadataResource.selectObject({qualifiedName:sFullyQualifiedName,"classDefinition.qualifiedName":sM3ClassQualifiedName});if(oClass===undefined){oClass=oMetadataResource.selectObject({name:sClassName,"packageDefinition.namespaceName":sPackageNamespaceName,"classDefinition.qualifiedName":sM3ClassQualifiedName})}if(oClass){oResolvedClasses[sFullyQualifiedName]=oClass;oMetadataResource._resolvedClasses=oResolvedClasses}}}return oClass},isTypeOf:function(sQualifiedName,sParentQualifiedName){if(sQualifiedName===undefined){return false}if(sQualifiedName===sParentQualifiedName){return true}var oClass=this.getClass(sQualifiedName);if(oClass){return oClass.isTypeOf(sParentQualifiedName)}return false},create:function(sFullyQualifiedName,oParam,sObjectId){var oClass=this.getClass(sFullyQualifiedName),oObject;if(oClass){oObject=oClass.create(this,oParam,sObjectId)}else{oObject=sap.galilei.model.createNewInstance(sFullyQualifiedName,this,oParam,sObjectId)}return oObject},getObject:function(sIdentity){return sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.getObject(this,sIdentity)},getObjectAsync:function(sIdentity,bAsync){var oActiveReader=this.activeReader;if(oActiveReader===undefined||oActiveReader.getObjectAsync===undefined){throw"InvalidOperationException"}return oActiveReader.getObjectAsync(sIdentity,bAsync)},getObjectPropertyAsync:function(oInstance,sPropertyName){var oActiveReader=this.activeReader;if(oActiveReader===undefined||oActiveReader.getObjectPropertyAsync===undefined){throw"InvalidOperationException"}return oActiveReader.getObjectPropertyAsync(oInstance,sPropertyName)},getObjectAtomicReferenceAsync:function(oInstance,sReferenceName,bAsync){var oActiveReader=this.activeReader;if(oActiveReader===undefined||oActiveReader.getObjectAtomicReferenceAsync===undefined){throw"InvalidOperationException"}return oActiveReader.getObjectAtomicReferenceAsync(oInstance,sReferenceName,bAsync)},loadObjectReferenceObjectsAsync:function(oInstance,sReferenceName,bAsync){var oActiveReader=this.activeReader,oResult;if(oActiveReader!==undefined&&oActiveReader.loadObjectReferenceObjectsAsync!==undefined){oResult=oActiveReader.loadObjectReferenceObjectsAsync(oInstance,sReferenceName,bAsync)}if(oResult===undefined){oResult=jQuery.Deferred();oResult.resolve()}return oResult},onUsingStrategyAsync:function(oStrategy,fnExecuteUsingStrategy){var oActiveReader=this.activeReader;if(oActiveReader===undefined||oActiveReader.onUsingStrategyAsync===undefined){throw"InvalidOperationException"}return oActiveReader.onUsingStrategyAsync(oStrategy,fnExecuteUsingStrategy)},runSync:function(fnLogic,fnError){sap.galilei.core.http.forceSynchronous=true;try{if(fnLogic){fnLogic()}}catch(e){if(fnError){fnError(e)}}finally{delete sap.galilei.core.http.forceSynchronous}},clearListOfActions:function(){sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.clearListOfActions(this)},clearUndoStack:function(){sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.clearUndoStack(this)},clearRedoStack:function(){sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.clearRedoStack(this)},clear:function(){sap.galilei.model.getResources()[this.resourceId]=undefined;delete sap.galilei.model.getResources()[this.resourceId];this.objects.clear();this.clearListOfActions();this.clearUndoStack();this.clearRedoStack()},selectObject:function(oFilters,fnMatchingLogic){return this.objects.selectObject(oFilters,fnMatchingLogic)},selectAllObjects:function(oFilters,fnMatchingLogic){return this.objects.selectAllObjects(oFilters,fnMatchingLogic)},addMonitor:function(oMonitor){var aMonitors=this._aMonitors;if(oMonitor===undefined){return}if(aMonitors===undefined){aMonitors=[]}if(aMonitors.indexOf(oMonitor)===-1){aMonitors.push(oMonitor)}this._aMonitors=aMonitors},removeMonitor:function(oMonitor){if(oMonitor!==undefined&&(oMonitor.clear instanceof Function)){oMonitor.clear(this,true,false)}},clearMonitors:function(){sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.clearMonitors(this)},findMonitor:function(sResourceid,oIntance,sPropertyName){return sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.findMonitor(this,sResourceid,oIntance,sPropertyName)}},statics:{registeredResources:{value:{}}}},Object:{classDefinition:"sap.galilei.model.Class",packageDefinition:"Galilei.Core",name:"Object",displayName:"Object",parent:null,onInitialize:function(oResource,oObjectDefinition,sObjectId){if(!this.isInitialized){sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.onInitializeObject(this,oResource,sObjectId);oResource.objects.push(this);this.isInitialized=true}},properties:{onBeforeDelete:{name:"onBeforeDelete",displayName:"On Before Delete",owningClassDefinition:"Object",classDefinition:"sap.galilei.model.Property",isVolatile:true,isInternal:true},onDelete:{name:"onDelete",displayName:"On Delete",owningClassDefinition:"Object",classDefinition:"sap.galilei.model.Property",isVolatile:true,isInternal:true},isInternal:{name:"isInternal",displayName:"Internal Value",owningClassDefinition:"Object",classDefinition:"sap.galilei.model.Property",isVolatile:true,isInternal:true,defaultValue:false},isVolatile:{name:"isVolatile",displayName:"Volatile Value",owningClassDefinition:"Object",classDefinition:"sap.galilei.model.Property",isVolatile:true,isInternal:true,defaultValue:false},isAsync:{name:"isAsync",displayName:"Async Value",owningClassDefinition:"Object",classDefinition:"sap.galilei.model.Property",isVolatile:true,isInternal:true,defaultValue:false},proxiedObjectId:{name:"proxiedObjectId",displayName:"Proxified Object Id",dataType:"gString",owningClassDefinition:"Object",classDefinition:"sap.galilei.model.Property"},proxiedObjectResourceId:{name:"proxiedObjectResourceId",displayName:"Proxified Object Resource Id",dataType:"gString",owningClassDefinition:"Object",classDefinition:"sap.galilei.model.Property"},isProxyAutoResolve:{name:"isProxyAutoResolve",displayName:"Is Proxy Auto Resolve",dataType:"gBool",owningClassDefinition:"Object",classDefinition:"sap.galilei.model.Property",defaultValue:true,isVolatile:true},name:{name:"name",displayName:"Name",classDefinition:"sap.galilei.model.Property"},displayName:{name:"displayName",displayName:"Display Name",classDefinition:"sap.galilei.model.Property",defaultValue:function(oInstance){return oInstance.name}},objectId:{name:"objectId",classDefinition:"sap.galilei.model.Property",dataType:"gString",get:function(){return sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.getObjectId(this)}},isProxy:{name:"isProxy",displayName:"Is Proxy",dataType:"gBool",owningClassDefinition:"Object",classDefinition:"sap.galilei.model.Property",get:function(){var bResult=(this.proxiedObjectId!==undefined&&this.proxiedObjectResourceId!==undefined);return bResult}},isDeleting:{name:"isDeleting",displayName:"Is Deleting",owningClassDefinition:"Object",classDefinition:"sap.galilei.model.Property",defaultValue:false,isVolatile:true,isInternal:true},isAlive:{name:"isAlive",displayName:"Is Alive",owningClassDefinition:"Object",classDefinition:"sap.galilei.model.Property",defaultValue:true,isVolatile:true,isInternal:true}},references:{resource:{name:"resource",classDefinition:"sap.galilei.model.Reference",contentType:"Resource",isMany:false,reverseReference:"sap.galilei.model.Resource.objects"},children:{name:"children",classDefinition:"sap.galilei.model.Reference",contentType:"Object",isMany:true,get:function(){return sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.getChildren(this)},onChange:function(oEventArgs){var oNewItem=oEventArgs.newObject||oEventArgs.oldObject;if(oNewItem){delete oNewItem.__container;if(oNewItem.fireMemberChanged){oNewItem.fireMemberChanged("container")}}}},container:{name:"container",classDefinition:"sap.galilei.model.Reference",contentType:"Object",isMany:false,get:function(){return sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.getContainer(this)}},rootContainer:{name:"rootContainer",classDefinition:"sap.galilei.model.Reference",contentType:"Object",isMany:false,get:function(){var container=this.container;return container!==undefined?container.rootContainer:this}},proxiedObject:{name:"proxiedObject",displayName:"Proxied Object",owningClassDefinition:"Object",classDefinition:"sap.galilei.model.Reference",isVolatile:true,get:function(){var oTargetResource=sap.galilei.model.getResource(this.proxiedObjectResourceId),oResult=oTargetResource&&sap.galilei.model.getObject(oTargetResource,this.proxiedObjectId);return oResult}}},methods:{isInstanceOf:function(sQualifiedClassName){if(sQualifiedClassName){return this.classDefinition.isTypeOf(sQualifiedClassName)}return false},formatValue:function(sProperty,vValue,sTargetType){var oProperty=sProperty&&this.classDefinition.getProperty(sProperty),oConstraint;if(oProperty&&oProperty.constraint){oConstraint=oProperty.constraint;if(typeof oConstraint.formatValue==="function"){vValue=oConstraint.formatValue.call(oConstraint,this,vValue,sTargetType)}}return vValue},coerceValue:function(sProperty,vValue){var oProperty=sProperty&&this.classDefinition.getProperty(sProperty),oConstraint;if(oProperty&&oProperty.constraint){oConstraint=oProperty.constraint;if(typeof oConstraint.coerceValue==="function"){vValue=oConstraint.coerceValue.call(oConstraint,this,vValue)}}return vValue},getFormattedValue:function(sProperty,sTargetType){return sProperty&&this.formatValue(sProperty,this[sProperty],sTargetType)},setFormattedValue:function(sProperty,vValue){if(sProperty){vValue=this.coerceValue(sProperty,vValue);this[sProperty]=vValue}return vValue},copyObjectProperties:function(oSourceObject,aIncludedProperties,aExcludedProperties){var aCommonProperties,oResource,oSourceProperties,oTargetProperties,aSourceProperyNames,aTargetProperyNames,index,sPropertyName,self=this;function getPropertyNames(oProperties){var aProperties=[],oProperty,sName;if(oProperties){for(sName in oProperties){if(oProperties.hasOwnProperty(sName)){oProperty=oProperties[sName];if(!oProperty.isComputed&&oProperty.isInitialized!==false){aProperties.push(sName)}}}}return aProperties}function intersectPropertyNames(aSourceNames,aTargetNames){var aCommonNames=[],i,j,sSourceName,sTargetName;if(aSourceNames&&aTargetNames){for(i=0;i<aSourceNames.length;i++){sSourceName=aSourceNames[i];for(j=0;j<aTargetNames.length;j++){sTargetName=aTargetNames[j];if(sSourceName===sTargetName){aCommonNames.push(sSourceName)}}}}return aCommonNames}function excludePropertyNames(aNames,aExcludedProperties){var aCommonNames=aNames,i,sName;if(aNames&&aExcludedProperties){aCommonNames=[];for(i=0;i<aNames.length;i++){sName=aNames[i];if(aExcludedProperties.indexOf(sName)===-1){aCommonNames.push(sName)}}}return aCommonNames}function internalCopyObjectProperties(){oSourceProperties=oSourceObject.classDefinition&&oSourceObject.classDefinition.allProperties;oTargetProperties=self.classDefinition&&self.classDefinition.allProperties;if(oSourceProperties&&oTargetProperties){aSourceProperyNames=getPropertyNames(oSourceProperties);aTargetProperyNames=getPropertyNames(oTargetProperties);aCommonProperties=intersectPropertyNames(aSourceProperyNames,aTargetProperyNames);if(aIncludedProperties){aCommonProperties=intersectPropertyNames(aCommonProperties,aIncludedProperties)}if(aExcludedProperties){aCommonProperties=excludePropertyNames(aCommonProperties,aExcludedProperties)}for(index=0;index<aCommonProperties.length;index++){sPropertyName=aCommonProperties[index];self[sPropertyName]=oSourceObject[sPropertyName]}}}if(oSourceObject){oResource=oSourceObject.resource;if(oResource){oResource.applyUndoableAction(internalCopyObjectProperties,"Copy Object Properties")}else{internalCopyObjectProperties()}}return aCommonProperties},deleteObject:function(){var oResource=this.resource;this.isDeleting=true;if(oResource.activeReader&&oResource.activeReader.isPartialLoadReader){this.deleteObjectAsync()}else{this.deleteObjectSync()}},deleteObjectSync:function(){var oClassDefinition=this.classDefinition,oResource=this.resource,oContainer=this.container,self=this,bIsCascadeAllowed=(self.resource===undefined)||(self.resource.isCascadeAllowed===true);this.isDeleting=true;if(oClassDefinition!==undefined&&oResource!==undefined){oResource.applyUndoableAction(function(){if(self.onBeforeDelete){self.onBeforeDelete()}self.deleteObjectCompositionObjects();sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.deleteObject(self);sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.clearMonitors(self);if(oContainer!==undefined){sap.galilei.model.gravity.ClassDefinitionBuilder.notifyReferenceChanged(oContainer,bIsCascadeAllowed,sap.galilei.model.getReference(oContainer.classDefinition.qualifiedName+"."+oContainer.getContainingReference(self.classDefinition.qualifiedName)),undefined,self,undefined)}},"Delete object '"+self.name+"'")}this.isDeleting=false},deleteObjectCompositionObjects:function(){var oClassDefinition=this.classDefinition,oReferences,oCurrentReference,aCurrentReferenceValues,oCurrentReferenceValue,self=this,sReference,nReferenceValuesIndex;oReferences=oClassDefinition.allReferences;for(sReference in oReferences){oCurrentReference=oReferences[sReference];if(oCurrentReference!==undefined&&oCurrentReference.isContainment){if(oCurrentReference.isMany){aCurrentReferenceValues=self[oCurrentReference.name];if(aCurrentReferenceValues){for(nReferenceValuesIndex=aCurrentReferenceValues.length-1;nReferenceValuesIndex>=0;nReferenceValuesIndex--){oCurrentReferenceValue=aCurrentReferenceValues.get(nReferenceValuesIndex);if(oCurrentReferenceValue.deleteObjectSync){oCurrentReferenceValue.deleteObjectSync()}}}}else{oCurrentReferenceValue=self[oCurrentReference.name];if(oCurrentReferenceValue!==undefined){if(oCurrentReferenceValue.deleteObjectSync){oCurrentReferenceValue.deleteObjectSync()}}}}}},deleteObjectAsync:function(){var self=this;this.isDeleting=true;return this.resource.onUsingStrategyAsync(this.resource.activeReader.getDeleteStrategy(this.objectId),function(){self.deleteObjectSync.call(self)})},getLinkObjects:function(bIncludeSource,bIncludeTarget){var oLinks,oLinks2;if(bIncludeSource||bIncludeSource===undefined){oLinks=this.classDefinition.getReverseReference(this,"sap.galilei.common.LinkObject.source").values}if(bIncludeTarget||bIncludeTarget===undefined){oLinks2=this.classDefinition.getReverseReference(this,"sap.galilei.common.LinkObject.target").values}if(oLinks&&oLinks2){oLinks=oLinks.concat(oLinks2)}else{if(!oLinks&&oLinks2){oLinks=oLinks2}}return oLinks},getSourceLinkObjects:function(){return this.getLinkObjects(true,false)},getTargetLinkObjects:function(){return this.getLinkObjects(false,true)},addPropertyListener:function(listener,sPropertyName){var oPropertyListeners=this._oPropertyListeners,aPropertyListeners,sPropertyListenersKey=(sPropertyName!==undefined?sPropertyName:"*");if(oPropertyListeners===undefined){oPropertyListeners=this._oPropertyListeners={}}aPropertyListeners=oPropertyListeners[sPropertyListenersKey];if(aPropertyListeners===undefined){aPropertyListeners=oPropertyListeners[sPropertyListenersKey]=[]}aPropertyListeners.push(listener)},removePropertyListener:function(listener,sPropertyName){var oPropertyListeners=this._oPropertyListeners,aPropertyListeners,sPropertyListenersKey=(sPropertyName!==undefined?sPropertyName:"*");if(oPropertyListeners===undefined){oPropertyListeners=this._oPropertyListeners={}}aPropertyListeners=oPropertyListeners[sPropertyListenersKey];if(aPropertyListeners!==undefined){aPropertyListeners.splice(aPropertyListeners.indexOf(listener),1)}},getPropertyListeners:function(sPropertyName){var oPropertyListeners=this._oPropertyListeners,aInstanceGenericListeners,aInstanceSpecificListeners,aInstanceListeners=[],aClassDefinitionGenericListeners,aClassDefinitionSpecificListeners,aClassDefinitionListeners=[],aListeners;if(oPropertyListeners){aInstanceGenericListeners=oPropertyListeners["*"]||[];aInstanceSpecificListeners=oPropertyListeners[sPropertyName]||[];aInstanceListeners=aInstanceGenericListeners.concat(aInstanceSpecificListeners)}var oClassDefinition=this.classDefinition;while(oClassDefinition){if(oClassDefinition._oPropertyListeners!==undefined){aClassDefinitionGenericListeners=oClassDefinition._oPropertyListeners["*"]||[];aClassDefinitionSpecificListeners=oClassDefinition._oPropertyListeners[sPropertyName]||[];aClassDefinitionListeners=aClassDefinitionListeners.concat(aClassDefinitionGenericListeners);aClassDefinitionListeners=aClassDefinitionListeners.concat(aClassDefinitionSpecificListeners)}oClassDefinition=oClassDefinition.parent}aListeners=aInstanceListeners.concat(aClassDefinitionListeners);return aListeners},firePropertyChanged:function(oEventArgs,sPass,bIsCascadeAllowed){oEventArgs=oEventArgs||{};var sPropertyName=oEventArgs.propertyName,oResource=this.resource,oGalileiObject=sap.galilei.model.getClass("sap.galilei.model.Class"),oCurrentPropertyListener,oCurrentOptionalArguments,oCurrentEventArgs,i,max,aPropertyListeners;if(oResource&&oResource.isBatchModeEnabled){oResource._modifiedObjects=oResource._modifiedObjects||[];if(oResource._modifiedObjects.indexOf(this)==-1){oResource._modifiedObjects.push(this)}oResource._propertyChangedEventArgs=oResource._propertyChangedEventArgs||[];oResource._propertyChangedEventArgs.push({instance:this,eventArgs:oEventArgs,pass:sPass,isCascadeAllowed:bIsCascadeAllowed})}else{sPass=sPass||"all";if(oGalileiObject!==undefined&&!oGalileiObject.firing){oGalileiObject.firing=this}this.fireMemberChanged(sPropertyName,sPass);aPropertyListeners=this.getPropertyListeners(sPropertyName);if(aPropertyListeners!==undefined){for(i=0,max=aPropertyListeners.length;i<max;i++){oCurrentPropertyListener=aPropertyListeners[i];oCurrentOptionalArguments=oCurrentPropertyListener!==undefined?oCurrentPropertyListener.optionalArguments:{};oCurrentEventArgs=jQuery.extend(oCurrentOptionalArguments,oEventArgs);if(oCurrentPropertyListener.onPropertyChanged){oCurrentPropertyListener.onPropertyChanged(oCurrentEventArgs)}if(bIsCascadeAllowed&&oCurrentPropertyListener.onPropertyCascadeChanged){oCurrentPropertyListener.onPropertyCascadeChanged(oCurrentEventArgs)}}}if(oResource._skipObjectNotification!==true){this.fireObjectChanged({object:this},bIsCascadeAllowed)}if(this._firingCompletedCallbacks){for(i=0,max=this._firingCompletedCallbacks.length;i<max;i++){this._firingCompletedCallbacks[i]()}delete this._firingCompletedCallbacks}if(oGalileiObject!==undefined&&oGalileiObject.firing==this){delete oGalileiObject.firing}}},addReferenceListener:function(listener,sReferenceName){var oReferenceListeners=this._oReferenceListeners,aReferenceListeners,sReferenceListenersKey=(sReferenceName!==undefined?sReferenceName:"*");if(oReferenceListeners===undefined){oReferenceListeners=this._oReferenceListeners={}}aReferenceListeners=oReferenceListeners[sReferenceListenersKey];if(aReferenceListeners===undefined){aReferenceListeners=oReferenceListeners[sReferenceListenersKey]=[]}aReferenceListeners.push(listener)},removeReferenceListener:function(listener,sReferenceName){var oReferenceListeners=this._oReferenceListeners,aReferenceListeners,sReferenceListenersKey=(sReferenceName!==undefined?sReferenceName:"*");if(oReferenceListeners===undefined){oReferenceListeners=this._oReferenceListeners={}}aReferenceListeners=oReferenceListeners[sReferenceListenersKey];if(aReferenceListeners!==undefined){aReferenceListeners.splice(aReferenceListeners.indexOf(listener),1)}},getReferenceListeners:function(sReferenceName){var oReferenceListeners=this._oReferenceListeners,aInstanceGenericListeners,aInstanceSpecificListeners,aInstanceListeners=[],aClassDefinitionGenericListeners,aClassDefinitionSpecificListeners,aClassDefinitionListeners=[],aListeners;if(oReferenceListeners){aInstanceGenericListeners=oReferenceListeners["*"]||[];aInstanceSpecificListeners=oReferenceListeners[sReferenceName]||[];aInstanceListeners=aInstanceGenericListeners.concat(aInstanceSpecificListeners)}var oClassDefinition=this.classDefinition;while(oClassDefinition){if(oClassDefinition._oReferenceListeners!==undefined){aClassDefinitionGenericListeners=oClassDefinition._oReferenceListeners["*"]||[];aClassDefinitionSpecificListeners=oClassDefinition._oReferenceListeners[sReferenceName]||[];aClassDefinitionListeners=aClassDefinitionListeners.concat(aClassDefinitionGenericListeners);aClassDefinitionListeners=aClassDefinitionListeners.concat(aClassDefinitionSpecificListeners)}oClassDefinition=oClassDefinition.parent}aListeners=aInstanceListeners.concat(aClassDefinitionListeners);return aListeners},fireReferenceChanged:function(oEventArgs,sPass){var oGalileiObject=sap.galilei.model.getClass("sap.galilei.model.Class"),oResource=this.resource,sReferenceName=oEventArgs.referenceName,oCurrentEventArgs,oCurrentOptionalArguments,oCurrentReferenceListener,i,max,aReferenceListeners;if(oResource&&oResource.isBatchModeEnabled){oResource._modifiedObjects=oResource._modifiedObjects||[];if(oResource._modifiedObjects.indexOf(this)==-1){oResource._modifiedObjects.push(this)}oResource._referenceChangedEventArgs=oResource._referenceChangedEventArgs||[];oResource._referenceChangedEventArgs.push({instance:this,eventArgs:oEventArgs,pass:sPass})}else{sPass=sPass||"all";if(oGalileiObject!==undefined&&!oGalileiObject.firing){oGalileiObject.firing=this}this.fireMemberChanged(sReferenceName,sPass);aReferenceListeners=this.getReferenceListeners(sReferenceName);if(aReferenceListeners!==undefined){for(i=0,max=aReferenceListeners.length;i<max;i++){oCurrentReferenceListener=aReferenceListeners[i];oCurrentOptionalArguments=oCurrentReferenceListener!==undefined?oCurrentReferenceListener.optionalArguments:{};oCurrentEventArgs=jQuery.extend(oCurrentOptionalArguments,oEventArgs);oCurrentReferenceListener.onReferenceChanged(oCurrentEventArgs)}}if(oResource._skipObjectNotification!==true){this.fireObjectChanged({object:this},false)}if(this._firingCompletedCallbacks){for(i=0,max=this._firingCompletedCallbacks.length;i<max;i++){this._firingCompletedCallbacks[i]()}delete this._firingCompletedCallbacks}if(oGalileiObject!==undefined&&oGalileiObject.firing==this){delete oGalileiObject.firing}}},addObjectListener:function(listener){var aReferenceListeners=this._aObjectListeners;if(aReferenceListeners===undefined){aReferenceListeners=this._aObjectListeners=[]}aReferenceListeners.push(listener)},removeObjectListener:function(listener,sReferenceName){var aReferenceListeners=this._aObjectListeners;if(aReferenceListeners!==undefined){aReferenceListeners.splice(aReferenceListeners.indexOf(listener),1)}},fireObjectChanged:function(oEventArgs,bIsCascadeAllowed){var oCurrentObjectListener,aObjectListeners=this.getObjectListeners(),i,max;for(i=0,max=aObjectListeners.length;i<max;i++){oCurrentObjectListener=aObjectListeners[i];if(oCurrentObjectListener.resource!==undefined&&this.resource!==undefined&&oCurrentObjectListener.resource!==this.resource){continue}if(oCurrentObjectListener.onObjectChanged){oCurrentObjectListener.onObjectChanged(oEventArgs)}if(bIsCascadeAllowed&&oCurrentObjectListener.onObjectCascadeChanged){oCurrentObjectListener.onObjectCascadeChanged(oEventArgs)}}},getObjectListeners:function(){var aInstanceListeners=this._aObjectListeners||[],oClassDefinition=this.classDefinition;while(oClassDefinition){if(oClassDefinition._aObjectListeners!==undefined){aInstanceListeners=aInstanceListeners.concat(oClassDefinition._aObjectListeners)}oClassDefinition=oClassDefinition.parent}return aInstanceListeners},addMonitor:function(oMonitor){var aMonitors=this._aMonitors;if(oMonitor===undefined){return}if(aMonitors===undefined){aMonitors=[]}if(aMonitors.indexOf(oMonitor)===-1){aMonitors.push(oMonitor)}this._aMonitors=aMonitors},removeMonitor:function(oMonitor){if(oMonitor!==undefined&&(oMonitor.clear instanceof Function)){oMonitor.clear(this,true,false)}},clearMonitors:function(){sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.clearMonitors(this)},findMonitor:function(sResourceid,oInstance,sPropertyName){return sap.galilei.model.DEFAULT_CLASS_DEFINITION_BUILDER.findMonitor(this,sResourceid,oInstance,sPropertyName)},getMonitor:function(sPropertyName){var sBackingFieldName,oBackingField,sResourceId,oMonitor;if(sPropertyName){sBackingFieldName="__"+sPropertyName;oBackingField=this[sBackingFieldName];if(oBackingField){oMonitor=oBackingField.monitor}else{sResourceId=this.resource?this.resource._nodeIdentity:undefined;oMonitor=this.findMonitor(sResourceId,this,sPropertyName)}}return oMonitor},updateMonitor:function(sPropertyName,vValue){var sBackingFieldName,oBackingField,oMonitor;if(sPropertyName){sBackingFieldName="__"+sPropertyName;oBackingField=this[sBackingFieldName];oMonitor=oBackingField&&oBackingField.monitor;if(oMonitor){oBackingField.value=vValue;if(this.fireMemberChanged){this.fireMemberChanged(sPropertyName)}}}},fireMemberChanged:function(sPropertyName,sPass){var aMonitors=this._aMonitors&&this._aMonitors.slice(0),i,max;if(aMonitors){if(sPass!="update"){for(i=0,max=aMonitors.length;i<max;i++){if(aMonitors[i].onMemberChanged_clear!==undefined){aMonitors[i].onMemberChanged_clear(this,sPropertyName)}}}if(sPass!="clear"){for(i=0;i<aMonitors.length;i++){aMonitors[i].onMemberChanged(this,sPropertyName)}}}},removePropertyMonitor:function(sPropertyName){var oMonitor=sPropertyName&&this.getMonitor(sPropertyName);if(oMonitor!==undefined){this.removeMonitor(oMonitor)}},indexObject:function(oProperty,sOldKey,sNewKey){var oInstance=this,oAllIndexes=oInstance.resource._oIndexes,oPropertyIndexes,aMatchingObjects,nMatchingIndex;if(oProperty.isIndex===true){if(sOldKey!==sNewKey){if(oAllIndexes===undefined){oInstance.resource._oIndexes={};oAllIndexes=oInstance.resource._oIndexes}oPropertyIndexes=oAllIndexes[oProperty.name];if(oPropertyIndexes!==undefined){if(sOldKey!==undefined){aMatchingObjects=oPropertyIndexes[sOldKey];if(aMatchingObjects!==undefined){nMatchingIndex=aMatchingObjects.indexOf(oInstance);if(nMatchingIndex!==-1){aMatchingObjects.splice(nMatchingIndex,1);if(aMatchingObjects.length===0){delete oPropertyIndexes[sOldKey]}}}}}if(sNewKey!==undefined){if(oPropertyIndexes===undefined){oAllIndexes[oProperty.name]={};oPropertyIndexes=oAllIndexes[oProperty.name]}aMatchingObjects=oPropertyIndexes[sNewKey];if(aMatchingObjects===undefined){oPropertyIndexes[sNewKey]=[];aMatchingObjects=oPropertyIndexes[sNewKey]}nMatchingIndex=aMatchingObjects.indexOf(oInstance);if(nMatchingIndex===-1){aMatchingObjects.push(oInstance)}}}}else{throw"InvalidOperationException"}},indexObjectProperties:function(){var oClassDefinition=this.classDefinition,oAllProperties=oClassDefinition.allProperties,oAllIndexes=this.resource._oIndexes,index,max,sPropertyName,aProperties,oCurrentProperty;if(oAllIndexes!==undefined&&sap.galilei.core.getObjectSize(oAllIndexes)>0&&oAllProperties!==undefined){aProperties=Object.getOwnPropertyNames(oAllProperties);for(index=0,max=aProperties.length;index<max;index++){sPropertyName=aProperties[index];oCurrentProperty=oAllProperties[sPropertyName];if(oCurrentProperty.isIndex===true){this.indexObject(oCurrentProperty,undefined,this[sPropertyName])}}}},unindexObject:function(){var oClassDefinition=this.classDefinition,oAllProperties=oClassDefinition.allProperties,aProperties,index,max,sPropertyName,sPropertyValue,oCurrentProperty,oAllIndexes=this.resource._oIndexes,oPropertyIndexes,index2,aIndexProperties,max2,sPropertyValue2,aMatchingObjects,nMatchingIndex;if(oAllIndexes!==undefined&&sap.galilei.core.getObjectSize(oAllIndexes)>0&&oAllProperties!==undefined){aProperties=Object.getOwnPropertyNames(oAllProperties);for(index=0,max=aProperties.length;index<max;index++){sPropertyName=aProperties[index];oCurrentProperty=oAllProperties[sPropertyName];if(oCurrentProperty.isIndex===true){oPropertyIndexes=oAllIndexes[sPropertyName];sPropertyValue=this[sPropertyName];if(oPropertyIndexes!==undefined){if(sPropertyValue!==undefined){aMatchingObjects=oPropertyIndexes[sPropertyValue];if(aMatchingObjects!==undefined){nMatchingIndex=aMatchingObjects.indexOf(this);if(nMatchingIndex!==-1){aMatchingObjects.splice(nMatchingIndex,1);if(aMatchingObjects.length===0){delete oPropertyIndexes[sPropertyValue]}}}}else{if(this.isAlive===false){aIndexProperties=Object.getOwnPropertyNames(oPropertyIndexes);for(index2=0,max2=aIndexProperties.length;index2<max2;index2++){sPropertyValue2=aIndexProperties[index2];aMatchingObjects=oPropertyIndexes[sPropertyValue2];if(aMatchingObjects!==undefined){nMatchingIndex=aMatchingObjects.indexOf(this);if(nMatchingIndex!==-1){aMatchingObjects.splice(nMatchingIndex,1);if(aMatchingObjects.length===0){delete oPropertyIndexes[sPropertyValue2]}}}}}}}}}}},getProxiedObjectAsync:function(){var oResult=jQuery.Deferred(),oTargetResource=sap.galilei.model.getResource(this.proxiedObjectResourceId);if(this.proxiedObject!==undefined){oResult.resolve(this.proxiedObject)}else{if(oTargetResource===undefined){oTargetResource=new sap.galilei.model.Resource(this.proxiedObjectResourceId)}jQuery.when(oTargetResource.getObjectAsync(this.proxiedObjectId)).done(function(oInstance){oResult.resolve(oInstance)})}return oResult},getAdapter:function(sClassDefinitionQualifiedName){return undefined},proxyObject:function(oInstance){var self=this,oResource=this.resource;if(oResource){oResource.applyUndoableAction(function(){jQuery.each(self.classDefinition.allProperties,function(sPropertyName){if(self[sPropertyName]!==undefined&&!this.isVolatile&&!this.isComputed){self[sPropertyName]=undefined}});self.proxiedObjectId=oInstance.objectId;self.proxiedObjectResourceId=oInstance.resource.resourceId},"Proxy object",false,true)}},replaceByObject:function(oInstance,bReplaceDirectReferences){this.defaultReplaceByObject(oInstance,bReplaceDirectReferences)},defaultReplaceByObject:function(oInstance,bReplaceDirectReferences){var self=this,oResource=this.resource,aReferences,sReference,oNode,aReferencingNodes,nLength,refNode,oRefObj,oRefDefn,nRemoveIndex,aListenersList,aListeners,oListener,sListener,i;if(oInstance==null){throw {type:"InvalidOperationException",message:"Cannot replace an object by nothing"}}if(oInstance.classDefinition===undefined){throw {type:"InvalidOperationException",message:"Cannot replace an object by a non-Galilei object: "+oInstance}}if(oResource&&(oInstance!=self)){if(oInstance._oPropertyListeners){for(sListener in oInstance._oPropertyListeners){aListeners=self._oPropertyListeners[sListener];if(aListeners){jQuery.merge(oInstance._oPropertyListeners[sListener],aListeners)}}}else{oInstance._oPropertyListeners=self._oPropertyListeners}if(oInstance._oReferenceListeners){for(sListener in oInstance._oReferenceListeners){aListeners=self._oReferenceListeners[sListener];if(aListeners){jQuery.merge(oInstance._oReferenceListeners[sListener],aListeners)}}}else{oInstance._oReferenceListeners=self._oReferenceListeners}oResource.applyUndoableAction(function(){var currentContainer=self.container,containmentName,oInstanceClassDefinition=oInstance.classDefinition,nIndexInContainment,containmentCollection,sReference;if(!oInstance.container){if(oInstanceClassDefinition&&currentContainer&&currentContainer.getContainingReference){containmentName=currentContainer.getContainingReference(oInstanceClassDefinition.qualifiedName,false,true);if(containmentName){containmentCollection=currentContainer[containmentName];nIndexInContainment=containmentCollection?containmentCollection.indexOf(self):-1;if(nIndexInContainment!==-1){containmentCollection.removeAt(nIndexInContainment);if(oInstance.container!==currentContainer){containmentCollection.insert(nIndexInContainment,oInstance)}}else{containmentCollection.push(oInstance)}}}}oNode=sap.galilei.model.gravity.getGravityNode(self);aReferences=oNode.listReverseAtomicReferences();for(sReference in aReferences){sReference=aReferences[sReference];aReferencingNodes=oNode.getReverseAtomicReferences(sReference);nLength=aReferencingNodes.length;for(i=0;i<nLength;i+=1){refNode=aReferencingNodes[i];oRefObj=sap.galilei.model.gravity.getGalileiObject(refNode);if(oRefObj){oRefDefn=oRefObj.classDefinition.getReference(sReference);if(oRefDefn&&(!oRefDefn.isComputed||(oRefDefn.set instanceof Function))){oRefObj[sReference]=oInstance}}}}aReferences=oNode.listReverseOrderedReferences();for(sReference in aReferences){sReference=aReferences[sReference];aReferencingNodes=oNode.getReverseOrderedReferences(sReference);nLength=aReferencingNodes.length;for(i=0;i<nLength;i+=1){refNode=aReferencingNodes[i];oRefObj=sap.galilei.model.gravity.getGalileiObject(refNode);if(oRefObj){oRefDefn=oRefObj.classDefinition.getReference(sReference);if(oRefDefn&&!oRefDefn.isComputed){if(oRefDefn.isContainment){nRemoveIndex=oRefObj[sReference].contains(self);if(nRemoveIndex!==-1){refNode.removeOrderedReference(sReference,nRemoveIndex)}continue}if(oRefObj[sReference].contains(oInstance)===-1){oRefObj[sReference].push(oInstance)}}}}}if(bReplaceDirectReferences===true){aReferences=oNode.listAtomicReferences();for(sReference in aReferences){sReference=aReferences[sReference];refNode=oNode.getAtomicReference(sReference);oRefObj=sap.galilei.model.gravity.getGalileiObject(refNode);if(oRefObj){oRefDefn=oInstance.classDefinition.getReference(sReference);if(oRefDefn&&(!oRefDefn.isComputed||(oRefDefn.set instanceof Function))){oInstance[sReference]=oRefObj}}}aReferences=oNode.listOrderedReferences();for(sReference in aReferences){sReference=aReferences[sReference];aReferencingNodes=oNode.getOrderedReference(sReference);nLength=aReferencingNodes.length;for(i=0;i<nLength;i+=1){refNode=aReferencingNodes[i];oRefObj=sap.galilei.model.gravity.getGalileiObject(refNode);if(oRefObj){oRefDefn=oInstance.classDefinition.getReference(sReference);if(oRefDefn&&!oRefDefn.isComputed){if(oRefDefn.isContainment){nRemoveIndex=self[sReference].indexOf(oRefObj);if(nRemoveIndex!==-1){oNode.removeOrderedReference(sReference,nRemoveIndex)}}if(oInstance[sReference]){oInstance[sReference].push(oRefObj)}}}}}}self.deleteObjectSync()},"Replace by object")}},getContainingReference:function(sQualifiedClassName,bSearchAncestors,bIsContainment,oMetadataResource){var oContainer=this,oMatchingContainer,sResult,nBestInheritanceLevel=-1,nInheritanceLevel;if(bIsContainment===undefined){bIsContainment=true}if(!oMetadataResource){if(this.resource&&this.resource.activeReader){oMetadataResource=this.resource.activeReader.metadataResource}}var fnFindReference=function(oInstance){var sReference,oReferences=oInstance.classDefinition.allReferences,oReference;if(oReferences){for(sReference in oReferences){oReference=oReferences[sReference];if(oReference.isContainment===bIsContainment&&!oReference.isComputed&&oReference.contentType){nInheritanceLevel=sap.galilei.model.getInheritanceLevel(sQualifiedClassName,oReference.contentType.qualifiedName,oMetadataResource);if(nInheritanceLevel===0){sResult=sReference;oMatchingContainer=oInstance;nBestInheritanceLevel=nInheritanceLevel;break}else{if(nInheritanceLevel>0&&(nInheritanceLevel<nBestInheritanceLevel||nBestInheritanceLevel===-1)){sResult=sReference;oMatchingContainer=oInstance;nBestInheritanceLevel=nInheritanceLevel}}}}}};if(sQualifiedClassName){if(bSearchAncestors===true){while(oContainer!==undefined){fnFindReference(oContainer);if(nBestInheritanceLevel===0){break}oContainer=oContainer.container}}else{fnFindReference(this)}}return bSearchAncestors===true?{parentObject:oMatchingContainer,referenceName:sResult}:sResult},setContainer:function(oNewContainer,sNewContainmentName,sOldContainmentName){var oCurrentContainer=this.container,oNewCollection=oNewContainer[sNewContainmentName],oOldCOllection=oCurrentContainer&&sOldContainmentName&&oCurrentContainer[sOldContainmentName],nIndex=-1;if(oNewCollection&&oNewCollection.indexOf(this)<0){if(oOldCOllection){nIndex=oOldCOllection.indexOf(this);if(nIndex!==-1){oOldCOllection.removeAt(nIndex)}}oNewCollection.push(this)}},addReference:function(oParentObject,sObjectReference){var oReference,oReferenceClass;if(oParentObject&&sObjectReference){oReference=oParentObject[sObjectReference];if(oReference&&oReference.reference){oReferenceClass=oReference.reference}else{oReferenceClass=oParentObject.classDefinition.getReference(sObjectReference)}if(oReferenceClass&&!oReferenceClass.isComputed){if(oReferenceClass.isMany){if(oReference&&oReference.indexOf(this)===-1){oReference.push(this)}}else{oParentObject[sObjectReference]=this}}}},removeReference:function(oParentObject,sObjectReference){var oReference,oReferenceClass,index;if(oParentObject&&sObjectReference){oReference=oParentObject[sObjectReference];if(oReference&&oReference.reference){oReferenceClass=oReference.reference}else{oReferenceClass=oParentObject.classDefinition.getReference(sObjectReference)}if(oReferenceClass&&!oReferenceClass.isComputed){if(oReferenceClass.isMany){if(oReference){index=oReference.indexOf(this);if(index!==-1){oReference.removeAt(index)}}}else{oParentObject[sObjectReference]=undefined}}}}},statics:{firing:{value:false}}},Property:{classDefinition:"sap.galilei.model.Class",packageDefinition:"Galilei.Core",name:"Property",displayName:"Property",parent:"sap.galilei.model.Object",onInitialize:function(oResource,oPropertyDefinition){sap.galilei.model.internal.galileiPropertyInitializer.apply(this,arguments)},properties:{isPropertyComputed:{name:"isComputed",displayName:"Computed Value",owningClassDefinition:"Property",classDefinition:"sap.galilei.model.Property",isVolatile:true,isInternal:true,defaultValue:false},isInternal:{name:"isInternal",displayName:"Internal value",owningClassDefinition:"Property",classDefinition:"sap.galilei.model.Property"},isIndex:{name:"isIndex",displayName:"Is Index",owningClassDefinition:"Property",classDefinition:"sap.galilei.model.Property",defaultValue:false},propertyDefaultValue:{name:"defaultValue",displayName:"Default Value",owningClassDefinition:"Property",classDefinition:"sap.galilei.model.Property"},propertyConstraint:{name:"constraint",displayName:"Constraint",owningClassDefinition:"Property",classDefinition:"sap.galilei.model.Property"},propertyListConstraint:{name:"listConstraint",displayName:"List Constraint",owningClassDefinition:"Property",classDefinition:"sap.galilei.model.Property"},onPropertyChange:{name:"onChange",displayName:"On Property Change",owningClassDefinition:"Property",classDefinition:"sap.galilei.model.Property",isVolatile:true,isInternal:true},onPropertyCascadeChange:{name:"onCascadeChange",displayName:"On Cascade Property Change",owningClassDefinition:"Property",classDefinition:"sap.galilei.model.Property",isVolatile:true,isInternal:true},propertyQualifiedName:{name:"qualifiedName",displayName:"Qualified Name",classDefinition:"sap.galilei.model.Property",owningClassDefinition:"Property",get:function(){var sOwningClassDefinitionQualifiedName=this.owningClassDefinition&&this.owningClassDefinition.qualifiedName;if(sOwningClassDefinitionQualifiedName!=undefined){return sOwningClassDefinitionQualifiedName+"."+this.name}return undefined}},isPropertyCached:{name:"isCached",displayName:"Is Cached",owningClassDefinition:"Property",classDefinition:"sap.galilei.model.Property",isVolatile:true,isInternal:true,defaultValue:true},isPropertyUIVisible:{name:"isUIVisible",dataType:"gBool",classDefinition:"sap.galilei.model.Property"},isPropertyUIEditable:{name:"isUIEditable",dataType:"gBool",classDefinition:"sap.galilei.model.Property"}},references:{dataType:{name:"dataType",displayName:"Data Type",classDefinition:"sap.galilei.model.Reference",owningClassDefinition:"Property",contentType:"sap.galilei.model.DataType",isMany:false},propertyOwningClassDefinition:{name:"owningClassDefinition",classDefinition:"sap.galilei.model.Reference",owningClassDefinition:"Property",contentType:"sap.galilei.model.Class",isMany:false,reverseReference:"properties"},converter:{name:"converter",classDefinition:"sap.galilei.model.Reference",owningClassDefinition:"Property",contentType:"sap.galilei.model.Converter",isMany:false}},methods:{addPropertyListener:function(listener){this.owningClassDefinition.addPropertyListener(listener,this.name)},removePropertyListener:function(listener){this.owningClassDefinition.removePropertyListener(listener,this.name)}}},Reference:{classDefinition:"sap.galilei.model.Class",packageDefinition:"Galilei.Core",name:"Reference",displayName:"Reference",parent:"sap.galilei.model.Object",onInitialize:function(oResource,oReferenceDefinition){sap.galilei.model.internal.galileiReferenceInitializer.apply(this,arguments)},properties:{isReferenceComputed:{name:"isComputed",displayName:"Computed Value",owningClassDefinition:"Reference",classDefinition:"sap.galilei.model.Property",isVolatile:true,isInternal:true,defaultValue:false},isMany:{name:"isMany",displayName:"Is Many",classDefinition:"sap.galilei.model.Property",owningClassDefinition:"Reference",defaultValue:false},isOrdered:{name:"isOrdered",displayName:"Is Ordered",classDefinition:"sap.galilei.model.Property",owningClassDefinition:"Reference",defaultValue:false},isInternal:{name:"isInternal",displayName:"Internal value",classDefinition:"sap.galilei.model.Property",owningClassDefinition:"Reference",defaultValue:false},isContainment:{name:"isContainment",displayName:"Is Containment",classDefinition:"sap.galilei.model.Property",owningClassDefinition:"Reference",defaultValue:false},skipNotifications:{name:"skipNotifications",displayName:"Skip notifications",classDefinition:"sap.galilei.model.Property",owningClassDefinition:"Reference",isVolatile:true,isInternal:true,defaultValue:false},referenceConstraint:{name:"constraint",displayName:"Constraint",owningClassDefinition:"Property",classDefinition:"sap.galilei.model.Property"},referenceObjectConstraint:{name:"objectConstraint",displayName:"Object Constraint",owningClassDefinition:"Property",classDefinition:"sap.galilei.model.Property"},onReferenceChange:{name:"onChange",displayName:"On Reference Change",classDefinition:"sap.galilei.model.Property",owningClassDefinition:"Reference",isVolatile:true,isInternal:true},onReferenceCascadeChange:{name:"onCascadeChange",displayName:"On Cascade Reference Change",classDefinition:"sap.galilei.model.Property",owningClassDefinition:"Reference",isVolatile:true,isInternal:true},onReferenceCascadeLoad:{name:"onCascadeLoad",displayName:"On Cascade Reference Load",classDefinition:"sap.galilei.model.Property",owningClassDefinition:"Reference",isVolatile:true,isInternal:true},get:{name:"get",displayName:"Getter",classDefinition:"sap.galilei.model.Property",owningClassDefinition:"Reference",isVolatile:true,isInternal:true},set:{name:"set",displayName:"Setter",classDefinition:"sap.galilei.model.Property",owningClassDefinition:"Reference",isVolatile:true,isInternal:true},referenceQualifiedName:{name:"qualifiedName",displayName:"Qualified Name",classDefinition:"sap.galilei.model.Property",owningClassDefinition:"Reference",get:function(){var sOwningClassDefinitionqualifiedName=this.owningClassDefinition&&this.owningClassDefinition.qualifiedName;if(sOwningClassDefinitionqualifiedName!=undefined){return sOwningClassDefinitionqualifiedName+"."+this.name}return undefined}},isReferenceCached:{name:"isCached",displayName:"Is Cached",owningClassDefinition:"Reference",classDefinition:"sap.galilei.model.Property",isVolatile:true,isInternal:true,defaultValue:true},isReferenceUIVisible:{name:"isUIVisible",dataType:"gBool",classDefinition:"sap.galilei.model.Property"},isReferenceUIEditable:{name:"isUIEditable",dataType:"gBool",classDefinition:"sap.galilei.model.Property"}},references:{reverseReference:{name:"reverseReference",displayName:"Reverse Reference",classDefinition:"sap.galilei.model.Reference",owningClassDefinition:"Reference",contentType:"Reference",isMany:false},contentType:{name:"contentType",displayName:"Content Type",classDefinition:"sap.galilei.model.Reference",owningClassDefinition:"Reference",contentType:"sap.galilei.model.Class",isMany:false},referenceOwningClassDefinition:{name:"owningClassDefinition",classDefinition:"sap.galilei.model.Reference",owningClassDefinition:"Reference",contentType:"sap.galilei.model.Class",isMany:false,reverseReference:"references"}},methods:{addReferenceListener:function(listener){this.owningClassDefinition.addReferenceListener(listener,this.name)},removeReferenceListener:function(listener){this.owningClassDefinition.removeReferenceListener(listener,this.name)}}},DataType:{classDefinition:"sap.galilei.model.Class",packageDefinition:"Galilei.Core",name:"DataType",displayName:"Data Type",parent:"sap.galilei.model.Object",properties:{dataTypeDefaultValue:{name:"defaultValue",displayName:"Default Value",classDefinition:"sap.galilei.model.Property"}},methods:{isEmptyValue:function(vValue){return(vValue==undefined)}}},Converter:{classDefinition:"sap.galilei.model.Class",packageDefinition:"Galilei.Core",name:"Converter",displayName:"Converter",parent:"sap.galilei.model.Object",properties:{convertFrom:{name:"convertFrom",dataType:"gBlob",displayName:"convert from",classDefinition:"sap.galilei.model.Property"},convertTo:{name:"convertTo",dataType:"gBlob",displayName:"convert from",classDefinition:"sap.galilei.model.Property"}}},Enum:{classDefinition:"sap.galilei.model.Class",packageDefinition:"Galilei.Core",name:"Enum",displayName:"Enum",parent:"sap.galilei.model.DataType",onInitialize:function(oResource,oEnumDefinition){this.literalsMap},properties:[{name:"literalsMap",dataType:"gBlob",classDefinition:"sap.galilei.model.Property",get:function(){var result={},i,max_i,literal,literalsCollection=this.literals;for(i=0,max_i=literalsCollection.length;i<max_i;i++){literal=literalsCollection.get(i);if(literal.name!==undefined){result[literal.name]=literal.value}}return result},onChange:function(oEventArgs){var oInstance=oEventArgs.instance,oPackage=oInstance&&oInstance.packageDefinition,oNamespace=oPackage&&oPackage.getNamespace();if(oNamespace&&oInstance.name){oNamespace[oInstance.name]=oInstance.literalsMap}}}],references:[{name:"literals",displayName:"Literals",contentType:"sap.galilei.model.EnumLiteral",isContainment:true,isMany:true,classDefinition:"sap.galilei.model.Reference"},{name:"packageDefinition",contentType:"Package",isMany:false,reverseReference:"enums",classDefinition:"sap.galilei.model.Reference"}]},EnumLiteral:{classDefinition:"sap.galilei.model.Class",packageDefinition:"Galilei.Core",name:"EnumLiteral",displayName:"Enum Literal",parent:"sap.galilei.model.Object",properties:[{name:"value",displayName:"Value",dataType:"gInteger",classDefinition:"sap.galilei.model.Property"}]},gBool:{classDefinition:"DataType",name:"gBool",defaultValue:false},gChar:{classDefinition:"DataType",name:"gChar",defaultValue:""},gString:{classDefinition:"DataType",name:"gString",defaultValue:undefined},gShort:{classDefinition:"DataType",name:"gShort",defaultValue:0},gInteger:{classDefinition:"DataType",name:"gInteger",defaultValue:0},gLong:{classDefinition:"DataType",name:"gLong",defaultValue:0},gUShort:{classDefinition:"DataType",name:"gUShort",defaultValue:0},gUInteger:{classDefinition:"DataType",name:"gUInteger",defaultValue:0},gULong:{classDefinition:"DataType",name:"gULong",defaultValue:0},gFloat:{classDefinition:"DataType",name:"gFloat",defaultValue:0},gDouble:{classDefinition:"DataType",name:"gDouble",defaultValue:0},gDate:{classDefinition:"DataType",name:"gDate",defaultValue:"01/01/0001 00:00:00"},gGuid:{classDefinition:"DataType",name:"gGuid",defaultValue:"00000000-0000-0000-0000-000000000000"},gBlob:{classDefinition:"DataType",name:"gBlob",defaultValue:undefined}}});sap.galilei.model.loadMetamodels();
"use strict";sap.galilei.model.dataTypes={gBool:sap.galilei.model.getObject(sap.galilei.model.internal.galileiM3Resource,"gBool"),gChar:sap.galilei.model.getObject(sap.galilei.model.internal.galileiM3Resource,"gChar"),gString:sap.galilei.model.getObject(sap.galilei.model.internal.galileiM3Resource,"gString"),gShort:sap.galilei.model.getObject(sap.galilei.model.internal.galileiM3Resource,"gShort"),gInteger:sap.galilei.model.getObject(sap.galilei.model.internal.galileiM3Resource,"gInteger"),gLong:sap.galilei.model.getObject(sap.galilei.model.internal.galileiM3Resource,"gLong"),gUShort:sap.galilei.model.getObject(sap.galilei.model.internal.galileiM3Resource,"gUShort"),gUInteger:sap.galilei.model.getObject(sap.galilei.model.internal.galileiM3Resource,"gUInteger"),gULong:sap.galilei.model.getObject(sap.galilei.model.internal.galileiM3Resource,"gULong"),gFloat:sap.galilei.model.getObject(sap.galilei.model.internal.galileiM3Resource,"gFloat"),gDouble:sap.galilei.model.getObject(sap.galilei.model.internal.galileiM3Resource,"gDouble"),gDate:sap.galilei.model.getObject(sap.galilei.model.internal.galileiM3Resource,"gDate"),gGuid:sap.galilei.model.getObject(sap.galilei.model.internal.galileiM3Resource,"gGuid"),gBlob:sap.galilei.model.getObject(sap.galilei.model.internal.galileiM3Resource,"gBlob")};sap.galilei.model.dataTypes.gBool.isEmptyValue=function(vValue){return(vValue==null)};sap.galilei.model.dataTypes.gChar.isEmptyValue=function(vValue){return(vValue==null)||(vValue=="")};sap.galilei.model.dataTypes.gString.isEmptyValue=function(vValue){return(vValue==null)||(vValue=="")};sap.galilei.model.dataTypes.gShort.isEmptyValue=function(vValue){return(vValue==null)||(vValue=="")||(vValue=="0")};sap.galilei.model.dataTypes.gInteger.isEmptyValue=function(vValue){return(vValue==null)||(vValue=="")||(vValue=="0")};sap.galilei.model.dataTypes.gLong.isEmptyValue=function(vValue){return(vValue==null)||(vValue=="")||(vValue=="0")};sap.galilei.model.dataTypes.gUShort.isEmptyValue=function(vValue){return(vValue==null)||(vValue=="")||(vValue=="0")};sap.galilei.model.dataTypes.gUInteger.isEmptyValue=function(vValue){return(vValue==null)||(vValue=="")||(vValue=="0")};sap.galilei.model.dataTypes.gULong.isEmptyValue=function(vValue){return(vValue==null)||(vValue=="")||(vValue=="0")};sap.galilei.model.dataTypes.gFloat.isEmptyValue=function(vValue){return(vValue==null)||(vValue=="")||(vValue=="0")||(vValue=="0.0")};sap.galilei.model.dataTypes.gDouble.isEmptyValue=function(vValue){return(vValue==null)||(vValue=="")||(vValue=="0")||(vValue=="0.0")};sap.galilei.model.dataTypes.gDate.isEmptyValue=function(vValue){return(vValue==null)||(vValue=="")||(vValue=="0")||(vValue=="01/01/0001 00:00:00")};sap.galilei.model.dataTypes.gGuid.isEmptyValue=function(vValue){return(vValue==null)||(vValue=="")||(vValue=="00000000-0000-0000-0000-000000000000")||(vValue=="{00000000-0000-0000-0000-000000000000}")};sap.galilei.model.dataTypes.gBlob.isEmptyValue=function(vValue){return(vValue==null)};
"use strict";sap.galilei.model.ActionTypes={createObject:"createObject",deleteObject:"deleteObject",setAttribute:"setAttribute",setReferenceObject:"setReferenceObject",addReferenceObject:"addReferenceObject",removeReferenceObject:"removeReferenceObject"};sap.galilei.model.Action=sap.galilei.core.defineClass({properties:{objectId:undefined,type:{get:function(){return this.constructor.type}},actionParameters:undefined}});sap.galilei.model.CreateObjectAction=sap.galilei.core.defineClass({parent:sap.galilei.model.Action,properties:{classQualifiedName:undefined,featureValues:undefined,actionParameters:{get:function(){return{classQualifiedName:this.classQualifiedName,featureValues:this.featureValues}}}},methods:{toJSON:function(){return{type:sap.galilei.model.CreateObjectAction.type,objectId:this.objectId,actionParameters:this.actionParameters}},execute:function(oResource){}},statics:{type:sap.galilei.model.ActionTypes.createObject}});sap.galilei.model.DeleteObjectAction=sap.galilei.core.defineClass({parent:sap.galilei.model.Action,properties:{deletedObject:undefined,actionParameters:{get:function(){return{deletedObject:this.deletedObject}}}},methods:{toJSON:function(){return{type:sap.galilei.model.DeleteObjectAction.type,objectId:this.objectId,actionParameters:this.actionParameters}},execute:function(oResource){}},statics:{type:sap.galilei.model.ActionTypes.deleteObject}});sap.galilei.model.SetAttributeAction=sap.galilei.core.defineClass({parent:sap.galilei.model.Action,properties:{attributeName:undefined,oldValue:undefined,newValue:undefined,actionParameters:{get:function(){return{attributeName:this.attributeName,oldValue:this.oldValue,newValue:this.newValue}}}},methods:{toJSON:function(){return{type:sap.galilei.model.SetAttributeAction.type,objectId:this.objectId,actionParameters:this.actionParameters}},execute:function(oResource){}},statics:{type:sap.galilei.model.ActionTypes.setAttribute}});sap.galilei.model.SetReferenceObjectAction=sap.galilei.core.defineClass({parent:sap.galilei.model.Action,properties:{referenceName:undefined,oldObjectId:undefined,newObjectId:undefined,actionParameters:{get:function(){return{referenceName:this.referenceName,oldObjectId:this.oldObjectId,newObjectId:this.newObjectId}}}},methods:{toJSON:function(){return{type:sap.galilei.model.SetReferenceObjectAction.type,objectId:this.objectId,actionParameters:this.actionParameters}},execute:function(oResource){var oInstance=oResource&&oResource.selectObject({objectId:this.objectId}),oObjectToSet;if(oInstance){if(this.newObjectId===undefined){oInstance[this.referenceName]=undefined}else{oObjectToSet=oResource&&oResource.selectObject({objectId:this.newObjectId});if(oObjectToSet){oInstance[this.referenceName]=oObjectToSet}}}}},statics:{type:sap.galilei.model.ActionTypes.setReferenceObject}});sap.galilei.model.AddReferenceObjectAction=sap.galilei.core.defineClass({parent:sap.galilei.model.Action,properties:{referenceName:undefined,newObjectId:undefined,index:undefined,actionParameters:{get:function(){return{referenceName:this.referenceName,objectId:this.newObjectId,index:this.index}}}},methods:{toJSON:function(){return{type:sap.galilei.model.AddReferenceObjectAction.type,objectId:this.objectId,actionParameters:this.actionParameters}},execute:function(oResource){var oInstance=oResource&&oResource.selectObject({objectId:this.objectId}),oObjectToAdd=oResource&&oResource.selectObject({objectId:this.newObjectId}),oCollection=oInstance&&oInstance[this.referenceName];if(oCollection&&oObjectToAdd){if(this.index===undefined||this.index===-1){oCollection.push(oObjectToAdd)}else{oCollection.insert(this.index,oObjectToAdd)}}}},statics:{type:sap.galilei.model.ActionTypes.addReferenceObject}});sap.galilei.model.RemoveReferenceObjectAction=sap.galilei.core.defineClass({parent:sap.galilei.model.Action,properties:{referenceName:undefined,oldObjectId:undefined,index:undefined,actionParameters:{get:function(){return{referenceName:this.referenceName,objectId:this.oldObjectId,index:this.index}}}},methods:{toJSON:function(){return{type:sap.galilei.model.RemoveReferenceObjectAction.type,objectId:this.objectId,actionParameters:this.actionParameters}},execute:function(oResource){var oInstance=oResource&&oResource.selectObject({objectId:this.objectId}),oObjectToRemove=oResource&&oResource.selectObject({objectId:this.oldObjectId}),oCollection=oInstance&&oInstance[this.referenceName],nIndex=this.index;if(oCollection){if(nIndex===undefined){nIndex=oObjectToRemove&&oCollection.indexOf(oObjectToRemove)}if(nIndex!==undefined){oCollection.removeAt(nIndex)}}}},statics:{type:sap.galilei.model.ActionTypes.removeReferenceObject}});
"use strict";sap.galilei.model.ActionWriter=sap.galilei.core.defineClass({parent:sap.galilei.model.ResourceWriter,methods:{save:function(oResource,oParam){var aListOfActionJSON=oResource.listOfActions;aListOfActionJSON=jQuery.map(aListOfActionJSON,function(val,i){return val.toJSON()});return JSON.stringify({actionList:aListOfActionJSON})}}});
"use strict";sap.galilei.model.ArrayCollection=sap.galilei.core.defineClass({fullClassName:"sap.galilei.model.ArrayCollection",parent:sap.galilei.model.BaseCollection,properties:{length:{get:function(){this.initialize();return this.internalArray.length}},lengthAsync:{get:function(){var oResult=jQuery.Deferred();oResult.resolve(this.isInitialized===false?"?":this.length);return oResult}},internalArray:{get:function(){this.initialize();if(this._array===undefined){this._array=[]}return this._array},set:function(aValue){this._array=aValue}}},methods:{initialize:function(){},push:function(oValue){this.initialize();return this.internalArray.push(oValue)},add:function(oValue){this.initialize();this.push(oValue)},insert:function(nIndex,oValue){this.initialize();if(nIndex<0||nIndex>this.length){nIndex=this.length}return this.internalArray.splice(nIndex,0,oValue)},removeAt:function(nIndex){this.initialize();return this.internalArray.splice(nIndex,1)},get:function(nIndex){this.initialize();return this.internalArray[nIndex]},contains:function(oValue){this.initialize();return(this.internalArray.indexOf(oValue)!==-1)},clear:function(){this.initialize();this.internalArray=[]},toArray:function(){this.initialize();return this.internalArray.slice()},indexOf:function(oValue){this.initialize();return this.internalArray.indexOf(oValue)},concat:function(aValue){this.initialize();this.internalArray=this.internalArray.concat(aValue)}},fields:{_array:undefined}});
(function(){sap.galilei.model.JSONWriter=sap.galilei.core.defineClass({fullClassName:"sap.galilei.model.JSONWriter",parent:sap.galilei.model.ResourceWriter,methods:{save:function(oResource,oParam){var oResult={contents:{}},nResourceObjectsCount,nResourceObjectIndex,oCurrentResourceObject,oObjectDeclaration,sPropertyIndex,oCurrentProperty,oCurrentPropertyValue,sReferenceIndex,oCurrentReference,oCurrentReferenceValues,nReferenceObjectsCount,nReferenceObejctsIndex,nCurrentReferenceValue,vPropertyValue,oConverter,oResourceObjectsCollection=oResource.objects;if(oResource===undefined){throw"ArgumentNullException"}oResource.activeWriter=this;for(nResourceObjectIndex=0,nResourceObjectsCount=oResourceObjectsCollection.length;nResourceObjectIndex<nResourceObjectsCount;nResourceObjectIndex++){oCurrentResourceObject=oResourceObjectsCollection.get(nResourceObjectIndex);oObjectDeclaration={classDefinition:oCurrentResourceObject.classDefinition.qualifiedName};if(oCurrentResourceObject.isVolatile){continue}for(sPropertyIndex in oCurrentResourceObject.classDefinition.allProperties){oCurrentProperty=oCurrentResourceObject.classDefinition.allProperties[sPropertyIndex];oCurrentPropertyValue=oCurrentResourceObject[oCurrentProperty.name];if(!oCurrentProperty.isVolatile&&!oCurrentProperty.isInternal&&oCurrentPropertyValue!==oCurrentProperty.defaultValue){oConverter=oCurrentProperty.converter;vPropertyValue=oCurrentResourceObject[oCurrentProperty.name];if(oConverter!==undefined&&oConverter.convertTo!==undefined){vPropertyValue=oConverter.convertTo(vPropertyValue)}oObjectDeclaration[oCurrentProperty.name]=vPropertyValue}}for(sReferenceIndex in oCurrentResourceObject.classDefinition.allReferences){oCurrentReference=oCurrentResourceObject.classDefinition.allReferences[sReferenceIndex];if(!oCurrentReference.isVolatile&&!oCurrentReference.isInternal&&!oCurrentReference.reverseReference){if(!oCurrentReference.isMany){oObjectDeclaration[oCurrentReference.name]=oCurrentResourceObject[oCurrentReference.name]&&(oCurrentResourceObject[oCurrentReference.name].qualifiedName||oCurrentResourceObject[oCurrentReference.name].objectId)}else{oCurrentReferenceValues=oCurrentResourceObject[oCurrentReference.name];if(oCurrentReferenceValues&&oCurrentReferenceValues.length>0){oObjectDeclaration[oCurrentReference.name]={};for(nReferenceObejctsIndex=0,nReferenceObjectsCount=oCurrentReferenceValues.length;nReferenceObejctsIndex<nReferenceObjectsCount;nReferenceObejctsIndex++){nCurrentReferenceValue=oCurrentReferenceValues.get(nReferenceObejctsIndex);oObjectDeclaration[oCurrentReference.name][nCurrentReferenceValue.objectId]={name:nCurrentReferenceValue.name}}}}}}oResult.contents[oCurrentResourceObject.objectId]=oObjectDeclaration}return JSON.stringify(oResult)}}})}());
(function(){sap.galilei.model.ReaderStrategy=sap.galilei.core.defineClass({fullClassName:"sap.galilei.model.ReaderStrategy",initialize:function ReaderStrategy(oParam){this.resourceReader=oParam&&oParam.resourceReader},properties:{resourceReader:undefined},methods:{getObjectPropertyAsync:function(oInstance,sPropertyName){throw"NotImplementedException"},getObjectAtomicReferenceAsync:function(oInstance,sReferenceName,bAsync){throw"NotImplementedException"},loadObjectReferenceObjectsAsync:function(oInstance,sReferenceName,bAsync){throw"NotImplementedException"},getObjectAsync:function(sObjectId,bAsync){throw"NotImplementedException"},initializeObjectAsync:function(oODataDeclaration){throw"NotImplementedException"},onUsingStrategyAsync:function(fnExecuteUsingStrategy){fnExecuteUsingStrategy()},selectAllObjectsAsync:function(oInstance,sReferenceName,oFilter,bAsync){throw"NotImplementedException"},getIdentifyingPropertyName:function(){return"objectId"}}})}());
(function(){sap.galilei.model.ResourceWriter=sap.galilei.core.defineClass({fullClassName:"sap.galilei.model.ResourceWriter",properties:{resource:undefined},methods:{save:function(oResource,oParam){},saveAsync:function(oResource,oParam){}}})}());
(function(){sap.galilei.model.ObjectStatus=sap.galilei.core.defineClass({fullClassName:"sap.galilei.model.ObjectStatus",properties:{objectLoaded:undefined,referencesLoaded:undefined,referenceLoaded:undefined,referenceCountLoaded:undefined,referencesCountsLoaded:undefined,instance:undefined,isLocalObject:undefined},methods:{canLoadFromStrategy:function(){var bResult=this.isLocalObject!==true;if(!bResult&&this.instance&&this.instance.canLoadFromStrategy instanceof Function){bResult=this.instance.canLoadFromStrategy()}return bResult},isLoadedAsync:function(){var oDeferred;if(!this.canLoadFromStrategy()){oDeferred=jQuery.Deferred();oDeferred.resolve(this.instance);return oDeferred}return this.objectLoaded},setIsLoading:function(oDeferredObject){this.objectLoaded=oDeferredObject},areReferencesLoadedAsync:function(){var oDeferred;if(!this.canLoadFromStrategy()){oDeferred=jQuery.Deferred();oDeferred.resolve();return oDeferred}return this.referencesLoaded},setReferencesLoading:function(oDeferredObject){this.referencesLoaded=oDeferredObject},isReferenceCountLoadedAsync:function(sReferenceName){var oDeferred;if(!this.canLoadFromStrategy()){oDeferred=jQuery.Deferred();oDeferred.resolve(this.instance[sReferenceName]&&this.instance[sReferenceName].length);return oDeferred}return this.referenceCountLoaded&&this.referenceCountLoaded[sReferenceName]},setReferenceCountLoading:function(sReferenceName,oDeferredObject){if(this.referenceCountLoaded===undefined){this.referenceCountLoaded={}}this.referenceCountLoaded[sReferenceName]=oDeferredObject},areReferencesCountsLoadedAsync:function(){var oDeferred;if(!this.canLoadFromStrategy()){oDeferred=jQuery.Deferred();oDeferred.resolve({});return oDeferred}return this.referencesCountsLoaded},setReferencesCountsLoading:function(oDeferredObject){this.referencesCountsLoaded=oDeferredObject},isReferenceLoadedAsync:function(sReferenceName){var oDeferred;if(!this.canLoadFromStrategy()){oDeferred=jQuery.Deferred();oDeferred.resolve();return oDeferred}return this.referenceLoaded&&this.referenceLoaded[sReferenceName]},setReferenceLoading:function(sReferenceName,oDeferredObject){if(this.referenceLoaded===undefined){this.referenceLoaded={}}this.referenceLoaded[sReferenceName]=oDeferredObject}}});sap.galilei.model.StrategyBasedReader=sap.galilei.core.defineClass({fullClassName:"sap.galilei.model.StrategyBasedReader",parent:sap.galilei.model.JSONReader,initialize:function StrategyBasedReader(oParam){oParam=oParam||{};if(oParam.dataResource===undefined){throw"ArgumentNullException"}this.dataResource=oParam.dataResource;this.dataResource.activeReader=this;if(oParam.metadataResource){this.metadataResource=oParam.metadataResource;this.metadataResource.activeReader=this}this.activeStrategy=oParam.strategy||new sap.galilei.model.ReaderStrategy();this.activeStrategy.resourceReader=this},properties:{dataResource:undefined,metadataResource:undefined,activeStrategy:undefined,isPartialLoadReader:{get:function(){return true}},objectStatusList:undefined,_unresolvedId:undefined},methods:{getObjectStatus:function(vInstanceOrId){var sObjectId,oInstance,oFilter={},oInstanceStatus;if(typeof(vInstanceOrId)==="string"){sObjectId=vInstanceOrId}else{if(typeof(vInstanceOrId)==="number"){sObjectId=""+vInstanceOrId;vInstanceOrId=sObjectId}else{if(typeof(vInstanceOrId)==="object"){sObjectId=vInstanceOrId[this.getIdentifyingPropertyName()]||vInstanceOrId.objectId;if(typeof(sObjectId)==="number"){sObjectId=""+sObjectId}}}}oInstanceStatus=sObjectId&&this.objectStatusList&&this.objectStatusList[sObjectId];if(oInstanceStatus===undefined&&sObjectId!=undefined&&sObjectId!=this._unresolvedId){if(this.objectStatusList===undefined){this.objectStatusList={}}if(typeof(vInstanceOrId)==="string"){oFilter[this.getIdentifyingPropertyName()]=vInstanceOrId;oInstance=this.dataResource&&this.dataResource.selectObject(oFilter)}else{oInstance=vInstanceOrId}oInstanceStatus=new sap.galilei.model.ObjectStatus({instance:oInstance,isLocalObject:oInstance!==undefined});this.objectStatusList[sObjectId]=oInstanceStatus}return oInstanceStatus},getMetamodelAsync:function(bAsync){var oResult;if(this.activeStrategy&&this.activeStrategy.getMetamodelAsync){oResult=this.activeStrategy.getMetamodelAsync(bAsync)}else{oResult=jQuery.Deferred();oResult.reject()}return oResult},getObjectPropertyAsync:function(oInstance,sPropertyName){if(oInstance===undefined){throw"InvalidOperationException"}return this.activeStrategy.getObjectPropertyAsync(oInstance,sPropertyName)},getObjectAtomicReferenceAsync:function(oInstance,sReferenceName,bAsync){var oResult,oInstanceStatus=this.getObjectStatus(oInstance);if(oInstance===undefined){throw"InvalidOperationException"}if(oInstanceStatus&&oInstanceStatus.isReferenceLoadedAsync(sReferenceName)){oResult=oInstanceStatus.isReferenceLoadedAsync(sReferenceName)}else{oResult=jQuery.Deferred();if(oInstanceStatus){oInstanceStatus.setReferenceLoading(sReferenceName,oResult)}jQuery.when(this.activeStrategy.getObjectAtomicReferenceAsync(oInstance,sReferenceName,bAsync)).done(function(oResolved){oResult.resolve(oResolved)})}return oResult},loadObjectReferencesAsync:function(oInstance,bAsync){var oResult,oInstanceStatus=this.getObjectStatus(oInstance);if(oInstance===undefined){throw"InvalidOperationException"}if(oInstanceStatus&&oInstanceStatus.areReferencesLoadedAsync()){oResult=oInstanceStatus.areReferencesLoadedAsync()}else{oResult=jQuery.Deferred();if(oInstanceStatus){oInstanceStatus.setReferencesLoading(oResult)}jQuery.when(this.activeStrategy.loadObjectReferencesAsync(oInstance,bAsync)).done(function(oResolved){oResult.resolve(oResolved)})}return oResult},loadObjectReferenceObjectsAsync:function(oInstance,sReferenceName,bAsync){var oResult,oInstanceStatus=this.getObjectStatus(oInstance),oClassDefinition=oInstance&&oInstance.classDefinition,oAllReferences=oClassDefinition&&oClassDefinition.allReferences,oReference=oAllReferences&&oAllReferences[sReferenceName],oDeferredCounts,bEmpty=false;if(oInstance===undefined){throw"InvalidOperationException"}oResult=oInstanceStatus&&oInstanceStatus.isReferenceLoadedAsync(sReferenceName);if(oResult&&(bAsync===false)&&oResult.state()!=="resolved"){oResult=undefined}if(!oResult){oResult=jQuery.Deferred();if(oInstanceStatus){oInstanceStatus.setReferenceLoading(sReferenceName,oResult)}if(oReference&&oReference.isAsync!==true){oResult.resolve(oInstance[sReferenceName])}else{oDeferredCounts=oInstanceStatus&&oInstanceStatus.areReferencesCountsLoadedAsync();if(oDeferredCounts&&oDeferredCounts.state()==="resolved"){jQuery.when(oDeferredCounts).done(function(oLoadedCounts){bEmpty=(oLoadedCounts[sReferenceName]===0)})}if(bEmpty===true){oResult.resolve(oInstance[sReferenceName])}else{jQuery.when(this.activeStrategy.loadObjectReferenceObjectsAsync(oInstance,sReferenceName,bAsync)).done(function(oResolved){oResult.resolve(oResolved)})}}}return oResult},getObjectReferenceCountAsync:function(oInstance,sReferenceName,bAsync){var oResult,oInstanceStatus=this.getObjectStatus(oInstance);if(oInstance===undefined){throw"InvalidOperationException"}if(oInstanceStatus&&oInstanceStatus.isReferenceCountLoadedAsync(sReferenceName)){oResult=oInstanceStatus.isReferenceCountLoadedAsync(sReferenceName)}else{oResult=jQuery.Deferred();if(oInstanceStatus){oInstanceStatus.setReferenceCountLoading(sReferenceName,oResult)}jQuery.when(this.activeStrategy.getObjectReferenceCountAsync(oInstance,sReferenceName,bAsync)).done(function(oResolved){oResult.resolve(oResolved)})}return oResult},getObjectReferencesCountsAsync:function(oInstance,bAsync){var oResult,oInstanceStatus=this.getObjectStatus(oInstance);if(oInstance===undefined){throw"InvalidOperationException"}if(oInstanceStatus&&oInstanceStatus.areReferencesCountsLoadedAsync()){oResult=oInstanceStatus.areReferencesCountsLoadedAsync()}else{oResult=jQuery.Deferred();if(oInstanceStatus){oInstanceStatus.setReferencesCountsLoading(oResult)}jQuery.when(this.activeStrategy.getObjectReferencesCountsAsync(oInstance,bAsync)).done(function(oCollectionsCounts){oResult.resolve(oCollectionsCounts)})}return oResult},onUsingStrategyAsync:function(oStrategy,fnExecuteUsingStrategy){var self=this,oResult=jQuery.Deferred(),oOriginalStrategy=this.activeStrategy,oOriginalStrategyReader=oOriginalStrategy.resourceReader;if(oStrategy){this.activeStrategy=oStrategy;this.activeStrategy.resourceReader=this;jQuery.when(this.activeStrategy.onUsingStrategyAsync(fnExecuteUsingStrategy)).done(function(){self.activeStrategy.resourceReader=oOriginalStrategyReader;self.activeStrategy=oOriginalStrategy;oResult.resolve()})}else{if(fnExecuteUsingStrategy){fnExecuteUsingStrategy();oResult.resolve()}}return oResult},getDeleteStrategy:function(sObjectId){},getIdentifyingPropertyName:function(){return(this.activeStrategy&&this.activeStrategy.getIdentifyingPropertyName())||"objectId"},getObjectAsync:function(sObjectId,bAsync){var self=this,oObjectStatus=this.getObjectStatus(sObjectId),oResult=oObjectStatus&&oObjectStatus.isLoadedAsync();if(oResult===undefined){oResult=jQuery.Deferred();if(oObjectStatus){if(oObjectStatus.isLocalObject!==false){oObjectStatus.isLocalObject=false}oObjectStatus.setIsLoading(oResult)}if(this.metadataResource===undefined||this.metadataResource.objects.length===0){jQuery.when(this.getMetamodelAsync(bAsync)).done(function(oMetadataResource){jQuery.when(self.activeStrategy.getObjectAsync(sObjectId,bAsync)).done(function(oInstance){oResult.resolve(oInstance)})})}else{jQuery.when(self.activeStrategy.getObjectAsync(sObjectId,bAsync)).done(function(oResolvedInstance){oResult.resolve(oResolvedInstance)})}}return oResult},selectAllObjectsAsync:function(oInstance,sReferenceName,oFilter,bAsync){var oInstanceStatus=this.getObjectStatus(oInstance),oIsReferenceLoaded=oInstanceStatus&&oInstanceStatus.isReferenceLoadedAsync(sReferenceName),oResult;if(oInstance===undefined){throw"InvalidOperationException"}if(oIsReferenceLoaded&&oIsReferenceLoaded.state==="resolved"){oResult=jQuery.Deferred();oResult.resolve(oInstance[sReferenceName].selectAllObjects(oFilter))}else{oResult=this.activeStrategy.selectAllObjectsAsync(oInstance,sReferenceName,oFilter,bAsync)}return oResult},getMetadataResourceId:function(){return this.dataResource&&(this.dataResource.resourceId+"_metadata")},initializeAsync:function(oParam,bAsync){var sMetadataResourceId=this.getMetadataResourceId(),oMetadataResource=this.metadataResource||sap.galilei.model.getResource(sMetadataResourceId);if(oMetadataResource===undefined){this.metadataResource=new sap.galilei.model.Resource(sMetadataResourceId)}return this.getMetamodelAsync(bAsync)}}})}());
