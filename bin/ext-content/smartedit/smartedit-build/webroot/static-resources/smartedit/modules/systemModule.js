!function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=78)}({0:function(t,e){t.exports=angular},78:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(79),o=(n.n(i),n(0));n.n(o);o.module("systemModule",["contextualMenuDecoratorModule","slotContextualMenuDecoratorModule","decoratorServiceModule"])},79:function(t,e){angular.module("contextualMenuDecoratorModule",["componentHandlerServiceModule","smarteditServicesModule","eventServiceModule","ui.bootstrap","yPopupOverlayModule","contextualMenuItemModule"]).constant("CTX_MENU_DROPDOWN_IS_OPEN","CTX_MENU_DROPDOWN_IS_OPEN").constant("CLOSE_CTX_MENU","CLOSE_CTX_MENU").controller("baseContextualMenuController",function(){this.status={isopen:!1},this.isHybrisIcon=function(t){return t&&t.indexOf("hyicon")>=0},this.remainOpenMap={},this.setRemainOpen=function(t,e){this.remainOpenMap[t]=e},this.showOverlay=function(){return!0===this.active||Object.keys(this.remainOpenMap).reduce(function(t,e){return t||this.remainOpenMap[e]}.bind(this),!1)}}).controller("contextualMenuController",["$scope","$element","$controller","$timeout","$log","REFRESH_CONTEXTUAL_MENU_ITEMS_EVENT","CLOSE_CTX_MENU","smarteditroot","contextualMenuService","systemEventService",function(t,e,n,i,o,r,s,a,l,d){angular.extend(this,n("baseContextualMenuController",{$scope:t})),this.$postLink=function(){t.componentDetails={componentType:this.smarteditComponentType,componentId:this.smarteditComponentId,containerType:this.smarteditContainerType,containerId:this.smarteditContainerId,slotId:this.smarteditSlotId,slotUuid:this.smarteditSlotUuid}},this.$doCheck=function(){this.initialized||0===e.width()||(this.initialized=!0,this.onInit())},this.onInit=function(){this.maxContextualMenuItems=function(){var t=Math.round(e.width()/50)-1,n=t>=4?3:t-1;return n=n<0?0:n},this.moreMenuIsOpen=!1,this.itemTemplateOverlayWrapper={templateUrl:"contextualMenuItemOverlayWrapper.html"},this.moreMenuPopupConfig={templateUrl:"moreItemsTemplate.html",halign:"left"},this.updateItems(),this.dndUnRegFn=d.registerEventHandler(s,this.hideAllPopups),this.unregisterRefreshItems=d.registerEventHandler(r,this.updateItems)},this.moreButton={displayClass:"hyicon hyicon-more cmsx-ctx__icon-more",i18nKey:"se.cms.contextmenu.title.more"},this.updateItems=function(){l.getContextualMenuItems({componentType:this.smarteditComponentType,componentId:this.smarteditComponentId,containerType:this.smarteditContainerType,containerId:this.smarteditContainerId,componentAttributes:this.componentAttributes,iLeftBtns:this.maxContextualMenuItems(),element:e,properties:JSON.stringify(this.componentAttributes)}).then(function(t){this.items=t}.bind(this))}.bind(this),this.shouldShowTemplate=function(t){return this.displayedItem===t},this.onShowItemPopup=function(){this.setRemainOpen("someContextualPopupOverLay",!0)}.bind(this),this.onHideItemPopup=function(t){this.displayedItem=null,this.setRemainOpen("someContextualPopupOverLay",!1),t&&this.onHideMoreMenuPopup()}.bind(this),this.onShowMoreMenuPopup=function(){this.setRemainOpen("someContextualPopupOverLay",!0)}.bind(this),this.onHideMoreMenuPopup=function(){this.moreMenuIsOpen=!1,this.setRemainOpen("someContextualPopupOverLay",!1)}.bind(this),this.hideAllPopups=function(){this.onHideMoreMenuPopup(),this.onHideItemPopup()}.bind(this),this.triggerMenuItemAction=function(t,n){t.action.template||t.action.templateUrl?this.displayedItem===t?this.displayedItem=null:this.displayedItem=t:t.action.callback&&(this.hideAllPopups(),t.action.callback({componentType:this.smarteditComponentType,componentId:this.smarteditComponentId,containerType:this.smarteditContainerType,containerId:this.smarteditContainerId,componentAttributes:this.componentAttributes,slotId:this.smarteditSlotId,slotUuid:this.smarteditSlotUuid,element:e,properties:JSON.stringify(this.componentAttributes)},n))}.bind(this),this.getItems=function(){return this.items},this.$onDestroy=function(){this.dndUnRegFn&&this.dndUnRegFn(),this.unregisterRefreshItems&&this.unregisterRefreshItems()},this.showContextualMenuBorders=function(){return this.active&&this.items&&this.items.leftMenuItems.length>0}}]).directive("contextualMenu",["$q","$timeout","contextualMenuService","componentHandlerService",function(t,e,n,i){return{templateUrl:"contextualMenuDecoratorTemplate.html",restrict:"C",transclude:!0,replace:!1,controller:"contextualMenuController",controllerAs:"ctrl",scope:{},bindToController:{smarteditComponentId:"@",smarteditComponentType:"@",smarteditContainerId:"@",smarteditContainerType:"@",componentAttributes:"<",active:"="},link:function(t,e){t.ctrl.smarteditSlotId=i.getParentSlotForComponent(e),t.ctrl.smarteditSlotUuid=i.getParentSlotUuidForComponent(e),t.ctrl.slotAttributes={smarteditSlotId:t.ctrl.smarteditSlotId,smarteditSlotUuid:t.ctrl.smarteditSlotUuid}}}}]),angular.module("contextualMenuItemModule",["yPopupOverlayModule","componentHandlerServiceModule"]).controller("contextualMenuItemController",["$element",function(t){var e=["small","compact"];this._validateInput=function(){if("string"!=typeof this.mode||-1===e.indexOf(this.mode))throw"Error initializing contextualMenuItem - unknown mode"},this.isHybrisIcon=function(t){return t&&t.indexOf("hyicon")>=0},this.$onInit=function(){if(this.classes="cmsx-ctx__icon-more--small "+this.itemConfig.displayClass,this._validateInput(),this.itemConfig.action&&this.itemConfig.action.callbacks){var e=this.componentAttributes,n=this.slotAttributes;angular.forEach(this.itemConfig.action.callbacks,function(i,o){t.on(o,i.bind(void 0,{componentType:e.smarteditComponentType,componentId:e.smarteditComponentId,componentUuid:e.smarteditComponentUuid,containerType:e.smarteditContainerType,containerId:e.smarteditContainerId,componentAttributes:e,slotId:n.smarteditSlotId,slotUuid:n.smarteditSlotUuid}))})}},this.$onDestroy=function(){t.off()}}]).component("contextualMenuItem",{controller:"contextualMenuItemController",templateUrl:"contextualMenuItemComponentTemplate.html",bindings:{mode:"@",index:"<",componentAttributes:"<",slotAttributes:"<",itemConfig:"<"}}),angular.module("slotContextualMenuDecoratorModule",["smarteditServicesModule","contextualMenuDecoratorModule","eventServiceModule","ui.bootstrap","componentHandlerServiceModule","permissionServiceModule"]).constant("SHOW_SLOT_MENU","_SHOW_SLOT_MENU").constant("HIDE_SLOT_MENU","HIDE_SLOT_MENU").constant("SHOW_SLOT_PADDING","SHOW_SLOT_PADDING").constant("HIDE_SLOT_PADDING","HIDE_SLOT_PADDING").controller("slotContextualMenuController",["$controller","$scope","$element","SHOW_SLOT_MENU","HIDE_SLOT_MENU","SHOW_SLOT_PADDING","HIDE_SLOT_PADDING","REFRESH_CONTEXTUAL_MENU_ITEMS_EVENT","smarteditroot","systemEventService","contextualMenuService","permissionService","componentHandlerService",function(t,e,n,i,o,r,s,a,l,d,u,c,m){angular.extend(this,t("baseContextualMenuController",{$scope:e})),this.$onInit=function(){this.updateItems(),this.showItems=!1,this.permissionsObject=[{names:["se.slot.not.external"],context:{slotCatalogVersionUuid:this.componentAttributes.smarteditCatalogVersionUuid}}],c.isPermitted(this.permissionsObject).then(function(t){this.showItems=t;var e=this.smarteditComponentId+i;this.showSlotMenuUnregFn=d.registerEventHandler(e,this._showSlotMenu),this.hideSlotMenuUnregFn=d.registerEventHandler(o,this._hideSlotMenu),this.refreshContextualMenuUnregFn=d.registerEventHandler(a,this.updateItems)}.bind(this))},this.triggerMenuItemAction=function(t,e){t.callback({componentType:this.smarteditComponentType,componentId:this.smarteditComponentId,componentAttributes:this.componentAttributes},e)},this._showSlotMenu=function(t,e){this.smarteditComponentId===e&&(this.remainOpenMap.slotMenuButton=!0,d.sendEvent(r))}.bind(this),this._hideSlotMenu=function(){this.remainOpenMap.slotMenuButton&&delete this.remainOpenMap.slotMenuButton,d.sendEvent(s)}.bind(this),this.maxContextualMenuItems=3,this.updateItems=function(){u.getContextualMenuItems({componentType:this.smarteditComponentType,componentId:this.smarteditComponentId,containerType:this.smarteditContainerType,containerId:this.smarteditContainerId,componentAttributes:this.componentAttributes,iLeftBtns:this.maxContextualMenuItems,element:n}).then(function(t){this.items=t}.bind(this))}.bind(this),this.triggerMenuItemAction=function(t,e){t.callback({componentType:this.smarteditComponentType,componentId:this.smarteditComponentId,containerType:this.smarteditContainerType,containerId:this.smarteditContainerId,componentAttributes:this.componentAttributes,slotId:this.smarteditSlotId,slotUuid:this.smarteditSlotUuid,element:n,properties:JSON.stringify(this.componentAttributes)},e)}.bind(this),this.getItems=function(){return this.items},this.$onDestroy=function(){this.showSlotMenuUnregFn&&this.showSlotMenuUnregFn(),this.hideSlotMenuUnregFn&&this.hideSlotMenuUnregFn(),this.refreshContextualMenuUnregFn&&this.refreshContextualMenuUnregFn()},this.positionPanelHorizontally=function(){this.initialSlotMenuWidth=n.find(".decorative-panel-area").outerWidth();var t=n.find(".decorative-panel-area").css("margin-left")||"0px",e=parseInt(t.replace("px","")),i=n.find(".decorative-panel-area").width()+e,o=n.offset().left+i>=m.getFromSelector("body").width();if(o){var r=n.find(".decorative-panel-area").outerWidth()-n.find(".yWrapperData").width();n.find(".decorative-panel-area").css("margin-left",-r),n.find(".decorator-padding-left").css("margin-left",-r)}var s=o?".decorator-padding-left":".decorator-padding-right";this.hidePadding(),n.find(s).css("display","flex")},this.hidePadding=function(){n&&(n.find(".decorator-padding-left").css("display","none"),n.find(".decorator-padding-right").css("display","none"))},this.$doCheck=function(){n&&n.find(".decorative-panel-area").outerWidth()>0&&this.initialSlotMenuWidth!==n.find(".decorative-panel-area").outerWidth()&&this.positionPanelHorizontally()},this.initialSlotMenuWidth=0}]).directive("slotContextualMenu",["$timeout","SHOW_SLOT_PADDING","HIDE_SLOT_PADDING","systemEventService",function(t,e,n,i){return{templateUrl:"slotContextualMenuDecoratorTemplate.html",restrict:"C",transclude:!0,replace:!1,controller:"slotContextualMenuController",controllerAs:"ctrl",scope:{},bindToController:{smarteditComponentId:"@",smarteditComponentType:"@",componentAttributes:"<",active:"="},link:function(o,r){o.ctrl.positionPanelVertically=function(){var t,e=r.find(".decorative-panel-area"),n=r.find(".decorator-padding-container");r.offset().top<=e.height()?(t=n.height(),n.css("margin-top",-(t+e.height()))):t=-42,e.css("margin-top",t)},o.ctrl.positionPanel=function(){o.ctrl.positionPanelVertically(),o.ctrl.positionPanelHorizontally()},o.$watch("ctrl.active",function(e){t(function(){o.ctrl.hidePadding(),e&&(o.ctrl.positionPanel(),i.sendEvent("SLOT_CONTEXTUAL_MENU_ACTIVE"))})}),i.registerEventHandler(n,o.ctrl.hidePadding),i.registerEventHandler(e,o.ctrl.positionPanel),o.$on("$destroy",function(){i.unRegisterEventHandler(n,o.ctrl.hidePadding),i.unRegisterEventHandler(e,o.ctrl.positionPanel)}.bind(o))}}}]),angular.module("toolbarModule",["gatewayProxyModule","toolbarInterfaceModule"]).factory("toolbarServiceFactory",["$log","gatewayProxy","copy","extend","ToolbarServiceInterface",function(t,e,n,i,o){var r=function(t){this.gatewayId=t,this.actions={},e.initForService(this,["addAliases","removeItemByKey","removeAliasByKey","_removeItemOnInner","triggerActionOnInner"])};(r=i(o,r)).prototype._removeItemOnInner=function(e){e in this.actions&&delete this.actions[e],t.warn("removeItemByKey() - Failed to find action for key "+e)},r.prototype.triggerActionOnInner=function(e){this.actions[e.key]?this.actions[e.key]():t.error("triggerActionByKey() - Failed to find action for key "+e.key)};var s={};return{getToolbarService:function(t){return s[t]||(s[t]=new r(t)),s[t]}}}])}});